<!DOCTYPE html>
<html>
  <!-- meta/link... -->
  



<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <title>Learn-SpringCloudAlibaba | Hexo</title>

  <link rel="icon" type="image/x-icon, image/vnd.microsoft.icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1911880_c1nvbyezg17.css">
  <link href="https://cdn.jsdelivr.net/gh/inkss/fontawesome@5.15.3/css/all.min.css" rel="stylesheet">

  
    <script>
        var themeModelId = '';
        if (themeModelId) {
            localStorage.setItem('modelId', themeModelId);
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/gh/yuang01/live2d-widget@latest/autoload.js"></script>
    <script>
        var live2dOpen = eval('true') || false;
        if (!live2dOpen) {
            localStorage.setItem('waifu-display', 1609323474481);
        }
    </script>
  
  
  
<link rel="stylesheet" href="/css/animate.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
  
    
<link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="/js/shareJs/share.min.css">

  
  <style>
        @media (max-width: 992px) {
            #waifu {
                display: none;
            }
        }
    </style>
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

    

    <!-- import link -->
    
        
            
        
            
        
    
    <!-- import script -->
    
        
            
        
            
        
    

<meta name="generator" content="Hexo 6.0.0"></head>

  
  <!-- ‰æùËµñ‰∫éjqueryÂíåvue -->
  <script src="/js/jquery3.5.1.js"></script>
  <script src="/js/vue2.6.11.js"></script>
  
  <body>
    <!-- È¢ÑÂä†ËΩΩÂä®Áîª -->
    <!-- È°µÈù¢È¢ÑÂä†ËΩΩÂä®Áîª -->

    
    <!-- Âà§Êñ≠ÊòØÂê¶‰∏∫ÊöóÈªëÈ£éÊ†º -->
    <!-- Âà§Êñ≠ÊòØÂê¶‰∏∫ÈªëÂ§úÊ®°Âºè -->
<script>
  let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');

  if (isDark) {
    $(document.body).addClass('darkModel');
  }
</script>

    <!-- Â§¥ÈÉ®ÂØºËà™Á≠â -->
    
<header class="header " id="navHeader"
  style="position: fixed;
  left: 0; top: 0; z-index: 10;width: 100%;"
>
  <div class="header-content">
    <div class="bars">
      <div id="appDrawer" class="sidebar-image">
  <div class="drawer-box-icon">
    <i class="fas fa-bars" aria-hidden="true" @click="showDialogDrawer"></i>
  </div>
  
  <transition name="fade">
    <div class="drawer-box_mask" v-cloak style="display: none;" v-show="visible" @click.self="cancelDialogDrawer">
    </div>
  </transition>
  <div class="drawer-box" :class="{'active': visible}">
    <div class="drawer-box-head bg-color">
      <img class="drawer-box-head_logo lazyload placeholder" src="/medias/logo.png" class="lazyload placeholder" data-srcset="/medias/logo.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="logo">
      <h3 class="drawer-box-head_title">Hexo</h3>
      <h5 class="drawer-box-head_desc"></h5>
    </div>
    
    <div class="drawer-box-content">
      <ul class="drawer-box-content_menu">
        
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/" class="drawer-menu-item-link">
                  
                    <i class="fas fa-home" aria-hidden="true"></i>
                  
                  <span class="name">È¶ñÈ°µ</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/archives" class="drawer-menu-item-link">
                  
                    <i class="fas fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">ÂΩíÊ°£</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/tags" class="drawer-menu-item-link">
                  
                    <i class="fas fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">Ê†áÁ≠æ</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/categories" class="drawer-menu-item-link">
                  
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">ÂàÜÁ±ª</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/about" class="drawer-menu-item-link">
                  
                    <i class="fas fa-user" aria-hidden="true"></i>
                  
                  <span class="name">ÂÖ≥‰∫é</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/friends" class="drawer-menu-item-link">
                  
                  <span class="name">ÂèãÊÉÖÈìæÊé•</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="javascript:;" class="drawer-menu-item-link has-children" @click="openOrCloseMenu(6)">
                  <span>
                    
                    <span class="name">üê±Êõ¥Â§ö</span>
                  </span>
                  <i class="fas fa-chevron-left arrow " :class="{'icon-rotate': isOpen(6)}" aria-hidden="true"></i>
                </a>
                <ul class="drawer-sub-menu" v-if="isOpen(6)">
                  
                  <li>
                    <a href="/gallery">
                      
                      <span>üì∑ÂõæÂ∫ì</span>
                    </a>
                  </li>
                  
                  <li>
                    <a href="/me">
                      
                      <span>üßíüèªÂÖ≥‰∫éÊàë</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
        
        
          <li class="drawer-box-content_item">
            <a target="_blank" rel="noopener" href="https://github.com/ctrl-github">
              <i class="fas fa-github" aria-hidden="true"></i>
              <span>Github</span>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDrawer',
    data: {
      visible: false,
      top: 0,
      openArr: [],
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      isOpen(index) {
        if (this.openArr.includes(index)) {
          return true;
        } else {
          return false;
        }
      },
      openOrCloseMenu(curIndex) {
        const index = this.openArr.indexOf(curIndex);
        if (index !== -1) {
          this.openArr.splice(index, 1);
        } else {
          this.openArr.push(curIndex);
        }
      },
      showDialogDrawer() {
        this.visible = true;
        // Èò≤Ê≠¢È°µÈù¢ÊªöÂä®ÔºåÂè™ËÉΩËÆ©ÂºπÊ°ÜÊªöÂä®
        this.top = $(document).scrollTop()
        body.style.cssText = 'width: 100%; height: 100%;overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      }
    },
    created() {}
  })
</script>

    </div>
    <div class="blog-title" id="author-avatar">
      
        <div class="avatar">
          <img src="/medias/logo.png" class="lazyload placeholder" data-srcset="/medias/logo.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="logo">
        </div>
      
      <a href="/" class="logo">Hexo</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/" class="menu-item-link" title="È¶ñÈ°µ">
                  
                    <i class="fas fa-home" aria-hidden="true"></i>
                  
                  <span class="name">È¶ñÈ°µ</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/archives" class="menu-item-link" title="ÂΩíÊ°£">
                  
                    <i class="fas fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">ÂΩíÊ°£</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/tags" class="menu-item-link" title="Ê†áÁ≠æ">
                  
                    <i class="fas fa-tags" aria-hidden="true"></i>
                  
                  <span class="name">Ê†áÁ≠æ</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/categories" class="menu-item-link" title="ÂàÜÁ±ª">
                  
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">ÂàÜÁ±ª</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/about" class="menu-item-link" title="ÂÖ≥‰∫é">
                  
                    <i class="fas fa-user" aria-hidden="true"></i>
                  
                  <span class="name">ÂÖ≥‰∫é</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/friends" class="menu-item-link" title="ÂèãÊÉÖÈìæÊé•">
                  
                  <span class="name">ÂèãÊÉÖÈìæÊé•</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="javascript:;" class="menu-item-link" title="üê±Êõ¥Â§ö">
                  
                  <span class="name">üê±Êõ¥Â§ö</span>
                  <i class="fas fa-chevron-down arrow" aria-hidden="true"></i>
                </a>
                <ul class="sub-menu">
                  
                  <li>
                    <a href="/gallery">
                      
                      <span>üì∑ÂõæÂ∫ì</span>
                    </a>
                  </li>
                  
                  <li>
                    <a href="/me">
                      
                      <span>üßíüèªÂÖ≥‰∫éÊàë</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
        
      </ul>
      
      
        <div id="appSearch">
  <div class="search"  @click="showDialog()"><i class="fas fa-search" aria-hidden="true"></i></div>
  <transition name="fade">
    <div class="message-box_wrapper" style="display: none;" v-cloak v-show="dialogVisible" @click.self="cancelDialogVisible()">
      <div class="message-box animated bounceInDown">
        <h2>
          <span>
            <i class="fas fa-search" aria-hidden="true"></i>
            <span class="title">Êú¨Âú∞ÊêúÁ¥¢</span>
          </span>
          <i class="fas fa-times close" pointer style="float:right;" aria-hidden="true" @click.self="cancelDialogVisible()"></i>
        </h2>
        <form class="site-search-form">
          <input type="text"
            placeholder="ËØ∑ËæìÂÖ•ÂÖ≥ÈîÆÂ≠ó"
            id="local-search-input" 
            @click="getSearchFile()"
            class="st-search-input"
            v-model="searchInput"
          />
        </form>
        <div class="result-wrapper">
          <div id="local-search-result" class="local-search-result-cls"></div>
        </div>
      </div>
    </div>
  </transition>
</div>
<script src="/js/local_search.js"></script>
<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appSearch',
    data: {
      dialogVisible: false,
      searchInput: '',
      top: 0,
    },
    computed: {
    },
    mounted() {
      window.addEventListener('pjax:complete', () => {
        this.cancelDialogVisible();
      })
    },
    methods: {
      showDialog() {
        this.dialogVisible = true;
        // Èò≤Ê≠¢È°µÈù¢ÊªöÂä®ÔºåÂè™ËÉΩËÆ©ÂºπÊ°ÜÊªöÂä®
        this.top = $(document).scrollTop()
        body.style.cssText = 'overflow: hidden;';
      },
      getSearchFile() {
        if (!this.searchInput) {
          getSearchFile("/search.xml");
        }
      },
      cancelDialogVisible() {
        this.dialogVisible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
    },
    created() {}
  })
</script>
<!-- Ëß£ÂÜ≥Âà∑Êñ∞È°µÈù¢Èó™ÁÉÅÈóÆÈ¢òÔºåÂèØ‰ª•Âú®ÂÖÉÁ¥†‰∏äÊ∑ªÂä†display: none, ÊàñËÄÖÁî®vue.extendÊñπÊ≥ïÔºåËØ¶ÊÉÖÔºöhttps://blog.csdn.net/qq_31393401/article/details/81017912 -->
<!-- ‰∏ãÈù¢ÊòØÊêúÁ¥¢Âü∫Êú¨ÂÜôÊ≥ï -->
<!-- <script type="text/javascript" id="local.search.active">
  var inputArea = document.querySelector("#local-search-input");
  inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
  inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script> -->

      

    </nav>
  </div>
  
    <a target="_blank" rel="noopener" href="https://github.com/ctrl-github" class="github-corner color-primary" aria-label="View source on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  
  
    <div id="he-plugin-simple"></div>
    <script>
      WIDGET = {
        CONFIG: {
          "modules": "012",
          "background": 5,
          "tmpColor": "4A4A4A",
          "tmpSize": 16,
          "cityColor": "4A4A4A",
          "citySize": 16,
          "aqiSize": 16,
          "weatherIconSize": 24,
          "alertIconSize": 18,
          "padding": "10px 10px 10px 10px",
          "shadow": "1",
          "language": "auto",
          "borderRadius": 5,
          "fixed": "false",
          "vertical": "middle",
          "horizontal": "center",
          "key": "2784dd3fcb1e4f0f9a9b579bf69641f2"
        }
      }
    </script>
    <script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script> 
    

    <!-- ÂΩìÂ§¥ÈÉ®ÂØºËà™ËÆæÁΩÆ‰∏∫ËÉåÊôØÈÄèÊòéÁöÑÊó∂ÂÄô  -->
    
      <script src="/js/header/index.js" data-pjax></script>
    
</header>

    <!-- ÈúÄË¶ÅÂú®‰∏äÈù¢Âä†ËΩΩÁöÑjs -->
    <script>
  function loadScript(src, cb) {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }

  //https://github.com/filamentgroup/loadCSS
  var loadCSS = function (href, before, media, attributes) {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  };

</script> 

<!-- ËΩÆÊí≠ÂõæÊâÄÈúÄË¶ÅÁöÑjs -->
<script src="/js/swiper/swiper.min.js"></script>
<script src="/js/swiper/vue-awesome-swiper.js"></script>
<script src="/js/swiper/swiper.animate1.0.3.min.js"></script>


  <script src="/js/vue-typed-js/index.js"></script>


<!-- È¶ñÈ°µÁöÑÂÖ¨ÂëäÊªöÂä®Êèí‰ª∂ÁöÑjsÈúÄË¶ÅÈáçÊñ∞Âä†ËΩΩ -->
<script src="/js/vue-seamless-scroll/index.js"></script>

<!-- ÊâìÂ≠óÊú∫ÊïàÊûújs -->
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>


    <!-- ÂÜÖÂÆπÂå∫Âüü -->
    <div id="safearea">
      <main class="main" id="pjax-container" style="margin-top: 0;">
        
 <!-- prismjs ‰ª£Á†ÅÈ´ò‰∫Æ -->
 
    
    <link href="/js/prism/prism-line-numbers.css" rel="stylesheet">
    
        <link href="/js/prism/prism.min.css" rel="stylesheet">
    

    <style>
        pre[class*="language-"] {
            overflow-y: hidden;
        }
        .line-numbers .line-numbers-rows {
            border: none;
        }
    </style>
  


<div class="bg-dark-floor" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -1;"></div>

<!-- ÊñáÁ´†ËØ¶ÊÉÖÈ°µÈ°∂ÈÉ®ÂõæÁâáÂíåÊ†áÈ¢ò -->




<div class="post-detail-header" id="thumbnail_canvas" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;background-image:url('/medias/15.jpg')">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="post-detail-header_info-box">
    <div class="title-box">
      <span class="title">
        Learn-SpringCloudAlibaba
      </span>
    </div>
    
    
      
        <span class="post-detail-header_date">
          <i class="fas fa-calendar"></i> ÂèëË°®‰∫éÔºö2022-11-22 |
        </span>
      

      
        <span class="post-detail-header_categories">
          <i class="iconfont iconbookmark1"></i> ÂàÜÁ±ªÔºö
          
            <a href="/categories/SpringCloudAlibaba/" class="post-detail-header_category">
              SpringCloudAlibaba
            </a>
          
            <a href="/categories/SpringCloudAlibaba/SpringCloud/" class="post-detail-header_category">
              SpringCloud
            </a>
          
            <a href="/categories/SpringCloudAlibaba/SpringCloud/Spring/" class="post-detail-header_category">
              Spring
            </a>
          
        </span>
      

      
        <div class="post-detail-header_wordcount">
          <span class="totalcount">
            <i class="fas fa-file-text-o"></i> Â≠óÊï∞ÁªüËÆ°: 24.2k |
          </span>
  
          <span class="min2read">
            <i class="fas fa-clock"></i> ÈòÖËØªÊó∂Èïø: 122ÂàÜÈíü |
          </span>
  
          
            <span class="reading">
              <i class="fas fa-eye"></i> ÈòÖËØªÈáèÔºö<span id="busuanzi_value_page_pv"></span>
            </span>
          
        </div>
      
    
  </div>
  
  
    <script src="/js/bubble/bubble.js"></script>
  
</div>



<div class="row justify-position">
  <div class="main-content">
    <article class="post post-detail">
      <div class="post-content">
        <p>Learn-SpringCloudAlibaba</p>
<h1 id="SpringCloud-AlibabaÂÖ•Èó®ÁÆÄ‰ªã"><a href="#SpringCloud-AlibabaÂÖ•Èó®ÁÆÄ‰ªã" class="headerlink" title="SpringCloud AlibabaÂÖ•Èó®ÁÆÄ‰ªã"></a>SpringCloud AlibabaÂÖ•Èó®ÁÆÄ‰ªã</h1><h2 id="why‰ºöÂá∫Áé∞SpringCloud-alibaba"><a href="#why‰ºöÂá∫Áé∞SpringCloud-alibaba" class="headerlink" title="why‰ºöÂá∫Áé∞SpringCloud alibaba"></a>why‰ºöÂá∫Áé∞SpringCloud alibaba</h2><h3 id="Spring-Cloud-NetflixÈ°πÁõÆËøõÂÖ•Áª¥Êä§Ê®°Âºè"><a href="#Spring-Cloud-NetflixÈ°πÁõÆËøõÂÖ•Áª¥Êä§Ê®°Âºè" class="headerlink" title="Spring Cloud NetflixÈ°πÁõÆËøõÂÖ•Áª¥Êä§Ê®°Âºè"></a>Spring Cloud NetflixÈ°πÁõÆËøõÂÖ•Áª¥Êä§Ê®°Âºè</h3><blockquote>
<p> <a target="_blank" rel="noopener" href="https://spring.io/blog/2018/12/12/spring-cloud-greenwich-rc1-available-now">https://spring.io/blog/2018/12/12/spring-cloud-greenwich-rc1-available-now</a></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali0.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali0.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>ËØ¥Êòé</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali1.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali1.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>Spring Cloud Netflix Projects Entering Maintenance Mode</strong></p>
<p>‰ªÄ‰πàÊòØÁª¥Êä§Ê®°Âºè</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali2.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali2.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>Â∞ÜÊ®°ÂùóÁΩÆ‰∫éÁª¥Êä§Ê®°ÂºèÔºåÊÑèÂë≥ÁùÄ Spring Cloud Âõ¢ÈòüÂ∞Ü‰∏ç‰ºöÂÜçÂêëÊ®°ÂùóÊ∑ªÂä†Êñ∞ÂäüËÉΩ„ÄÇ<br>Êàë‰ª¨Â∞Ü‰øÆÂ§ç block Á∫ßÂà´ÁöÑ bug ‰ª•ÂèäÂÆâÂÖ®ÈóÆÈ¢òÔºåÊàë‰ª¨‰πü‰ºöËÄÉËôëÂπ∂ÂÆ°Êü•Á§æÂå∫ÁöÑÂ∞èÂûã pull request„ÄÇ</p>
<p>ËøõÂÖ•Áª¥Êä§Ê®°ÂºèÊÑèÂë≥ÁùÄ‰ªÄ‰πàÂë¢Ôºü</p>
<p><strong>ËøõÂÖ•Áª¥Êä§Ê®°ÂºèÊÑèÂë≥ÁùÄSpring Cloud Netflix Â∞Ü‰∏çÂÜçÂºÄÂèëÊñ∞ÁöÑÁªÑ‰ª∂</strong><br>Êàë‰ª¨ÈÉΩÁü•ÈÅìSpring Cloud ÁâàÊú¨Ëø≠‰ª£ÁÆóÊòØÊØîËæÉÂø´ÁöÑÔºåÂõ†ËÄåÂá∫Áé∞‰∫ÜÂæàÂ§öÈáçÂ§ßISSUEÈÉΩËøòÊù•‰∏çÂèäFixÂ∞±ÂèàÊé®Âè¶‰∏Ä‰∏™Release‰∫Ü„ÄÇËøõÂÖ•Áª¥Êä§Ê®°ÂºèÊÑèÊÄùÂ∞±ÊòØÁõÆÂâç‰∏ÄÁõ¥‰ª•Âêé‰∏ÄÊÆµÊó∂Èó¥Spring Cloud NetflixÊèê‰æõÁöÑÊúçÂä°ÂíåÂäüËÉΩÂ∞±Ëøô‰πàÂ§ö‰∫ÜÔºå‰∏çÂú®ÂºÄÂèëÊñ∞ÁöÑÁªÑ‰ª∂ÂíåÂäüËÉΩ‰∫Ü„ÄÇ‰ª•ÂêéÂ∞Ü‰ª•Áª¥Êä§ÂíåMergeÂàÜÊîØFull Request‰∏∫‰∏ª</p>
<p><strong>Êñ∞ÁªÑ‰ª∂ÂäüËÉΩÂ∞Ü‰ª•ÂÖ∂‰ªñÊõø‰ª£Âπ≥‰ª£ÊõøÁöÑÊñπÂºèÂÆûÁé∞</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali3.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali3.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h2 id="SpringCloud-alibabaÂ∏¶Êù•‰∫Ü‰ªÄ‰πà"><a href="#SpringCloud-alibabaÂ∏¶Êù•‰∫Ü‰ªÄ‰πà" class="headerlink" title="SpringCloud alibabaÂ∏¶Êù•‰∫Ü‰ªÄ‰πà"></a>SpringCloud alibabaÂ∏¶Êù•‰∫Ü‰ªÄ‰πà</h2><h3 id="ÊòØ‰ªÄ‰πà"><a href="#ÊòØ‰ªÄ‰πà" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h3><blockquote>
<p> ÂÆòÁΩëÔºö<br><a target="_blank" rel="noopener" href="https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md">https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md</a></p>
<p>ËØûÁîüÔºö<br>2018.10.31ÔºåSpring Cloud Alibaba Ê≠£ÂºèÂÖ•È©ª‰∫Ü Spring Cloud ÂÆòÊñπÂ≠µÂåñÂô®ÔºåÂπ∂Âú® Maven ‰∏≠Â§ÆÂ∫ìÂèëÂ∏É‰∫ÜÁ¨¨‰∏Ä‰∏™ÁâàÊú¨„ÄÇ</p>
<p> <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali4.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali4.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="ËÉΩÂπ≤Âòõ"><a href="#ËÉΩÂπ≤Âòõ" class="headerlink" title="ËÉΩÂπ≤Âòõ"></a>ËÉΩÂπ≤Âòõ</h3><blockquote>
<table>
<thead>
<tr>
<th>ÊúçÂä°ÈôêÊµÅÈôçÁ∫ß</th>
<th>ÈªòËÆ§ÊîØÊåÅ Servlet„ÄÅFeign„ÄÅRestTemplate„ÄÅDubbo Âíå RocketMQ ÈôêÊµÅÈôçÁ∫ßÂäüËÉΩÁöÑÊé•ÂÖ•ÔºåÂèØ‰ª•Âú®ËøêË°åÊó∂ÈÄöËøáÊéßÂà∂Âè∞ÂÆûÊó∂‰øÆÊîπÈôêÊµÅÈôçÁ∫ßËßÑÂàôÔºåËøòÊîØÊåÅÊü•ÁúãÈôêÊµÅÈôçÁ∫ß Metrics ÁõëÊéß„ÄÇ</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞</strong></td>
<td><strong>ÈÄÇÈÖç Spring Cloud ÊúçÂä°Ê≥®ÂÜå‰∏éÂèëÁé∞Ê†áÂáÜÔºåÈªòËÆ§ÈõÜÊàê‰∫Ü Ribbon ÁöÑÊîØÊåÅ„ÄÇ</strong></td>
</tr>
<tr>
<td><strong>ÂàÜÂ∏ÉÂºèÈÖçÁΩÆÁÆ°ÁêÜ</strong></td>
<td><strong>ÊîØÊåÅÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁöÑÂ§ñÈÉ®ÂåñÈÖçÁΩÆÔºåÈÖçÁΩÆÊõ¥ÊîπÊó∂Ëá™Âä®Âà∑Êñ∞„ÄÇ</strong></td>
</tr>
<tr>
<td><strong>Ê∂àÊÅØÈ©±Âä®ËÉΩÂäõ</strong></td>
<td><strong>Âü∫‰∫é Spring Cloud Stream ‰∏∫ÂæÆÊúçÂä°Â∫îÁî®ÊûÑÂª∫Ê∂àÊÅØÈ©±Âä®ËÉΩÂäõ„ÄÇ</strong></td>
</tr>
<tr>
<td><strong>ÈòøÈáå‰∫ëÂØπË±°Â≠òÂÇ®</strong></td>
<td><strong>ÈòøÈáå‰∫ëÊèê‰æõÁöÑÊµ∑Èáè„ÄÅÂÆâÂÖ®„ÄÅ‰ΩéÊàêÊú¨„ÄÅÈ´òÂèØÈù†ÁöÑ‰∫ëÂ≠òÂÇ®ÊúçÂä°„ÄÇÊîØÊåÅÂú®‰ªª‰ΩïÂ∫îÁî®„ÄÅ‰ªª‰ΩïÊó∂Èó¥„ÄÅ‰ªª‰ΩïÂú∞ÁÇπÂ≠òÂÇ®ÂíåËÆøÈóÆ‰ªªÊÑèÁ±ªÂûãÁöÑÊï∞ÊçÆ„ÄÇ</strong></td>
</tr>
<tr>
<td><strong>ÂàÜÂ∏ÉÂºè‰ªªÂä°Ë∞ÉÂ∫¶</strong></td>
<td><strong>Êèê‰æõÁßíÁ∫ß„ÄÅÁ≤æÂáÜ„ÄÅÈ´òÂèØÈù†„ÄÅÈ´òÂèØÁî®ÁöÑÂÆöÊó∂ÔºàÂü∫‰∫é Cron Ë°®ËææÂºèÔºâ‰ªªÂä°Ë∞ÉÂ∫¶ÊúçÂä°„ÄÇÂêåÊó∂Êèê‰æõÂàÜÂ∏ÉÂºèÁöÑ‰ªªÂä°ÊâßË°åÊ®°ÂûãÔºåÂ¶ÇÁΩëÊ†º‰ªªÂä°„ÄÇÁΩëÊ†º‰ªªÂä°ÊîØÊåÅÊµ∑ÈáèÂ≠ê‰ªªÂä°ÂùáÂåÄÂàÜÈÖçÂà∞ÊâÄÊúâ WorkerÔºàschedulerx-clientÔºâ‰∏äÊâßË°å„ÄÇ</strong></td>
</tr>
</tbody></table>
</blockquote>
<h3 id="ÂéªÂì™‰∏ã"><a href="#ÂéªÂì™‰∏ã" class="headerlink" title="ÂéªÂì™‰∏ã"></a>ÂéªÂì™‰∏ã</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md">https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md</a></p>
</blockquote>
<h3 id="ÊÄé‰πàÁé©"><a href="#ÊÄé‰πàÁé©" class="headerlink" title="ÊÄé‰πàÁé©"></a>ÊÄé‰πàÁé©<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali5.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali5.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></h3><h2 id="SpringCloud-alibabaÂ≠¶‰π†ËµÑÊñôËé∑Âèñ"><a href="#SpringCloud-alibabaÂ≠¶‰π†ËµÑÊñôËé∑Âèñ" class="headerlink" title="SpringCloud alibabaÂ≠¶‰π†ËµÑÊñôËé∑Âèñ"></a>SpringCloud alibabaÂ≠¶‰π†ËµÑÊñôËé∑Âèñ</h2><h3 id="ÂÆòÁΩë"><a href="#ÂÆòÁΩë" class="headerlink" title="ÂÆòÁΩë"></a>ÂÆòÁΩë</h3><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali6.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali6.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg">Spring Cloud Alibaba Ëá¥Âäõ‰∫éÊèê‰æõÂæÆÊúçÂä°ÂºÄÂèëÁöÑ‰∏ÄÁ´ôÂºèËß£ÂÜ≥ÊñπÊ°à„ÄÇÊ≠§È°πÁõÆÂåÖÂê´ÂºÄÂèëÂàÜÂ∏ÉÂºèÂ∫îÁî®ÂæÆÊúçÂä°ÁöÑÂøÖÈúÄÁªÑ‰ª∂ÔºåÊñπ‰æøÂºÄÂèëËÄÖÈÄöËøá Spring Cloud ÁºñÁ®ãÊ®°ÂûãËΩªÊùæ‰ΩøÁî®Ëøô‰∫õÁªÑ‰ª∂Êù•ÂºÄÂèëÂàÜÂ∏ÉÂºèÂ∫îÁî®ÊúçÂä°„ÄÇ</p>
<p>‰æùÊâò Spring Cloud AlibabaÔºåÊÇ®Âè™ÈúÄË¶ÅÊ∑ªÂä†‰∏Ä‰∫õÊ≥®Ëß£ÂíåÂ∞ëÈáèÈÖçÁΩÆÔºåÂ∞±ÂèØ‰ª•Â∞Ü Spring Cloud Â∫îÁî®Êé•ÂÖ•ÈòøÈáåÂæÆÊúçÂä°Ëß£ÂÜ≥ÊñπÊ°àÔºåÈÄöËøáÈòøÈáå‰∏≠Èó¥‰ª∂Êù•ËøÖÈÄüÊê≠Âª∫ÂàÜÂ∏ÉÂºèÂ∫îÁî®Á≥ªÁªü„ÄÇ</p>
<p> SpringCloud AlibabaËøõÂÖ•‰∫ÜSpringCloudÂÆòÊñπÂ≠µÂåñÂô®ÔºåËÄå‰∏îÊØï‰∏ö‰∫Ü</p>
<p> <a target="_blank" rel="noopener" href="https://spring.io/projects/spring-cloud-alibaba#overview">https://spring.io/projects/spring-cloud-alibaba#overview</a></p>
</blockquote>
<h3 id="Ëã±Êñá"><a href="#Ëã±Êñá" class="headerlink" title="Ëã±Êñá"></a>Ëã±Êñá</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/spring-cloud-alibaba">https://github.com/alibaba/spring-cloud-alibaba</a></p>
<p><a target="_blank" rel="noopener" href="https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html">https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html</a></p>
</blockquote>
<h3 id="‰∏≠Êñá"><a href="#‰∏≠Êñá" class="headerlink" title="‰∏≠Êñá"></a>‰∏≠Êñá</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md">https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md</a></p>
</blockquote>
<h1 id="SpringCloud-Alibaba-NacosÊúçÂä°Ê≥®ÂÜåÂíåÈÖçÁΩÆ‰∏≠ÂøÉ"><a href="#SpringCloud-Alibaba-NacosÊúçÂä°Ê≥®ÂÜåÂíåÈÖçÁΩÆ‰∏≠ÂøÉ" class="headerlink" title="SpringCloud Alibaba NacosÊúçÂä°Ê≥®ÂÜåÂíåÈÖçÁΩÆ‰∏≠ÂøÉ"></a>SpringCloud Alibaba NacosÊúçÂä°Ê≥®ÂÜåÂíåÈÖçÁΩÆ‰∏≠ÂøÉ</h1><h2 id="NacosÁÆÄ‰ªã"><a href="#NacosÁÆÄ‰ªã" class="headerlink" title="NacosÁÆÄ‰ªã"></a>NacosÁÆÄ‰ªã</h2><h3 id="‰∏∫‰ªÄ‰πàÂè´Nacos"><a href="#‰∏∫‰ªÄ‰πàÂè´Nacos" class="headerlink" title="‰∏∫‰ªÄ‰πàÂè´Nacos"></a>‰∏∫‰ªÄ‰πàÂè´Nacos</h3><blockquote>
<p><strong>ÂâçÂõõ‰∏™Â≠óÊØçÂàÜÂà´‰∏∫NamingÂíåConfigurationÁöÑÂâç‰∏§‰∏™Â≠óÊØçÔºåÊúÄÂêéÁöÑs‰∏∫Service„ÄÇ</strong></p>
</blockquote>
<h3 id="ÊòØ‰ªÄ‰πà-1"><a href="#ÊòØ‰ªÄ‰πà-1" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h3><ul>
<li>‰∏Ä‰∏™Êõ¥Êòì‰∫éÊûÑÂª∫‰∫ëÂéüÁîüÂ∫îÁî®ÁöÑÂä®ÊÄÅÊúçÂä°ÂèëÁé∞„ÄÅÈÖçÁΩÆÁÆ°ÁêÜÂíåÊúçÂä°ÁÆ°ÁêÜÂπ≥Âè∞„ÄÇ</li>
<li>Nacos: Dynamic Naming and Configuration Service</li>
<li>NacosÂ∞±ÊòØÊ≥®ÂÜå‰∏≠ÂøÉ + ÈÖçÁΩÆ‰∏≠ÂøÉÁöÑÁªÑÂêà   Á≠â‰ª∑‰∫é  Nacos &#x3D; Eureka+Config +Bus</li>
</ul>
<h3 id="ËÉΩÂπ≤Âòõ-1"><a href="#ËÉΩÂπ≤Âòõ-1" class="headerlink" title="ËÉΩÂπ≤Âòõ"></a>ËÉΩÂπ≤Âòõ</h3><ul>
<li>Êõø‰ª£EurekaÂÅöÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉ</li>
<li>Êõø‰ª£ConfigÂÅöÊúçÂä°ÈÖçÁΩÆ‰∏≠ÂøÉ</li>
</ul>
<h3 id="ÂéªÂì™‰∏ã-1"><a href="#ÂéªÂì™‰∏ã-1" class="headerlink" title="ÂéªÂì™‰∏ã"></a>ÂéªÂì™‰∏ã</h3><p><a target="_blank" rel="noopener" href="https://github.com/alibaba/Nacos">https://github.com/alibaba/Nacos</a></p>
<p>ÂÆòÁΩëÊñáÊ°£</p>
<p><a target="_blank" rel="noopener" href="https://nacos.io/zh-cn/index.html">https://nacos.io/zh-cn/index.html</a></p>
<p><a target="_blank" rel="noopener" href="https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_nacos_discovery">https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_nacos_discovery</a></p>
<h3 id="ÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÊØîËæÉ"><a href="#ÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÊØîËæÉ" class="headerlink" title="ÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÊØîËæÉ"></a>ÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÊØîËæÉ</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali7.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali7.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÊçÆËØ¥ Nacos Âú®ÈòøÈáåÂ∑¥Â∑¥ÂÜÖÈÉ®ÊúâË∂ÖËøá 10 ‰∏áÁöÑÂÆû‰æãËøêË°åÔºåÂ∑≤ÁªèËøá‰∫ÜÁ±ª‰ººÂèåÂçÅ‰∏ÄÁ≠âÂêÑÁßçÂ§ßÂûãÊµÅÈáèÁöÑËÄÉÈ™å</p>
<h2 id="ÂÆâË£ÖÂπ∂ËøêË°åNacos"><a href="#ÂÆâË£ÖÂπ∂ËøêË°åNacos" class="headerlink" title="ÂÆâË£ÖÂπ∂ËøêË°åNacos"></a>ÂÆâË£ÖÂπ∂ËøêË°åNacos</h2><p>1.Êú¨Âú∞Java8+MavenÁéØÂ¢ÉÂ∑≤ÁªèOK</p>
<p>2.ÂÖà‰ªéÂÆòÁΩë‰∏ãËΩΩNacos</p>
<p>‚Äã		<a target="_blank" rel="noopener" href="https://github.com/alibaba/nacos/releases">https://github.com/alibaba/nacos/releases</a>  <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali8.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali8.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>3.Ëß£ÂéãÂÆâË£ÖÂåÖÔºåÁõ¥Êé•ËøêË°åbinÁõÆÂΩï‰∏ãÁöÑstartup.cmd   <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali9.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali9.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>4.ÂëΩ‰ª§ËøêË°åÊàêÂäüÂêéÁõ¥Êé•ËÆøÈóÆ<a target="_blank" rel="noopener" href="http://localhost:8848/nacos">http://localhost:8848/nacos</a>  ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†ÅÈÉΩÊòØnacos</p>
<p>5.ÁªìÊûúÈ°µÈù¢<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali10.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali10.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h2 id="Nacos‰Ωú‰∏∫ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÊºîÁ§∫"><a href="#Nacos‰Ωú‰∏∫ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÊºîÁ§∫" class="headerlink" title="Nacos‰Ωú‰∏∫ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÊºîÁ§∫"></a>Nacos‰Ωú‰∏∫ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÊºîÁ§∫</h2><h3 id="ÂÆòÁΩëÊñáÊ°£"><a href="#ÂÆòÁΩëÊñáÊ°£" class="headerlink" title="ÂÆòÁΩëÊñáÊ°£"></a>ÂÆòÁΩëÊñáÊ°£</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_nacos_config">https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_nacos_config</a></p>
</blockquote>
<h3 id="Âü∫‰∫éNacosÁöÑÊúçÂä°Êèê‰æõËÄÖ"><a href="#Âü∫‰∫éNacosÁöÑÊúçÂä°Êèê‰æõËÄÖ" class="headerlink" title="Âü∫‰∫éNacosÁöÑÊúçÂä°Êèê‰æõËÄÖ"></a>Âü∫‰∫éNacosÁöÑÊúçÂä°Êèê‰æõËÄÖ</h3><h4 id="Êñ∞Âª∫Module-cloudalibaba-provider-payment9001"><a href="#Êñ∞Âª∫Module-cloudalibaba-provider-payment9001" class="headerlink" title="Êñ∞Âª∫Module cloudalibaba-provider-payment9001"></a>Êñ∞Âª∫Module cloudalibaba-provider-payment9001</h4><h4 id="ÊîπPOM"><a href="#ÊîπPOM" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><h5 id="Áà∂POM"><a href="#Áà∂POM" class="headerlink" title="Áà∂POM"></a>Áà∂POM</h5><p>Â¶ÇÊûúÊÇ®ÊòØMaven CentralÁî®Êà∑ÔºåËØ∑Â∞ÜÊàë‰ª¨ÁöÑBOMÊ∑ªÂä†Âà∞pom.xml <dependencyManagement>ÈÉ®ÂàÜ„ÄÇËøôÂ∞ÜÂÖÅËÆ∏ÊÇ®ÂøΩÁï•‰ªª‰ΩïMaven‰æùËµñÈ°πÁöÑÁâàÊú¨ÔºåËÄåÊòØÂ∞ÜÁâàÊú¨ÊéßÂà∂ÂßîÊâòÁªôBOM„ÄÇ</p>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Âú®‰∏ãÈù¢ÁöÑÁ´†ËäÇ‰∏≠ÔºåÊàë‰ª¨Â∞ÜÂÅáËÆæÊÇ®‰ΩøÁî®ÁöÑÊòØSpring Cloud Alibaba BOMÔºåÂπ∂‰∏î‰æùËµñÈ°π‰ª£Á†ÅÁâáÊÆµÂ∞Ü‰∏çÂåÖÂê´ÁâàÊú¨„ÄÇ</p>
<h5 id="Êú¨Ê®°ÂùóPOM"><a href="#Êú¨Ê®°ÂùóPOM" class="headerlink" title="Êú¨Ê®°ÂùóPOM"></a>Êú¨Ê®°ÂùóPOM</h5><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"> 
<span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloudalibaba-provider-payment9001<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- SpringBootÊï¥ÂêàWebÁªÑ‰ª∂ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--Êó•Â∏∏ÈÄöÁî®jarÂåÖÈÖçÁΩÆ--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ÊîπYML"><a href="#ÊîπYML" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9001</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#ÈÖçÁΩÆNacosÂú∞ÂùÄ</span>

<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">'*'</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="‰∏ªÂêØÂä®"><a href="#‰∏ªÂêØÂä®" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h4><h5 id="PaymentMain9001"><a href="#PaymentMain9001" class="headerlink" title="PaymentMain9001"></a>PaymentMain9001</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain9001</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain9001</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏öÂä°Á±ª"><a href="#‰∏öÂä°Á±ª" class="headerlink" title="‰∏öÂä°Á±ª"></a>‰∏öÂä°Á±ª</h4><h5 id="PaymentController"><a href="#PaymentController" class="headerlink" title="PaymentController"></a>PaymentController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java">
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span>
<span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;server.port&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/payment/nacos/&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPayment</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"nacos registry, serverPort: "</span><span class="token operator">+</span> serverPort<span class="token operator">+</span><span class="token string">"\t id"</span><span class="token operator">+</span>id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ÊµãËØï"><a href="#ÊµãËØï" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h4><ul>
<li><p><a target="_blank" rel="noopener" href="http://localhost:9001/payment/nacos/1">http://localhost:9001/payment/nacos/1</a></p>
</li>
<li><p>nacosÊéßÂà∂Âè∞</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali11.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali11.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</li>
<li><p>nacosÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉ+ÊúçÂä°Êèê‰æõËÄÖ9001ÈÉΩOK‰∫Ü</p>
</li>
</ul>
<h4 id="‰∏∫‰∫Ü‰∏ã‰∏ÄÁ´†ËäÇÊºîÁ§∫nacosÁöÑË¥üËΩΩÂùáË°°ÔºåÂèÇÁÖß9001Êñ∞Âª∫9002"><a href="#‰∏∫‰∫Ü‰∏ã‰∏ÄÁ´†ËäÇÊºîÁ§∫nacosÁöÑË¥üËΩΩÂùáË°°ÔºåÂèÇÁÖß9001Êñ∞Âª∫9002" class="headerlink" title="‰∏∫‰∫Ü‰∏ã‰∏ÄÁ´†ËäÇÊºîÁ§∫nacosÁöÑË¥üËΩΩÂùáË°°ÔºåÂèÇÁÖß9001Êñ∞Âª∫9002"></a>‰∏∫‰∫Ü‰∏ã‰∏ÄÁ´†ËäÇÊºîÁ§∫nacosÁöÑË¥üËΩΩÂùáË°°ÔºåÂèÇÁÖß9001Êñ∞Âª∫9002</h4><ul>
<li>Êñ∞Âª∫cloudalibaba-provider-payment9002</li>
<li>9002ÂÖ∂ÂÆÉÊ≠•È™§‰Ω†ÊáÇÁöÑ</li>
<li>ÊàñËÄÖÂèñÂ∑ß‰∏çÊÉ≥Êñ∞Âª∫ÈáçÂ§ç‰ΩìÂäõÂä≥Âä®ÔºåÁõ¥Êé•Êã∑Ë¥ùËôöÊãüÁ´ØÂè£Êò†Â∞Ñ</li>
</ul>
<blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali12.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali12.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali13.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali13.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali14.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali14.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="Âü∫‰∫éNacosÁöÑÊúçÂä°Ê∂àË¥πËÄÖ"><a href="#Âü∫‰∫éNacosÁöÑÊúçÂä°Ê∂àË¥πËÄÖ" class="headerlink" title="Âü∫‰∫éNacosÁöÑÊúçÂä°Ê∂àË¥πËÄÖ"></a>Âü∫‰∫éNacosÁöÑÊúçÂä°Ê∂àË¥πËÄÖ</h3><h4 id="Êñ∞Âª∫Module-cloudalibaba-consumer-nacos-order83"><a href="#Êñ∞Âª∫Module-cloudalibaba-consumer-nacos-order83" class="headerlink" title="Êñ∞Âª∫Module cloudalibaba-consumer-nacos-order83"></a>Êñ∞Âª∫Module cloudalibaba-consumer-nacos-order83</h4><h4 id="ÊîπPOM-1"><a href="#ÊîπPOM-1" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloudalibaba-consumer-nacos-order83<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- ÂºïÂÖ•Ëá™Â∑±ÂÆö‰πâÁöÑapiÈÄöÁî®ÂåÖÔºåÂèØ‰ª•‰ΩøÁî®PaymentÊîØ‰ªòEntity --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;project.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- SpringBootÊï¥ÂêàWebÁªÑ‰ª∂ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--Êó•Â∏∏ÈÄöÁî®jarÂåÖÈÖçÁΩÆ--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span>
 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>‰∏∫‰ªÄ‰πànacosÊîØÊåÅË¥üËΩΩÂùáË°°</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali15.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali15.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÊîπYML-1"><a href="#ÊîπYML-1" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">83</span>


<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>order<span class="token punctuation">-</span>consumer
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>


<span class="token comment">#Ê∂àË¥πËÄÖÂ∞ÜË¶ÅÂéªËÆøÈóÆÁöÑÂæÆÊúçÂä°ÂêçÁß∞(Ê≥®ÂÜåÊàêÂäüËøõnacosÁöÑÂæÆÊúçÂä°Êèê‰æõËÄÖ)</span>
<span class="token key atrule">service-url</span><span class="token punctuation">:</span>
  <span class="token key atrule">nacos-user-service</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider 
 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="‰∏ªÂêØÂä®-1"><a href="#‰∏ªÂêØÂä®-1" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h4><h5 id="OrderNacosMain83"><a href="#OrderNacosMain83" class="headerlink" title="OrderNacosMain83"></a>OrderNacosMain83</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosMain83</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">OrderNacosMain83</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏öÂä°Á±ª-1"><a href="#‰∏öÂä°Á±ª-1" class="headerlink" title="‰∏öÂä°Á±ª"></a>‰∏öÂä°Á±ª</h4><p>PaymentController</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;server.port&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/payment/&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPayment</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"nacos registry, serverPort: "</span> <span class="token operator">+</span> serverPort <span class="token operator">+</span> <span class="token string">"\t id"</span> <span class="token operator">+</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ApplicationContextBean"><a href="#ApplicationContextBean" class="headerlink" title="ApplicationContextBean"></a>ApplicationContextBean</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>loadbalancer<span class="token punctuation">.</span></span><span class="token class-name">LoadBalanced</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextBean</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@LoadBalanced</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="OrderNacosController"><a href="#OrderNacosController" class="headerlink" title="OrderNacosController"></a>OrderNacosController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosController</span>
<span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;service-url.nacos-user-service&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverURL<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/payment/nacos/&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>serverURL<span class="token operator">+</span><span class="token string">"/payment/nacos/"</span><span class="token operator">+</span>id<span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ÊµãËØï-1"><a href="#ÊµãËØï-1" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h4><p>nacosÊéßÂà∂Âè∞</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali16.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali16.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><a target="_blank" rel="noopener" href="http://localhost:83/consumer/payment/nacos/1">http://localhost:83/consumer/payment/nacos/1</a>		83ËÆøÈóÆ9001&#x2F;9002ÔºåËΩÆËØ¢Ë¥üËΩΩOK</p>
<h3 id="ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÂØπÊØî"><a href="#ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÂØπÊØî" class="headerlink" title="ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÂØπÊØî"></a>ÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÂØπÊØî</h3><h4 id="ÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÂØπÊØî"><a href="#ÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÂØπÊØî" class="headerlink" title="ÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÂØπÊØî"></a>ÂêÑÁßçÊ≥®ÂÜå‰∏≠ÂøÉÂØπÊØî</h4><h5 id="NacosÂÖ®ÊôØÂõæÊâÄÁ§∫"><a href="#NacosÂÖ®ÊôØÂõæÊâÄÁ§∫" class="headerlink" title="NacosÂÖ®ÊôØÂõæÊâÄÁ§∫"></a>NacosÂÖ®ÊôØÂõæÊâÄÁ§∫</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali17.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali17.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>NacosÂíåCAP</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali18.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali18.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali19.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali19.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÂàáÊç¢  </p>
<p>‚Äã		Nacos ÊîØÊåÅAPÂíåCPÊ®°ÂºèÁöÑÂàáÊç¢</p>
<blockquote>
<p><strong>CÊòØÊâÄÊúâËäÇÁÇπÂú®Âêå‰∏ÄÊó∂Èó¥ÁúãÂà∞ÁöÑÊï∞ÊçÆÊòØ‰∏ÄËá¥ÁöÑÔºõËÄåAÁöÑÂÆö‰πâÊòØÊâÄÊúâÁöÑËØ∑Ê±ÇÈÉΩ‰ºöÊî∂Âà∞ÂìçÂ∫î„ÄÇ</strong></p>
<p><strong>‰ΩïÊó∂ÈÄâÊã©‰ΩøÁî®‰ΩïÁßçÊ®°ÂºèÔºü</strong><br>‰∏ÄËà¨Êù•ËØ¥Ôºå<br>Â¶ÇÊûú‰∏çÈúÄË¶ÅÂ≠òÂÇ®ÊúçÂä°Á∫ßÂà´ÁöÑ‰ø°ÊÅØ‰∏îÊúçÂä°ÂÆû‰æãÊòØÈÄöËøánacos-clientÊ≥®ÂÜåÔºåÂπ∂ËÉΩÂ§ü‰øùÊåÅÂøÉË∑≥‰∏äÊä•ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÈÄâÊã©APÊ®°Âºè„ÄÇÂΩìÂâç‰∏ªÊµÅÁöÑÊúçÂä°Â¶Ç Spring cloud Âíå Dubbo ÊúçÂä°ÔºåÈÉΩÈÄÇÁî®‰∫éAPÊ®°ÂºèÔºåAPÊ®°Âºè‰∏∫‰∫ÜÊúçÂä°ÁöÑÂèØËÉΩÊÄßËÄåÂáèÂº±‰∫Ü‰∏ÄËá¥ÊÄßÔºåÂõ†Ê≠§APÊ®°Âºè‰∏ãÂè™ÊîØÊåÅÊ≥®ÂÜå‰∏¥Êó∂ÂÆû‰æã„ÄÇ</p>
<p>Â¶ÇÊûúÈúÄË¶ÅÂú®ÊúçÂä°Á∫ßÂà´ÁºñËæëÊàñËÄÖÂ≠òÂÇ®ÈÖçÁΩÆ‰ø°ÊÅØÔºåÈÇ£‰πà CP ÊòØÂøÖÈ°ªÔºåK8SÊúçÂä°ÂíåDNSÊúçÂä°ÂàôÈÄÇÁî®‰∫éCPÊ®°Âºè„ÄÇ<br>CPÊ®°Âºè‰∏ãÂàôÊîØÊåÅÊ≥®ÂÜåÊåÅ‰πÖÂåñÂÆû‰æãÔºåÊ≠§Êó∂ÂàôÊòØ‰ª• Raft ÂçèËÆÆ‰∏∫ÈõÜÁæ§ËøêË°åÊ®°ÂºèÔºåËØ•Ê®°Âºè‰∏ãÊ≥®ÂÜåÂÆû‰æã‰πãÂâçÂøÖÈ°ªÂÖàÊ≥®ÂÜåÊúçÂä°ÔºåÂ¶ÇÊûúÊúçÂä°‰∏çÂ≠òÂú®ÔºåÂàô‰ºöËøîÂõûÈîôËØØ„ÄÇ</p>
<p>curl -X PUT ‚Äò$NACOS_SERVER:8848&#x2F;nacos&#x2F;v1&#x2F;ns&#x2F;operator&#x2F;switches?entry&#x3D;serverMode&amp;value&#x3D;CP‚Äô</p>
</blockquote>
<h2 id="Nacos‰Ωú‰∏∫ÊúçÂä°ÈÖçÁΩÆ‰∏≠ÂøÉÊºîÁ§∫"><a href="#Nacos‰Ωú‰∏∫ÊúçÂä°ÈÖçÁΩÆ‰∏≠ÂøÉÊºîÁ§∫" class="headerlink" title="Nacos‰Ωú‰∏∫ÊúçÂä°ÈÖçÁΩÆ‰∏≠ÂøÉÊºîÁ§∫"></a>Nacos‰Ωú‰∏∫ÊúçÂä°ÈÖçÁΩÆ‰∏≠ÂøÉÊºîÁ§∫</h2><h3 id="Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉ-Âü∫Á°ÄÈÖçÁΩÆ"><a href="#Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉ-Âü∫Á°ÄÈÖçÁΩÆ" class="headerlink" title="Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉ-Âü∫Á°ÄÈÖçÁΩÆ"></a>Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉ-Âü∫Á°ÄÈÖçÁΩÆ</h3><h4 id="Êñ∞Âª∫Module-cloudalibaba-config-nacos-client3377"><a href="#Êñ∞Âª∫Module-cloudalibaba-config-nacos-client3377" class="headerlink" title="Êñ∞Âª∫Module cloudalibaba-config-nacos-client3377"></a>Êñ∞Âª∫Module cloudalibaba-config-nacos-client3377</h4><h4 id="ÊîπPOM-2"><a href="#ÊîπPOM-2" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloudalibaba-config-nacos-client3377<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--nacos-config--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--nacos-discovery--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--web + actuator--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--‰∏ÄËà¨Âü∫Á°ÄÈÖçÁΩÆ--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span>
 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ÊîπYML-2"><a href="#ÊîπYML-2" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><h5 id="whyÈÖçÁΩÆ‰∏§‰∏™"><a href="#whyÈÖçÁΩÆ‰∏§‰∏™" class="headerlink" title="whyÈÖçÁΩÆ‰∏§‰∏™"></a>whyÈÖçÁΩÆ‰∏§‰∏™</h5><blockquote>
<p><strong>NacosÂêåspringcloud-config‰∏ÄÊ†∑ÔºåÂú®È°πÁõÆÂàùÂßãÂåñÊó∂ÔºåË¶Å‰øùËØÅÂÖà‰ªéÈÖçÁΩÆ‰∏≠ÂøÉËøõË°åÈÖçÁΩÆÊãâÂèñÔºå</strong><br><strong>ÊãâÂèñÈÖçÁΩÆ‰πãÂêéÔºåÊâçËÉΩ‰øùËØÅÈ°πÁõÆÁöÑÊ≠£Â∏∏ÂêØÂä®„ÄÇ</strong></p>
<p><strong>springboot‰∏≠ÈÖçÁΩÆÊñá‰ª∂ÁöÑÂä†ËΩΩÊòØÂ≠òÂú®‰ºòÂÖàÁ∫ßÈ°∫Â∫èÁöÑÔºåbootstrap‰ºòÂÖàÁ∫ßÈ´ò‰∫éapplication</strong></p>
</blockquote>
<h5 id="YML"><a href="#YML" class="headerlink" title="YML"></a>YML</h5><h6 id="bootstrap"><a href="#bootstrap" class="headerlink" title="bootstrap"></a>bootstrap</h6><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># nacosÈÖçÁΩÆ</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3377</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>config<span class="token punctuation">-</span>client
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#NacosÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÂú∞ÂùÄ</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉÂú∞ÂùÄ</span>
        <span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yaml <span class="token comment">#ÊåáÂÆöyamlÊ†ºÂºèÁöÑÈÖçÁΩÆ</span>
 
 
<span class="token comment">#$&#123;spring.application.name&#125;-$&#123;spring.profile.active&#125;.$&#123;spring.cloud.nacos.config.file-extension&#125;</span>
 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="application"><a href="#application" class="headerlink" title="application"></a>application</h6><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
 <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
   <span class="token key atrule">active</span><span class="token punctuation">:</span> dev <span class="token comment"># Ë°®Á§∫ÂºÄÂèëÁéØÂ¢É</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏ªÂêØÂä®-2"><a href="#‰∏ªÂêØÂä®-2" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h4><h5 id="NacosConfigClientMain3377"><a href="#NacosConfigClientMain3377" class="headerlink" title="NacosConfigClientMain3377"></a>NacosConfigClientMain3377</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NacosConfigClientMain3377</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NacosConfigClientMain3377</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏öÂä°Á±ª-2"><a href="#‰∏öÂä°Á±ª-2" class="headerlink" title="‰∏öÂä°Á±ª"></a>‰∏öÂä°Á±ª</h4><h5 id="ConfigClientController"><a href="#ConfigClientController" class="headerlink" title="ConfigClientController"></a>ConfigClientController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>context<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RefreshScope</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RefreshScope</span> <span class="token comment">//Âú®ÊéßÂà∂Âô®Á±ªÂä†ÂÖ•@RefreshScopeÊ≥®Ëß£‰ΩøÂΩìÂâçÁ±ª‰∏ãÁöÑÈÖçÁΩÆÊîØÊåÅNacosÁöÑÂä®ÊÄÅÂà∑Êñ∞ÂäüËÉΩ„ÄÇ</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;config.info&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/config/info"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getConfigInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> configInfo<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="RefreshScope"><a href="#RefreshScope" class="headerlink" title="@RefreshScope"></a>@RefreshScope</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali20.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali20.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="Âú®Nacos‰∏≠Ê∑ªÂä†ÈÖçÁΩÆ‰ø°ÊÅØ"><a href="#Âú®Nacos‰∏≠Ê∑ªÂä†ÈÖçÁΩÆ‰ø°ÊÅØ" class="headerlink" title="Âú®Nacos‰∏≠Ê∑ªÂä†ÈÖçÁΩÆ‰ø°ÊÅØ"></a>Âú®Nacos‰∏≠Ê∑ªÂä†ÈÖçÁΩÆ‰ø°ÊÅØ</h4><p>Nacos‰∏≠ÁöÑÂåπÈÖçËßÑÂàô</p>
<h5 id="ÁêÜËÆ∫"><a href="#ÁêÜËÆ∫" class="headerlink" title="ÁêÜËÆ∫"></a>ÁêÜËÆ∫</h5><blockquote>
<p><code>Nacos‰∏≠ÁöÑdataidÁöÑÁªÑÊàêÊ†ºÂºèÂèä‰∏éSpringBootÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑÂåπÈÖçËßÑÂàô</code></p>
<p><strong>ÂÆòÁΩë:</strong></p>
<p><a target="_blank" rel="noopener" href="https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html">https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html</a></p>
<ol>
<li>Ê∑ªÂä†‰æùËµñÔºö</li>
</ol>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;latest.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Ê≥®ÊÑè</strong>ÔºöÁâàÊú¨ <a target="_blank" rel="noopener" href="https://mvnrepository.com/artifact/com.alibaba.cloud/spring-cloud-starter-alibaba-nacos-config">2.1.x.RELEASE</a> ÂØπÂ∫îÁöÑÊòØ Spring Boot 2.1.x ÁâàÊú¨„ÄÇÁâàÊú¨ <a target="_blank" rel="noopener" href="https://mvnrepository.com/artifact/com.alibaba.cloud/spring-cloud-starter-alibaba-nacos-config">2.0.x.RELEASE</a> ÂØπÂ∫îÁöÑÊòØ Spring Boot 2.0.x ÁâàÊú¨ÔºåÁâàÊú¨ <a target="_blank" rel="noopener" href="https://mvnrepository.com/artifact/com.alibaba.cloud/spring-cloud-starter-alibaba-nacos-config">1.5.x.RELEASE</a> ÂØπÂ∫îÁöÑÊòØ Spring Boot 1.5.x ÁâàÊú¨„ÄÇ</p>
<p>Êõ¥Â§öÁâàÊú¨ÂØπÂ∫îÂÖ≥Á≥ªÂèÇËÄÉÔºö<a target="_blank" rel="noopener" href="https://github.com/spring-cloud-incubator/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E">ÁâàÊú¨ËØ¥Êòé Wiki</a></p>
<ol>
<li>Âú® <code>bootstrap.properties</code> ‰∏≠ÈÖçÁΩÆ Nacos server ÁöÑÂú∞ÂùÄÂíåÂ∫îÁî®Âêç</li>
</ol>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">spring.cloud.nacos.config.server-addr</span><span class="token punctuation">=</span><span class="token attr-value">127.0.0.1:8848</span>

<span class="token attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token attr-value">example</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ËØ¥ÊòéÔºö‰πãÊâÄ‰ª•ÈúÄË¶ÅÈÖçÁΩÆ <code>spring.application.name</code> ÔºåÊòØÂõ†‰∏∫ÂÆÉÊòØÊûÑÊàê Nacos ÈÖçÁΩÆÁÆ°ÁêÜ <code>dataId</code>Â≠óÊÆµÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ</p>
<p>Âú® Nacos Spring Cloud ‰∏≠Ôºå<code>dataId</code> ÁöÑÂÆåÊï¥Ê†ºÂºèÂ¶Ç‰∏ãÔºö</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties">$&#123;prefix&#125;-$&#123;spring.profiles.active&#125;.$&#123;file-extension&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><code>prefix</code> ÈªòËÆ§‰∏∫ <code>spring.application.name</code> ÁöÑÂÄºÔºå‰πüÂèØ‰ª•ÈÄöËøáÈÖçÁΩÆÈ°π <code>spring.cloud.nacos.config.prefix</code>Êù•ÈÖçÁΩÆ„ÄÇ</li>
<li><code>spring.profiles.active</code> Âç≥‰∏∫ÂΩìÂâçÁéØÂ¢ÉÂØπÂ∫îÁöÑ profileÔºåËØ¶ÊÉÖÂèØ‰ª•ÂèÇËÄÉ <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-profiles.html#boot-features-profiles">Spring BootÊñáÊ°£</a>„ÄÇ <strong>Ê≥®ÊÑèÔºöÂΩì <code>spring.profiles.active</code> ‰∏∫Á©∫Êó∂ÔºåÂØπÂ∫îÁöÑËøûÊé•Á¨¶ <code>-</code> ‰πüÂ∞Ü‰∏çÂ≠òÂú®ÔºådataId ÁöÑÊãºÊé•Ê†ºÂºèÂèòÊàê <code>$&#123;prefix&#125;.$&#123;file-extension&#125;</code></strong></li>
<li><code>file-exetension</code> ‰∏∫ÈÖçÁΩÆÂÜÖÂÆπÁöÑÊï∞ÊçÆÊ†ºÂºèÔºåÂèØ‰ª•ÈÄöËøáÈÖçÁΩÆÈ°π <code>spring.cloud.nacos.config.file-extension</code> Êù•ÈÖçÁΩÆ„ÄÇÁõÆÂâçÂè™ÊîØÊåÅ <code>properties</code> Âíå <code>yaml</code> Á±ªÂûã„ÄÇ</li>
</ul>
<ol>
<li>ÈÄöËøá Spring Cloud ÂéüÁîüÊ≥®Ëß£ <code>@RefreshScope</code> ÂÆûÁé∞ÈÖçÁΩÆËá™Âä®Êõ¥Êñ∞Ôºö</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/config"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RefreshScope</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigController</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;useLocalCache:false&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> useLocalCache<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> useLocalCache<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>È¶ñÂÖàÈÄöËøáË∞ÉÁî® <a target="_blank" rel="noopener" href="https://nacos.io/zh-cn/docs/open-api.html">Nacos Open API</a> Âêë Nacos Server ÂèëÂ∏ÉÈÖçÁΩÆÔºödataId ‰∏∫<code>example.properties</code>ÔºåÂÜÖÂÆπ‰∏∫<code>useLocalCache=true</code></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">curl <span class="token operator">-</span>X POST <span class="token string">"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=example.properties&amp;group=DEFAULT_GROUP&amp;content=useLocalCache=true"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol>
<li>ËøêË°å <code>NacosConfigApplication</code>ÔºåË∞ÉÁî® <code>curl http://localhost:8080/config/get</code>ÔºåËøîÂõûÂÜÖÂÆπÊòØ <code>true</code>„ÄÇ</li>
<li>ÂÜçÊ¨°Ë∞ÉÁî® <a target="_blank" rel="noopener" href="https://nacos.io/zh-cn/docs/open-api.html">Nacos Open API</a> Âêë Nacos server ÂèëÂ∏ÉÈÖçÁΩÆÔºödataId ‰∏∫<code>example.properties</code>ÔºåÂÜÖÂÆπ‰∏∫<code>useLocalCache=false</code></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">curl <span class="token operator">-</span>X POST <span class="token string">"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=example.properties&amp;group=DEFAULT_GROUP&amp;content=useLocalCache=false"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol>
<li>ÂÜçÊ¨°ËÆøÈóÆ <code>http://localhost:8080/config/get</code>ÔºåÊ≠§Êó∂ËøîÂõûÂÜÖÂÆπ‰∏∫<code>false</code>ÔºåËØ¥ÊòéÁ®ãÂ∫è‰∏≠ÁöÑ<code>useLocalCache</code>ÂÄºÂ∑≤ÁªèË¢´Âä®ÊÄÅÊõ¥Êñ∞‰∫Ü„ÄÇ</li>
</ol>
</blockquote>
<h5 id="ÂÆûÊìç"><a href="#ÂÆûÊìç" class="headerlink" title="ÂÆûÊìç"></a>ÂÆûÊìç</h5><h6 id="ÈÖçÁΩÆÊñ∞Â¢û"><a href="#ÈÖçÁΩÆÊñ∞Â¢û" class="headerlink" title="ÈÖçÁΩÆÊñ∞Â¢û"></a>ÈÖçÁΩÆÊñ∞Â¢û</h6><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali21.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali21.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>nacos-config-client-dev.yaml</p>
<h6 id="NacosÁïåÈù¢ÈÖçÁΩÆÂØπÂ∫î"><a href="#NacosÁïåÈù¢ÈÖçÁΩÆÂØπÂ∫î" class="headerlink" title="NacosÁïåÈù¢ÈÖçÁΩÆÂØπÂ∫î"></a>NacosÁïåÈù¢ÈÖçÁΩÆÂØπÂ∫î</h6><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali22.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali22.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ËÆæÁΩÆDataId</p>
<p>1„ÄÅÂÖ¨ÂºèÔºö</p>
<blockquote>
<p><strong>${spring.application.name}-${spring.profiles.active}.${spring.cloud.nacos.config.file-extension}</strong></p>
</blockquote>
<p>2„ÄÅprefix ÈªòËÆ§‰∏∫ spring.application.name ÁöÑÂÄº</p>
<p>3„ÄÅspring.profile.active Âç≥‰∏∫ÂΩìÂâçÁéØÂ¢ÉÂØπÂ∫îÁöÑ profileÔºåÂèØ‰ª•ÈÄöËøáÈÖçÁΩÆÈ°π spring.profile.active Êù•ÈÖçÁΩÆ„ÄÇ</p>
<p>4„ÄÅfile-exetension ‰∏∫ÈÖçÁΩÆÂÜÖÂÆπÁöÑÊï∞ÊçÆÊ†ºÂºèÔºåÂèØ‰ª•ÈÄöËøáÈÖçÁΩÆÈ°π spring.cloud.nacos.config.file-extension Êù•ÈÖçÁΩÆ</p>
<p>5„ÄÅÂ∞èÊÄªÁªìËØ¥Êòé</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali23.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali23.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h6 id="ÂéÜÂè≤ÈÖçÁΩÆ"><a href="#ÂéÜÂè≤ÈÖçÁΩÆ" class="headerlink" title="ÂéÜÂè≤ÈÖçÁΩÆ"></a>ÂéÜÂè≤ÈÖçÁΩÆ</h6><p>Nacos‰ºöËÆ∞ÂΩïÈÖçÁΩÆÊñá‰ª∂ÁöÑÂéÜÂè≤ÁâàÊú¨ÈªòËÆ§‰øùÁïô30Â§©ÔºåÊ≠§Â§ñËøòÊúâ‰∏ÄÈîÆÂõûÊªöÂäüËÉΩÔºåÂõûÊªöÊìç‰ΩúÂ∞Ü‰ºöËß¶ÂèëÈÖçÁΩÆÊõ¥Êñ∞</p>
<p>ÂõûÊªö<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali24.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali24.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÊµãËØï-2"><a href="#ÊµãËØï-2" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h4><ul>
<li>ÂêØÂä®ÂâçÈúÄË¶ÅÂú®nacosÂÆ¢Êà∑Á´Ø-ÈÖçÁΩÆÁÆ°ÁêÜ-ÈÖçÁΩÆÁÆ°ÁêÜÊ†èÁõÆ‰∏ãÊúâÂØπÂ∫îÁöÑyamlÈÖçÁΩÆÊñá‰ª∂</li>
<li>ËøêË°åcloud-config-nacos-client3377ÁöÑ‰∏ªÂêØÂä®Á±ª</li>
<li>Ë∞ÉÁî®Êé•Âè£Êü•ÁúãÈÖçÁΩÆ‰ø°ÊÅØ <a target="_blank" rel="noopener" href="http://localhost:3377/config/info">http://localhost:3377/config/info</a></li>
</ul>
<h4 id="Ëá™Â∏¶Âä®ÊÄÅÂà∑Êñ∞"><a href="#Ëá™Â∏¶Âä®ÊÄÅÂà∑Êñ∞" class="headerlink" title="Ëá™Â∏¶Âä®ÊÄÅÂà∑Êñ∞"></a>Ëá™Â∏¶Âä®ÊÄÅÂà∑Êñ∞</h4><blockquote>
<p> ‰øÆÊîπ‰∏ãNacos‰∏≠ÁöÑyamlÈÖçÁΩÆÊñá‰ª∂ÔºåÂÜçÊ¨°Ë∞ÉÁî®Êü•ÁúãÈÖçÁΩÆÁöÑÊé•Âè£ÔºåÂ∞±‰ºöÂèëÁé∞ÈÖçÁΩÆÂ∑≤ÁªèÂà∑Êñ∞</p>
</blockquote>
<h3 id="Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉ-ÂàÜÁ±ªÈÖçÁΩÆ"><a href="#Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉ-ÂàÜÁ±ªÈÖçÁΩÆ" class="headerlink" title="Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉ-ÂàÜÁ±ªÈÖçÁΩÆ"></a>Nacos‰Ωú‰∏∫ÈÖçÁΩÆ‰∏≠ÂøÉ-ÂàÜÁ±ªÈÖçÁΩÆ</h3><h4 id="ÈóÆÈ¢ò"><a href="#ÈóÆÈ¢ò" class="headerlink" title="ÈóÆÈ¢ò"></a>ÈóÆÈ¢ò</h4><p>Â§öÁéØÂ¢ÉÂ§öÈ°πÁõÆÁÆ°ÁêÜ</p>
<blockquote>
<p>ÈóÆÈ¢ò1Ôºö<br>    ÂÆûÈôÖÂºÄÂèë‰∏≠ÔºåÈÄöÂ∏∏‰∏Ä‰∏™Á≥ªÁªü‰ºöÂáÜÂ§á<br>    devÂºÄÂèëÁéØÂ¢É<br>    testÊµãËØïÁéØÂ¢É<br>    prodÁîü‰∫ßÁéØÂ¢É„ÄÇ<br>    Â¶Ç‰Ωï‰øùËØÅÊåáÂÆöÁéØÂ¢ÉÂêØÂä®Êó∂ÊúçÂä°ËÉΩÊ≠£Á°ÆËØªÂèñÂà∞Nacos‰∏äÁõ∏Â∫îÁéØÂ¢ÉÁöÑÈÖçÁΩÆÊñá‰ª∂Âë¢Ôºü</p>
<p>ÈóÆÈ¢ò2Ôºö<br>    ‰∏Ä‰∏™Â§ßÂûãÂàÜÂ∏ÉÂºèÂæÆÊúçÂä°Á≥ªÁªü‰ºöÊúâÂæàÂ§öÂæÆÊúçÂä°Â≠êÈ°πÁõÆÔºå<br>    ÊØè‰∏™ÂæÆÊúçÂä°È°πÁõÆÂèàÈÉΩ‰ºöÊúâÁõ∏Â∫îÁöÑÂºÄÂèëÁéØÂ¢É„ÄÅÊµãËØïÁéØÂ¢É„ÄÅÈ¢ÑÂèëÁéØÂ¢É„ÄÅÊ≠£ÂºèÁéØÂ¢É‚Ä¶‚Ä¶<br>    ÈÇ£ÊÄé‰πàÂØπËøô‰∫õÂæÆÊúçÂä°ÈÖçÁΩÆËøõË°åÁÆ°ÁêÜÂë¢Ôºü</p>
</blockquote>
<h4 id="NacosÁöÑÂõæÂΩ¢ÂåñÁÆ°ÁêÜÁïåÈù¢"><a href="#NacosÁöÑÂõæÂΩ¢ÂåñÁÆ°ÁêÜÁïåÈù¢" class="headerlink" title="NacosÁöÑÂõæÂΩ¢ÂåñÁÆ°ÁêÜÁïåÈù¢"></a>NacosÁöÑÂõæÂΩ¢ÂåñÁÆ°ÁêÜÁïåÈù¢</h4><h5 id="ÈÖçÁΩÆÁÆ°ÁêÜ"><a href="#ÈÖçÁΩÆÁÆ°ÁêÜ" class="headerlink" title="ÈÖçÁΩÆÁÆ°ÁêÜ"></a>ÈÖçÁΩÆÁÆ°ÁêÜ<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali25.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali25.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></h5><h5 id="ÂëΩÂêçÁ©∫Èó¥"><a href="#ÂëΩÂêçÁ©∫Èó¥" class="headerlink" title="ÂëΩÂêçÁ©∫Èó¥"></a>ÂëΩÂêçÁ©∫Èó¥</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali26.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali26.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="Namespace-Group-Data-ID‰∏âËÄÖÂÖ≥Á≥ªÔºü‰∏∫‰ªÄ‰πàËøô‰πàËÆæËÆ°Ôºü"><a href="#Namespace-Group-Data-ID‰∏âËÄÖÂÖ≥Á≥ªÔºü‰∏∫‰ªÄ‰πàËøô‰πàËÆæËÆ°Ôºü" class="headerlink" title="Namespace+Group+Data ID‰∏âËÄÖÂÖ≥Á≥ªÔºü‰∏∫‰ªÄ‰πàËøô‰πàËÆæËÆ°Ôºü"></a>Namespace+Group+Data ID‰∏âËÄÖÂÖ≥Á≥ªÔºü‰∏∫‰ªÄ‰πàËøô‰πàËÆæËÆ°Ôºü</h4><blockquote>
<p><strong>1 ÊòØ‰ªÄ‰πà</strong><br>   Á±ª‰ººJavaÈáåÈù¢ÁöÑpackageÂêçÂíåÁ±ªÂêç<br>   ÊúÄÂ§ñÂ±ÇÁöÑnamespaceÊòØÂèØ‰ª•Áî®‰∫éÂå∫ÂàÜÈÉ®ÁΩ≤ÁéØÂ¢ÉÁöÑÔºåGroupÂíåDataIDÈÄªËæë‰∏äÂå∫ÂàÜ‰∏§‰∏™ÁõÆÊ†áÂØπË±°„ÄÇ<br><strong>2 ‰∏âËÄÖÊÉÖÂÜµ</strong><br>    <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali27.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali27.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"><br><strong>ÈªòËÆ§ÊÉÖÂÜµÔºö</strong><br><strong>Namespace&#x3D;publicÔºåGroup&#x3D;DEFAULT_GROUP, ÈªòËÆ§ClusterÊòØDEFAULT</strong></p>
<p>NacosÈªòËÆ§ÁöÑÂëΩÂêçÁ©∫Èó¥ÊòØpublicÔºåNamespace‰∏ªË¶ÅÁî®Êù•ÂÆûÁé∞ÈöîÁ¶ª„ÄÇ<br>ÊØîÊñπËØ¥Êàë‰ª¨Áé∞Âú®Êúâ‰∏â‰∏™ÁéØÂ¢ÉÔºöÂºÄÂèë„ÄÅÊµãËØï„ÄÅÁîü‰∫ßÁéØÂ¢ÉÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÂàõÂª∫‰∏â‰∏™NamespaceÔºå‰∏çÂêåÁöÑNamespace‰πãÈó¥ÊòØÈöîÁ¶ªÁöÑ„ÄÇ</p>
<p>GroupÈªòËÆ§ÊòØDEFAULT_GROUPÔºåGroupÂèØ‰ª•Êää‰∏çÂêåÁöÑÂæÆÊúçÂä°ÂàíÂàÜÂà∞Âêå‰∏Ä‰∏™ÂàÜÁªÑÈáåÈù¢Âéª</p>
<p>ServiceÂ∞±ÊòØÂæÆÊúçÂä°Ôºõ‰∏Ä‰∏™ServiceÂèØ‰ª•ÂåÖÂê´Â§ö‰∏™ClusterÔºàÈõÜÁæ§ÔºâÔºåNacosÈªòËÆ§ClusterÊòØDEFAULTÔºåClusterÊòØÂØπÊåáÂÆöÂæÆÊúçÂä°ÁöÑ‰∏Ä‰∏™ËôöÊãüÂàíÂàÜ„ÄÇ<br>ÊØîÊñπËØ¥‰∏∫‰∫ÜÂÆπÁÅæÔºåÂ∞ÜServiceÂæÆÊúçÂä°ÂàÜÂà´ÈÉ®ÁΩ≤Âú®‰∫ÜÊù≠Â∑ûÊú∫ÊàøÂíåÂπøÂ∑ûÊú∫ÊàøÔºå<br>ËøôÊó∂Â∞±ÂèØ‰ª•ÁªôÊù≠Â∑ûÊú∫ÊàøÁöÑServiceÂæÆÊúçÂä°Ëµ∑‰∏Ä‰∏™ÈõÜÁæ§ÂêçÁß∞ÔºàHZÔºâÔºå<br>ÁªôÂπøÂ∑ûÊú∫ÊàøÁöÑServiceÂæÆÊúçÂä°Ëµ∑‰∏Ä‰∏™ÈõÜÁæ§ÂêçÁß∞ÔºàGZÔºâÔºåËøòÂèØ‰ª•Â∞ΩÈáèËÆ©Âêå‰∏Ä‰∏™Êú∫ÊàøÁöÑÂæÆÊúçÂä°‰∫íÁõ∏Ë∞ÉÁî®Ôºå‰ª•ÊèêÂçáÊÄßËÉΩ„ÄÇ</p>
<p>ÊúÄÂêéÊòØInstanceÔºåÂ∞±ÊòØÂæÆÊúçÂä°ÁöÑÂÆû‰æã„ÄÇ</p>
</blockquote>
<h4 id="Case"><a href="#Case" class="headerlink" title="Case"></a>Case</h4><h5 id="‰∏âÁßçÊñπÊ°àÂä†ËΩΩÈÖçÁΩÆ"><a href="#‰∏âÁßçÊñπÊ°àÂä†ËΩΩÈÖçÁΩÆ" class="headerlink" title="‰∏âÁßçÊñπÊ°àÂä†ËΩΩÈÖçÁΩÆ"></a>‰∏âÁßçÊñπÊ°àÂä†ËΩΩÈÖçÁΩÆ</h5><p>DataIDÊñπÊ°à</p>
<ul>
<li><p>ÊåáÂÆöspring.profile.activeÂíåÈÖçÁΩÆÊñá‰ª∂ÁöÑDataIDÊù•‰Ωø‰∏çÂêåÁéØÂ¢É‰∏ãËØªÂèñ‰∏çÂêåÁöÑÈÖçÁΩÆ</p>
</li>
<li><p>ÈªòËÆ§Á©∫Èó¥+ÈªòËÆ§ÂàÜÁªÑ+Êñ∞Âª∫devÂíåtest‰∏§‰∏™DataID</p>
<blockquote>
<p><strong>Êñ∞Âª∫devÈÖçÁΩÆDataID Êñ∞Âª∫testÈÖçÁΩÆDataID</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali28.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali28.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>Êñ∞Âª∫testÈÖçÁΩÆDataID</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali29.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali29.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
</li>
<li><p>ÈÄöËøáspring.profile.activeÂ±ûÊÄßÂ∞±ËÉΩËøõË°åÂ§öÁéØÂ¢É‰∏ãÈÖçÁΩÆÊñá‰ª∂ÁöÑËØªÂèñ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali30.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali30.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</li>
<li><p>ÊµãËØï</p>
<p><a target="_blank" rel="noopener" href="http://localhost:3377/config/info">http://localhost:3377/config/info</a></p>
<p>ÈÖçÁΩÆÊòØ‰ªÄ‰πàÂ∞±Âä†ËΩΩ‰ªÄ‰πà  test</p>
</li>
</ul>
<h6 id="GroupÊñπÊ°à"><a href="#GroupÊñπÊ°à" class="headerlink" title="GroupÊñπÊ°à"></a>GroupÊñπÊ°à</h6><p>ÈÄöËøáGroupÂÆûÁé∞ÁéØÂ¢ÉÂå∫ÂàÜ</p>
<blockquote>
<p>Êñ∞Âª∫Group TEST_GROUP</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali31.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali31.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<p>Âú®nacosÂõæÂΩ¢ÁïåÈù¢ÊéßÂà∂Âè∞‰∏äÈù¢Êñ∞Âª∫ÈÖçÁΩÆÊñá‰ª∂DataID</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali32.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali32.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>bootstrap+application</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali33.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali33.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<blockquote>
<p>Âú®config‰∏ãÂ¢ûÂä†‰∏ÄÊù°groupÁöÑÈÖçÁΩÆÂç≥ÂèØ„ÄÇ ÂèØÈÖçÁΩÆ‰∏∫DEV_GROUPÊàñTEST_GROUP</p>
</blockquote>
<h6 id="NamespaceÊñπÊ°à"><a href="#NamespaceÊñπÊ°à" class="headerlink" title="NamespaceÊñπÊ°à"></a>NamespaceÊñπÊ°à</h6><p>Êñ∞Âª∫dev&#x2F;testÁöÑNamespace</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali34.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali34.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÂõûÂà∞ÊúçÂä°ÁÆ°ÁêÜ-ÊúçÂä°ÂàóË°®Êü•Áúã</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali35.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali35.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÊåâÁÖßÂüüÂêçÈÖçÁΩÆÂ°´ÂÜô</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali36.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali36.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>YML</p>
<p>bootstrap</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token key atrule">namespace</span><span class="token punctuation">:</span> xxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>application</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># NacosÊ≥®ÂÜåÈÖçÁΩÆÔºåapplication.yml</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
    <span class="token comment">#active: test</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="NacosÈõÜÁæ§ÂíåÊåÅ‰πÖÂåñÈÖçÁΩÆÔºàÈáçË¶ÅÔºâ"><a href="#NacosÈõÜÁæ§ÂíåÊåÅ‰πÖÂåñÈÖçÁΩÆÔºàÈáçË¶ÅÔºâ" class="headerlink" title="NacosÈõÜÁæ§ÂíåÊåÅ‰πÖÂåñÈÖçÁΩÆÔºàÈáçË¶ÅÔºâ"></a>NacosÈõÜÁæ§ÂíåÊåÅ‰πÖÂåñÈÖçÁΩÆÔºàÈáçË¶ÅÔºâ</h2><h2 id="ÂÆòÁΩëËØ¥Êòé"><a href="#ÂÆòÁΩëËØ¥Êòé" class="headerlink" title="ÂÆòÁΩëËØ¥Êòé"></a>ÂÆòÁΩëËØ¥Êòé</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html">https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html</a></p>
<p>ÂÆòÁΩëÊû∂ÊûÑÂõæ(ÂÜôÁöÑo(‚ï•Ôπè‚ï•)o)</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali37.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali37.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>‰∏äÂõæÂÆòÁΩëÁøªËØëÔºåÁúüÂÆûÊÉÖÂÜµ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali38.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali38.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ËØ¥Êòé</p>
<p>ÊåâÁÖß‰∏äËø∞ÔºåÊàë‰ª¨ÈúÄË¶ÅmysqlÊï∞ÊçÆÂ∫ì</p>
<p>ÂÆòÁΩëËØ¥Êòé</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://nacos.io/zh-cn/docs/deployment.html">https://nacos.io/zh-cn/docs/deployment.html</a></p>
<p>ÈáçÁÇπËØ¥Êòé</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali39.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali39.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali40.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali40.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
</blockquote>
<h2 id="NacosÊåÅ‰πÖÂåñÈÖçÁΩÆËß£Èáä"><a href="#NacosÊåÅ‰πÖÂåñÈÖçÁΩÆËß£Èáä" class="headerlink" title="NacosÊåÅ‰πÖÂåñÈÖçÁΩÆËß£Èáä"></a>NacosÊåÅ‰πÖÂåñÈÖçÁΩÆËß£Èáä</h2><p>NacosÈªòËÆ§Ëá™Â∏¶ÁöÑÊòØÂµåÂÖ•ÂºèÊï∞ÊçÆÂ∫ìderby</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/nacos/blob/develop/config/pom.xml">https://github.com/alibaba/nacos/blob/develop/config/pom.xml</a></p>
</blockquote>
<p>derbyÂà∞mysqlÂàáÊç¢ÈÖçÁΩÆÊ≠•È™§</p>
<blockquote>
<p>nacos-server-1.1.4\nacos\confÁõÆÂΩï‰∏ãÊâæÂà∞sqlËÑöÊú¨  nacos-mysql.sql</p>
<p>ÊâßË°åËÑöÊú¨</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"> 
CREATE DATABASE nacos_config;
USE nacos_config;
 
/<span class="token important">******************************************/</span>
/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   <span class="token important">*/</span>
/*   Ë°®ÂêçÁß∞ = config_info   <span class="token important">*/</span>
/<span class="token important">******************************************/</span>
CREATE TABLE `config_info` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT 'id'<span class="token punctuation">,</span>
  `data_id` VARCHAR(255) NOT NULL COMMENT 'data_id'<span class="token punctuation">,</span>
  `group_id` VARCHAR(255) DEFAULT NULL<span class="token punctuation">,</span>
  `content` LONGTEXT NOT NULL COMMENT 'content'<span class="token punctuation">,</span>
  `md5` VARCHAR(32) DEFAULT NULL COMMENT 'md5'<span class="token punctuation">,</span>
  `gmt_create` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT 'ÂàõÂª∫Êó∂Èó¥'<span class="token punctuation">,</span>
  `gmt_modified` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT '‰øÆÊîπÊó∂Èó¥'<span class="token punctuation">,</span>
  `src_user` TEXT COMMENT 'source user'<span class="token punctuation">,</span>
  `src_ip` VARCHAR(20) DEFAULT NULL COMMENT 'source ip'<span class="token punctuation">,</span>
  `app_name` VARCHAR(128) DEFAULT NULL<span class="token punctuation">,</span>
  `tenant_id` VARCHAR(128) DEFAULT '' COMMENT 'ÁßüÊà∑Â≠óÊÆµ'<span class="token punctuation">,</span>
  `c_desc` VARCHAR(256) DEFAULT NULL<span class="token punctuation">,</span>
  `c_use` VARCHAR(64) DEFAULT NULL<span class="token punctuation">,</span>
  `effect` VARCHAR(64) DEFAULT NULL<span class="token punctuation">,</span>
  `type` VARCHAR(64) DEFAULT NULL<span class="token punctuation">,</span>
  `c_schema` TEXT<span class="token punctuation">,</span>
  PRIMARY KEY (`id`)<span class="token punctuation">,</span>
  UNIQUE KEY `uk_configinfo_datagrouptenant` (`data_id`<span class="token punctuation">,</span>`group_id`<span class="token punctuation">,</span>`tenant_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info';
 
/<span class="token important">******************************************/</span>
/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   <span class="token important">*/</span>
/*   Ë°®ÂêçÁß∞ = config_info_aggr   <span class="token important">*/</span>
/<span class="token important">******************************************/</span>
CREATE TABLE `config_info_aggr` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT 'id'<span class="token punctuation">,</span>
  `data_id` VARCHAR(255) NOT NULL COMMENT 'data_id'<span class="token punctuation">,</span>
  `group_id` VARCHAR(255) NOT NULL COMMENT 'group_id'<span class="token punctuation">,</span>
  `datum_id` VARCHAR(255) NOT NULL COMMENT 'datum_id'<span class="token punctuation">,</span>
  `content` LONGTEXT NOT NULL COMMENT 'ÂÜÖÂÆπ'<span class="token punctuation">,</span>
  `gmt_modified` DATETIME NOT NULL COMMENT '‰øÆÊîπÊó∂Èó¥'<span class="token punctuation">,</span>
  `app_name` VARCHAR(128) DEFAULT NULL<span class="token punctuation">,</span>
  `tenant_id` VARCHAR(128) DEFAULT '' COMMENT 'ÁßüÊà∑Â≠óÊÆµ'<span class="token punctuation">,</span>
  PRIMARY KEY (`id`)<span class="token punctuation">,</span>
  UNIQUE KEY `uk_configinfoaggr_datagrouptenantdatum` (`data_id`<span class="token punctuation">,</span>`group_id`<span class="token punctuation">,</span>`tenant_id`<span class="token punctuation">,</span>`datum_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Â¢ûÂä†ÁßüÊà∑Â≠óÊÆµ';
 
 
/<span class="token important">******************************************/</span>
/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   <span class="token important">*/</span>
/*   Ë°®ÂêçÁß∞ = config_info_beta   <span class="token important">*/</span>
/<span class="token important">******************************************/</span>
CREATE TABLE `config_info_beta` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT 'id'<span class="token punctuation">,</span>
  `data_id` VARCHAR(255) NOT NULL COMMENT 'data_id'<span class="token punctuation">,</span>
  `group_id` VARCHAR(128) NOT NULL COMMENT 'group_id'<span class="token punctuation">,</span>
  `app_name` VARCHAR(128) DEFAULT NULL COMMENT 'app_name'<span class="token punctuation">,</span>
  `content` LONGTEXT NOT NULL COMMENT 'content'<span class="token punctuation">,</span>
  `beta_ips` VARCHAR(1024) DEFAULT NULL COMMENT 'betaIps'<span class="token punctuation">,</span>
  `md5` VARCHAR(32) DEFAULT NULL COMMENT 'md5'<span class="token punctuation">,</span>
  `gmt_create` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT 'ÂàõÂª∫Êó∂Èó¥'<span class="token punctuation">,</span>
  `gmt_modified` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT '‰øÆÊîπÊó∂Èó¥'<span class="token punctuation">,</span>
  `src_user` TEXT COMMENT 'source user'<span class="token punctuation">,</span>
  `src_ip` VARCHAR(20) DEFAULT NULL COMMENT 'source ip'<span class="token punctuation">,</span>
  `tenant_id` VARCHAR(128) DEFAULT '' COMMENT 'ÁßüÊà∑Â≠óÊÆµ'<span class="token punctuation">,</span>
  PRIMARY KEY (`id`)<span class="token punctuation">,</span>
  UNIQUE KEY `uk_configinfobeta_datagrouptenant` (`data_id`<span class="token punctuation">,</span>`group_id`<span class="token punctuation">,</span>`tenant_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info_beta';
 
/<span class="token important">******************************************/</span>
/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   <span class="token important">*/</span>
/*   Ë°®ÂêçÁß∞ = config_info_tag   <span class="token important">*/</span>
/<span class="token important">******************************************/</span>
CREATE TABLE `config_info_tag` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT 'id'<span class="token punctuation">,</span>
  `data_id` VARCHAR(255) NOT NULL COMMENT 'data_id'<span class="token punctuation">,</span>
  `group_id` VARCHAR(128) NOT NULL COMMENT 'group_id'<span class="token punctuation">,</span>
  `tenant_id` VARCHAR(128) DEFAULT '' COMMENT 'tenant_id'<span class="token punctuation">,</span>
  `tag_id` VARCHAR(128) NOT NULL COMMENT 'tag_id'<span class="token punctuation">,</span>
  `app_name` VARCHAR(128) DEFAULT NULL COMMENT 'app_name'<span class="token punctuation">,</span>
  `content` LONGTEXT NOT NULL COMMENT 'content'<span class="token punctuation">,</span>
  `md5` VARCHAR(32) DEFAULT NULL COMMENT 'md5'<span class="token punctuation">,</span>
  `gmt_create` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT 'ÂàõÂª∫Êó∂Èó¥'<span class="token punctuation">,</span>
  `gmt_modified` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT '‰øÆÊîπÊó∂Èó¥'<span class="token punctuation">,</span>
  `src_user` TEXT COMMENT 'source user'<span class="token punctuation">,</span>
  `src_ip` VARCHAR(20) DEFAULT NULL COMMENT 'source ip'<span class="token punctuation">,</span>
  PRIMARY KEY (`id`)<span class="token punctuation">,</span>
  UNIQUE KEY `uk_configinfotag_datagrouptenanttag` (`data_id`<span class="token punctuation">,</span>`group_id`<span class="token punctuation">,</span>`tenant_id`<span class="token punctuation">,</span>`tag_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_info_tag';
 
/<span class="token important">******************************************/</span>
/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   <span class="token important">*/</span>
/*   Ë°®ÂêçÁß∞ = config_tags_relation   <span class="token important">*/</span>
/<span class="token important">******************************************/</span>
CREATE TABLE `config_tags_relation` (
  `id` BIGINT(20) NOT NULL COMMENT 'id'<span class="token punctuation">,</span>
  `tag_name` VARCHAR(128) NOT NULL COMMENT 'tag_name'<span class="token punctuation">,</span>
  `tag_type` VARCHAR(64) DEFAULT NULL COMMENT 'tag_type'<span class="token punctuation">,</span>
  `data_id` VARCHAR(255) NOT NULL COMMENT 'data_id'<span class="token punctuation">,</span>
  `group_id` VARCHAR(128) NOT NULL COMMENT 'group_id'<span class="token punctuation">,</span>
  `tenant_id` VARCHAR(128) DEFAULT '' COMMENT 'tenant_id'<span class="token punctuation">,</span>
  `nid` BIGINT(20) NOT NULL AUTO_INCREMENT<span class="token punctuation">,</span>
  PRIMARY KEY (`nid`)<span class="token punctuation">,</span>
  UNIQUE KEY `uk_configtagrelation_configidtag` (`id`<span class="token punctuation">,</span>`tag_name`<span class="token punctuation">,</span>`tag_type`)<span class="token punctuation">,</span>
  KEY `idx_tenant_id` (`tenant_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='config_tag_relation';
 
/<span class="token important">******************************************/</span>
/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   <span class="token important">*/</span>
/*   Ë°®ÂêçÁß∞ = group_capacity   <span class="token important">*/</span>
/<span class="token important">******************************************/</span>
CREATE TABLE `group_capacity` (
  `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '‰∏ªÈîÆID'<span class="token punctuation">,</span>
  `group_id` VARCHAR(128) NOT NULL DEFAULT '' COMMENT 'Group IDÔºåÁ©∫Â≠óÁ¨¶Ë°®Á§∫Êï¥‰∏™ÈõÜÁæ§'<span class="token punctuation">,</span>
  `quota` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'ÈÖçÈ¢ùÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'<span class="token punctuation">,</span>
  `usage` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT '‰ΩøÁî®Èáè'<span class="token punctuation">,</span>
  `max_size` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'Âçï‰∏™ÈÖçÁΩÆÂ§ßÂ∞è‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Â≠óËäÇÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'<span class="token punctuation">,</span>
  `max_aggr_count` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'ËÅöÂêàÂ≠êÈÖçÁΩÆÊúÄÂ§ß‰∏™Êï∞ÔºåÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'<span class="token punctuation">,</span>
  `max_aggr_size` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'Âçï‰∏™ËÅöÂêàÊï∞ÊçÆÁöÑÂ≠êÈÖçÁΩÆÂ§ßÂ∞è‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Â≠óËäÇÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'<span class="token punctuation">,</span>
  `max_history_count` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'ÊúÄÂ§ßÂèòÊõ¥ÂéÜÂè≤Êï∞Èáè'<span class="token punctuation">,</span>
  `gmt_create` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT 'ÂàõÂª∫Êó∂Èó¥'<span class="token punctuation">,</span>
  `gmt_modified` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT '‰øÆÊîπÊó∂Èó¥'<span class="token punctuation">,</span>
  PRIMARY KEY (`id`)<span class="token punctuation">,</span>
  UNIQUE KEY `uk_group_id` (`group_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='ÈõÜÁæ§„ÄÅÂêÑGroupÂÆπÈáè‰ø°ÊÅØË°®';
 
/<span class="token important">******************************************/</span>
/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   <span class="token important">*/</span>
/*   Ë°®ÂêçÁß∞ = his_config_info   <span class="token important">*/</span>
/<span class="token important">******************************************/</span>
CREATE TABLE `his_config_info` (
  `id` BIGINT(64) UNSIGNED NOT NULL<span class="token punctuation">,</span>
  `nid` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT<span class="token punctuation">,</span>
  `data_id` VARCHAR(255) NOT NULL<span class="token punctuation">,</span>
  `group_id` VARCHAR(128) NOT NULL<span class="token punctuation">,</span>
  `app_name` VARCHAR(128) DEFAULT NULL COMMENT 'app_name'<span class="token punctuation">,</span>
  `content` LONGTEXT NOT NULL<span class="token punctuation">,</span>
  `md5` VARCHAR(32) DEFAULT NULL<span class="token punctuation">,</span>
  `gmt_create` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00'<span class="token punctuation">,</span>
  `gmt_modified` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00'<span class="token punctuation">,</span>
  `src_user` TEXT<span class="token punctuation">,</span>
  `src_ip` VARCHAR(20) DEFAULT NULL<span class="token punctuation">,</span>
  `op_type` CHAR(10) DEFAULT NULL<span class="token punctuation">,</span>
  `tenant_id` VARCHAR(128) DEFAULT '' COMMENT 'ÁßüÊà∑Â≠óÊÆµ'<span class="token punctuation">,</span>
  PRIMARY KEY (`nid`)<span class="token punctuation">,</span>
  KEY `idx_gmt_create` (`gmt_create`)<span class="token punctuation">,</span>
  KEY `idx_gmt_modified` (`gmt_modified`)<span class="token punctuation">,</span>
  KEY `idx_did` (`data_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='Â§öÁßüÊà∑ÊîπÈÄ†';
 
 
/<span class="token important">******************************************/</span>
/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   <span class="token important">*/</span>
/*   Ë°®ÂêçÁß∞ = tenant_capacity   <span class="token important">*/</span>
/<span class="token important">******************************************/</span>
CREATE TABLE `tenant_capacity` (
  `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '‰∏ªÈîÆID'<span class="token punctuation">,</span>
  `tenant_id` VARCHAR(128) NOT NULL DEFAULT '' COMMENT 'Tenant ID'<span class="token punctuation">,</span>
  `quota` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'ÈÖçÈ¢ùÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'<span class="token punctuation">,</span>
  `usage` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT '‰ΩøÁî®Èáè'<span class="token punctuation">,</span>
  `max_size` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'Âçï‰∏™ÈÖçÁΩÆÂ§ßÂ∞è‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Â≠óËäÇÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'<span class="token punctuation">,</span>
  `max_aggr_count` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'ËÅöÂêàÂ≠êÈÖçÁΩÆÊúÄÂ§ß‰∏™Êï∞'<span class="token punctuation">,</span>
  `max_aggr_size` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'Âçï‰∏™ËÅöÂêàÊï∞ÊçÆÁöÑÂ≠êÈÖçÁΩÆÂ§ßÂ∞è‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Â≠óËäÇÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'<span class="token punctuation">,</span>
  `max_history_count` INT(10) UNSIGNED NOT NULL DEFAULT '0' COMMENT 'ÊúÄÂ§ßÂèòÊõ¥ÂéÜÂè≤Êï∞Èáè'<span class="token punctuation">,</span>
  `gmt_create` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT 'ÂàõÂª∫Êó∂Èó¥'<span class="token punctuation">,</span>
  `gmt_modified` DATETIME NOT NULL DEFAULT '2010<span class="token punctuation">-</span>05<span class="token punctuation">-</span>05 00<span class="token punctuation">:</span>00<span class="token punctuation">:</span>00' COMMENT '‰øÆÊîπÊó∂Èó¥'<span class="token punctuation">,</span>
  PRIMARY KEY (`id`)<span class="token punctuation">,</span>
  UNIQUE KEY `uk_tenant_id` (`tenant_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='ÁßüÊà∑ÂÆπÈáè‰ø°ÊÅØË°®';
 
 
CREATE TABLE `tenant_info` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT 'id'<span class="token punctuation">,</span>
  `kp` VARCHAR(128) NOT NULL COMMENT 'kp'<span class="token punctuation">,</span>
  `tenant_id` VARCHAR(128) DEFAULT '' COMMENT 'tenant_id'<span class="token punctuation">,</span>
  `tenant_name` VARCHAR(128) DEFAULT '' COMMENT 'tenant_name'<span class="token punctuation">,</span>
  `tenant_desc` VARCHAR(256) DEFAULT NULL COMMENT 'tenant_desc'<span class="token punctuation">,</span>
  `create_source` VARCHAR(32) DEFAULT NULL COMMENT 'create_source'<span class="token punctuation">,</span>
  `gmt_create` BIGINT(20) NOT NULL COMMENT 'ÂàõÂª∫Êó∂Èó¥'<span class="token punctuation">,</span>
  `gmt_modified` BIGINT(20) NOT NULL COMMENT '‰øÆÊîπÊó∂Èó¥'<span class="token punctuation">,</span>
  PRIMARY KEY (`id`)<span class="token punctuation">,</span>
  UNIQUE KEY `uk_tenant_info_kptenantid` (`kp`<span class="token punctuation">,</span>`tenant_id`)<span class="token punctuation">,</span>
  KEY `idx_tenant_id` (`tenant_id`)
) ENGINE=INNODB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT='tenant_info';
 
CREATE TABLE users (
    username VARCHAR(50) NOT NULL PRIMARY KEY<span class="token punctuation">,</span>
    PASSWORD VARCHAR(500) NOT NULL<span class="token punctuation">,</span>
    enabled BOOLEAN NOT NULL
);
 
CREATE TABLE roles (
    username VARCHAR(50) NOT NULL<span class="token punctuation">,</span>
    role VARCHAR(50) NOT NULL
);
 
INSERT INTO users (username<span class="token punctuation">,</span> PASSWORD<span class="token punctuation">,</span> enabled) VALUES ('nacos'<span class="token punctuation">,</span> <span class="token string">'$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu'</span><span class="token punctuation">,</span> TRUE);
 
INSERT INTO roles (username<span class="token punctuation">,</span> role) VALUES ('nacos'<span class="token punctuation">,</span> 'ROLE_ADMIN');
 
 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>nacos-server-</p>
<p>1.1.4\nacos\confÁõÆÂΩï‰∏ãÊâæÂà∞application.properties</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">spring.datasource.platform</span><span class="token punctuation">=</span><span class="token attr-value">mysql</span>
 
<span class="token attr-name">db.num</span><span class="token punctuation">=</span><span class="token attr-value">1</span>
<span class="token attr-name">db.url.0</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true</span>
<span class="token attr-name">db.user</span><span class="token punctuation">=</span><span class="token attr-value">root</span>
<span class="token attr-name">db.password</span><span class="token punctuation">=</span><span class="token attr-value">123456</span>
 
<span class="token attr-name">spring.datasource.platform</span><span class="token punctuation">=</span><span class="token attr-value">mysql</span>
 
<span class="token attr-name">db.num</span><span class="token punctuation">=</span><span class="token attr-value">1</span>
<span class="token attr-name">db.url.0</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true</span>
<span class="token attr-name">db.user</span><span class="token punctuation">=</span><span class="token attr-value">root</span>
<span class="token attr-name">db.password</span><span class="token punctuation">=</span><span class="token attr-value">123456</span>
 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</blockquote>
<p>ÂêØÂä®NacosÔºåÂèØ‰ª•ÁúãÂà∞ÊòØ‰∏™ÂÖ®Êñ∞ÁöÑÁ©∫ËÆ∞ÂΩïÁïåÈù¢Ôºå‰ª•ÂâçÊòØËÆ∞ÂΩïËøõderby</p>
<h2 id="LinuxÁâàNacos-MySQLÁîü‰∫ßÁéØÂ¢ÉÈÖçÁΩÆ"><a href="#LinuxÁâàNacos-MySQLÁîü‰∫ßÁéØÂ¢ÉÈÖçÁΩÆ" class="headerlink" title="LinuxÁâàNacos+MySQLÁîü‰∫ßÁéØÂ¢ÉÈÖçÁΩÆ"></a>LinuxÁâàNacos+MySQLÁîü‰∫ßÁéØÂ¢ÉÈÖçÁΩÆ</h2><h3 id="È¢ÑËÆ°ÈúÄË¶ÅÔºå1‰∏™Nginx-3‰∏™nacosÊ≥®ÂÜå‰∏≠ÂøÉ-1‰∏™mysql"><a href="#È¢ÑËÆ°ÈúÄË¶ÅÔºå1‰∏™Nginx-3‰∏™nacosÊ≥®ÂÜå‰∏≠ÂøÉ-1‰∏™mysql" class="headerlink" title="È¢ÑËÆ°ÈúÄË¶ÅÔºå1‰∏™Nginx+3‰∏™nacosÊ≥®ÂÜå‰∏≠ÂøÉ+1‰∏™mysql"></a>È¢ÑËÆ°ÈúÄË¶ÅÔºå1‰∏™Nginx+3‰∏™nacosÊ≥®ÂÜå‰∏≠ÂøÉ+1‰∏™mysql</h3><h3 id="Nacos‰∏ãËΩΩLinuxÁâà"><a href="#Nacos‰∏ãËΩΩLinuxÁâà" class="headerlink" title="Nacos‰∏ãËΩΩLinuxÁâà"></a>Nacos‰∏ãËΩΩLinuxÁâà</h3><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali41.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali41.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/nacos/releases/tag/1.1.4">https://github.com/alibaba/nacos/releases/tag/1.1.4</a><br>nacos-server-1.1.4.tar.gz</p>
<p>wget -t 0 -c <a target="_blank" rel="noopener" href="https://github.com/alibaba/nacos/releases/download/1.1.4/nacos-server-1.1.4.tar.gz">https://github.com/alibaba/nacos/releases/download/1.1.4/nacos-server-1.1.4.tar.gz</a></p>
<blockquote>
<p><strong>Â¶ÇÊûú‰Ω†ÊÉ≥‰ªéÁΩëÁ´ô‰∏ä‰∏ãËΩΩ‰∏Ä‰∏™Êñá‰ª∂Ôºö</strong></p>
<pre class="line-numbers language-none"><code class="language-none">wget https:&#x2F;&#x2F;www.wangchao.info&#x2F;bak.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>Â¶ÇÊûú‰∏ãËΩΩ‰∏ÄÂçä‰∏≠Êñ≠‰∫ÜË¶ÅÁªßÁª≠‰∏ãËΩΩÔºö</strong></p>
<pre class="line-numbers language-none"><code class="language-none">wget -c  https:&#x2F;&#x2F;www.wangchao.info&#x2F;bak.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>Ëøô‰∏™ÂëΩ‰ª§Â∞±‰ºöÁª≠‰º†‰πãÂâçÁöÑÊñá‰ª∂‰∫Ü</p>
<p><strong>Â¶ÇÊûúÁΩëÈÄüÂæàÊÖ¢, ÊÄªÊñ≠ÂºÄÈáçÊñ∞ÈìæÊé•, ÊÉ≥ËÆ©ÂÆÉËá™Âä®ÈáçËØïÁõ¥Âà∞‰∏ãËΩΩÂÆåÊàêÊñπÊ≥ïÔºö</strong></p>
<pre class="line-numbers language-none"><code class="language-none">wget -t 0 -c https:&#x2F;&#x2F;www.wangchao.info&#x2F;bak.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ÈªòËÆ§‰ºöÈáçËØï20Ê¨°, -t 0 ‰ºöËÆ©‰ªñ‰∏ÄÁõ¥ÈáçËØïÔºåÁõ¥Âà∞ÊääÊàëÁöÑÊñá‰ª∂‰∏ãËΩΩÂÆåÊàê„ÄÇ</p>
</blockquote>
<p>Ëß£ÂéãÂêéÂÆâË£Ö</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali42.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali42.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="ÈõÜÁæ§ÈÖçÁΩÆÊ≠•È™§-ÈáçÁÇπ"><a href="#ÈõÜÁæ§ÈÖçÁΩÆÊ≠•È™§-ÈáçÁÇπ" class="headerlink" title="ÈõÜÁæ§ÈÖçÁΩÆÊ≠•È™§(ÈáçÁÇπ)"></a>ÈõÜÁæ§ÈÖçÁΩÆÊ≠•È™§(ÈáçÁÇπ)</h3><h4 id="1„ÄÅLinuxÊúçÂä°Âô®‰∏ämysqlÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ"><a href="#1„ÄÅLinuxÊúçÂä°Âô®‰∏ämysqlÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ" class="headerlink" title="1„ÄÅLinuxÊúçÂä°Âô®‰∏ämysqlÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ"></a>1„ÄÅLinuxÊúçÂä°Âô®‰∏ämysqlÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ</h4><blockquote>
<p>SQLËÑöÊú¨Âú®Âì™Èáå</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali43.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali43.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>sqlËØ≠Âè•Ê∫êÊñá‰ª∂  nacos-mysql.sql</strong></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">/******************************************/</span>
<span class="token comment">/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   */</span>
<span class="token comment">/*   Ë°®ÂêçÁß∞ = config_info   */</span>
<span class="token comment">/******************************************/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>config_info<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'data_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>content<span class="token punctuation">`</span></span> <span class="token keyword">longtext</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'content'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>md5<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'md5'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÂàõÂª∫Êó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰øÆÊîπÊó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>src_user<span class="token punctuation">`</span></span> <span class="token keyword">text</span> <span class="token keyword">COMMENT</span> <span class="token string">'source user'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>src_ip<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'source ip'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>app_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÁßüÊà∑Â≠óÊÆµ'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>c_desc<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>c_use<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>effect<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>type<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>c_schema<span class="token punctuation">`</span></span> <span class="token keyword">text</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uk_configinfo_datagrouptenant<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'config_info'</span><span class="token punctuation">;</span>

<span class="token comment">/******************************************/</span>
<span class="token comment">/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   */</span>
<span class="token comment">/*   Ë°®ÂêçÁß∞ = config_info_aggr   */</span>
<span class="token comment">/******************************************/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>config_info_aggr<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'data_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'group_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>datum_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'datum_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>content<span class="token punctuation">`</span></span> <span class="token keyword">longtext</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÂÜÖÂÆπ'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰øÆÊîπÊó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>app_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÁßüÊà∑Â≠óÊÆµ'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uk_configinfoaggr_datagrouptenantdatum<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>datum_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'Â¢ûÂä†ÁßüÊà∑Â≠óÊÆµ'</span><span class="token punctuation">;</span>


<span class="token comment">/******************************************/</span>
<span class="token comment">/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   */</span>
<span class="token comment">/*   Ë°®ÂêçÁß∞ = config_info_beta   */</span>
<span class="token comment">/******************************************/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>config_info_beta<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'data_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'group_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>app_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'app_name'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>content<span class="token punctuation">`</span></span> <span class="token keyword">longtext</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'content'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>beta_ips<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'betaIps'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>md5<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'md5'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÂàõÂª∫Êó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰øÆÊîπÊó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>src_user<span class="token punctuation">`</span></span> <span class="token keyword">text</span> <span class="token keyword">COMMENT</span> <span class="token string">'source user'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>src_ip<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'source ip'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÁßüÊà∑Â≠óÊÆµ'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uk_configinfobeta_datagrouptenant<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'config_info_beta'</span><span class="token punctuation">;</span>

<span class="token comment">/******************************************/</span>
<span class="token comment">/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   */</span>
<span class="token comment">/*   Ë°®ÂêçÁß∞ = config_info_tag   */</span>
<span class="token comment">/******************************************/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>config_info_tag<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'data_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'group_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'tenant_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tag_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'tag_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>app_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'app_name'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>content<span class="token punctuation">`</span></span> <span class="token keyword">longtext</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'content'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>md5<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'md5'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÂàõÂª∫Êó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰øÆÊîπÊó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>src_user<span class="token punctuation">`</span></span> <span class="token keyword">text</span> <span class="token keyword">COMMENT</span> <span class="token string">'source user'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>src_ip<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'source ip'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uk_configinfotag_datagrouptenanttag<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>tag_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'config_info_tag'</span><span class="token punctuation">;</span>

<span class="token comment">/******************************************/</span>
<span class="token comment">/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   */</span>
<span class="token comment">/*   Ë°®ÂêçÁß∞ = config_tags_relation   */</span>
<span class="token comment">/******************************************/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>config_tags_relation<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tag_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'tag_name'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tag_type<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'tag_type'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'data_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'group_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'tenant_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>nid<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>nid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uk_configtagrelation_configidtag<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>tag_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>tag_type<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_tenant_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'config_tag_relation'</span><span class="token punctuation">;</span>

<span class="token comment">/******************************************/</span>
<span class="token comment">/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   */</span>
<span class="token comment">/*   Ë°®ÂêçÁß∞ = group_capacity   */</span>
<span class="token comment">/******************************************/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>group_capacity<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰∏ªÈîÆID'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'Group IDÔºåÁ©∫Â≠óÁ¨¶Ë°®Á§∫Êï¥‰∏™ÈõÜÁæ§'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>quota<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÈÖçÈ¢ùÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>usage<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰ΩøÁî®Èáè'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>max_size<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'Âçï‰∏™ÈÖçÁΩÆÂ§ßÂ∞è‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Â≠óËäÇÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>max_aggr_count<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ËÅöÂêàÂ≠êÈÖçÁΩÆÊúÄÂ§ß‰∏™Êï∞ÔºåÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>max_aggr_size<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'Âçï‰∏™ËÅöÂêàÊï∞ÊçÆÁöÑÂ≠êÈÖçÁΩÆÂ§ßÂ∞è‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Â≠óËäÇÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>max_history_count<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÊúÄÂ§ßÂèòÊõ¥ÂéÜÂè≤Êï∞Èáè'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÂàõÂª∫Êó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰øÆÊîπÊó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uk_group_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'ÈõÜÁæ§„ÄÅÂêÑGroupÂÆπÈáè‰ø°ÊÅØË°®'</span><span class="token punctuation">;</span>

<span class="token comment">/******************************************/</span>
<span class="token comment">/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   */</span>
<span class="token comment">/*   Ë°®ÂêçÁß∞ = his_config_info   */</span>
<span class="token comment">/******************************************/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>his_config_info<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>nid<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>group_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>app_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'app_name'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>content<span class="token punctuation">`</span></span> <span class="token keyword">longtext</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>md5<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>src_user<span class="token punctuation">`</span></span> <span class="token keyword">text</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>src_ip<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>op_type<span class="token punctuation">`</span></span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÁßüÊà∑Â≠óÊÆµ'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>nid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_gmt_create<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_gmt_modified<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_did<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>data_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'Â§öÁßüÊà∑ÊîπÈÄ†'</span><span class="token punctuation">;</span>


<span class="token comment">/******************************************/</span>
<span class="token comment">/*   Êï∞ÊçÆÂ∫ìÂÖ®Âêç = nacos_config   */</span>
<span class="token comment">/*   Ë°®ÂêçÁß∞ = tenant_capacity   */</span>
<span class="token comment">/******************************************/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>tenant_capacity<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰∏ªÈîÆID'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'Tenant ID'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>quota<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÈÖçÈ¢ùÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>usage<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰ΩøÁî®Èáè'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>max_size<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'Âçï‰∏™ÈÖçÁΩÆÂ§ßÂ∞è‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Â≠óËäÇÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>max_aggr_count<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ËÅöÂêàÂ≠êÈÖçÁΩÆÊúÄÂ§ß‰∏™Êï∞'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>max_aggr_size<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'Âçï‰∏™ËÅöÂêàÊï∞ÊçÆÁöÑÂ≠êÈÖçÁΩÆÂ§ßÂ∞è‰∏äÈôêÔºåÂçï‰Ωç‰∏∫Â≠óËäÇÔºå0Ë°®Á§∫‰ΩøÁî®ÈªòËÆ§ÂÄº'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>max_history_count<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÊúÄÂ§ßÂèòÊõ¥ÂéÜÂè≤Êï∞Èáè'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÂàõÂª∫Êó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2010-05-05 00:00:00'</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰øÆÊîπÊó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uk_tenant_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'ÁßüÊà∑ÂÆπÈáè‰ø°ÊÅØË°®'</span><span class="token punctuation">;</span>


<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>tenant_info<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>kp<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'kp'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'tenant_id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'tenant_name'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>tenant_desc<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'tenant_desc'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>create_source<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'create_source'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÂàõÂª∫Êó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰øÆÊîπÊó∂Èó¥'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uk_tenant_info_kptenantid<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>kp<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_tenant_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>tenant_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'tenant_info'</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users <span class="token punctuation">(</span>
	username <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
	password <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	enabled <span class="token keyword">boolean</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> roles <span class="token punctuation">(</span>
	username <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	role <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> users <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> enabled<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'nacos'</span><span class="token punctuation">,</span> <span class="token string">'$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu'</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> roles <span class="token punctuation">(</span>username<span class="token punctuation">,</span> role<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'nacos'</span><span class="token punctuation">,</span> <span class="token string">'ROLE_ADMIN'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Ëá™Â∑±LinuxÊú∫Âô®‰∏äÁöÑMysqlÊï∞ÊçÆÂ∫ìÁ≤òË¥¥</p>
<p>ÊâßË°åÂêéÁªìÊûú<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali44.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali44.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h4 id="2„ÄÅapplication-properties-ÈÖçÁΩÆ"><a href="#2„ÄÅapplication-properties-ÈÖçÁΩÆ" class="headerlink" title="2„ÄÅapplication.properties ÈÖçÁΩÆ"></a>2„ÄÅapplication.properties ÈÖçÁΩÆ</h4><p>application.properties ÈÖçÁΩÆ</p>
<h4 id="‰ΩçÁΩÆ"><a href="#‰ΩçÁΩÆ" class="headerlink" title="‰ΩçÁΩÆ"></a>‰ΩçÁΩÆ</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali45.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali45.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali46.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali46.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÂÜÖÂÆπ"><a href="#ÂÜÖÂÆπ" class="headerlink" title="ÂÜÖÂÆπ"></a>ÂÜÖÂÆπ</h4><p><code>application.properties </code>Êñá‰ª∂ÊâìÂºÄÂêéÁöÑÊúÄÂêéÈù¢ÔºåÈÖçÁΩÆÂ¶Ç‰∏ãÂÜÖÂÆπÔºö</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">spring.datasource.platform=mysql
 
db.num=1
db.url.0=jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/nacos_config<span class="token punctuation">?</span>characterEncoding=utf8<span class="token important">&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true</span>
db.user=root
db.password=qwer123456.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali47.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali47.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="3„ÄÅLinuxÊúçÂä°Âô®‰∏änacosÁöÑÈõÜÁæ§ÈÖçÁΩÆcluster-conf"><a href="#3„ÄÅLinuxÊúçÂä°Âô®‰∏änacosÁöÑÈõÜÁæ§ÈÖçÁΩÆcluster-conf" class="headerlink" title="3„ÄÅLinuxÊúçÂä°Âô®‰∏änacosÁöÑÈõÜÁæ§ÈÖçÁΩÆcluster.conf"></a>3„ÄÅLinuxÊúçÂä°Âô®‰∏änacosÁöÑÈõÜÁæ§ÈÖçÁΩÆcluster.conf</h4><h4 id="Ê¢≥ÁêÜÂá∫3Âè∞nacosÈõÜÂô®ÁöÑ‰∏çÂêåÊúçÂä°Á´ØÂè£Âè∑"><a href="#Ê¢≥ÁêÜÂá∫3Âè∞nacosÈõÜÂô®ÁöÑ‰∏çÂêåÊúçÂä°Á´ØÂè£Âè∑" class="headerlink" title="Ê¢≥ÁêÜÂá∫3Âè∞nacosÈõÜÂô®ÁöÑ‰∏çÂêåÊúçÂä°Á´ØÂè£Âè∑"></a>Ê¢≥ÁêÜÂá∫3Âè∞nacosÈõÜÂô®ÁöÑ‰∏çÂêåÊúçÂä°Á´ØÂè£Âè∑</h4><h4 id="Â§çÂà∂Âá∫cluster-conf"><a href="#Â§çÂà∂Âá∫cluster-conf" class="headerlink" title="Â§çÂà∂Âá∫cluster.conf"></a>Â§çÂà∂Âá∫cluster.conf</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali48.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali48.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali49.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali49.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali50.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali50.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÂÜÖÂÆπ-1"><a href="#ÂÜÖÂÆπ-1" class="headerlink" title="ÂÜÖÂÆπ"></a>ÂÜÖÂÆπ</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali51.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali51.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>Ëøô‰∏™IP‰∏çËÉΩÂÜô127.0.0.1ÔºåÂøÖÈ°ªÊòØ</strong><br><strong>LinuxÂëΩ‰ª§hostname -iËÉΩÂ§üËØÜÂà´ÁöÑIP</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali52.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali52.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<blockquote>
<p>Ëã•ÊòØ‰∏çÂ≠òÂú®  IP Âè™Êúâ 127.0.0.1ÂèØ‰ª•‰øÆÊîπÈÖçÁΩÆ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali53.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali53.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h4 id="4„ÄÅÁºñËæëNacosÁöÑÂêØÂä®ËÑöÊú¨startup-shÔºå‰ΩøÂÆÉËÉΩÂ§üÊé•Âèó‰∏çÂêåÁöÑÂêØÂä®Á´ØÂè£"><a href="#4„ÄÅÁºñËæëNacosÁöÑÂêØÂä®ËÑöÊú¨startup-shÔºå‰ΩøÂÆÉËÉΩÂ§üÊé•Âèó‰∏çÂêåÁöÑÂêØÂä®Á´ØÂè£" class="headerlink" title="4„ÄÅÁºñËæëNacosÁöÑÂêØÂä®ËÑöÊú¨startup.shÔºå‰ΩøÂÆÉËÉΩÂ§üÊé•Âèó‰∏çÂêåÁöÑÂêØÂä®Á´ØÂè£"></a>4„ÄÅÁºñËæëNacosÁöÑÂêØÂä®ËÑöÊú¨startup.shÔºå‰ΩøÂÆÉËÉΩÂ§üÊé•Âèó‰∏çÂêåÁöÑÂêØÂä®Á´ØÂè£</h4><p>&#x2F;mynacos&#x2F;nacos&#x2F;bin ÁõÆÂΩï‰∏ãÊúâstartup.sh</p>
<p>Âú®‰ªÄ‰πàÂú∞ÊñπÔºå‰øÆÊîπ‰ªÄ‰πàÔºåÊÄé‰πà‰øÆÊîπ</p>
<p>ÊÄùËÄÉ</p>
<blockquote>
<p><code>/mynacos/nacos/bin</code> ÁõÆÂΩï‰∏ãÊúâ<code>startup.sh</code></p>
<p>Âπ≥Êó∂ÂçïÊú∫ÁâàÁöÑÂêØÂä®ÔºåÈÉΩÊòØ<code>./startup.sh</code>Âç≥ÂèØ„ÄÇ</p>
<p><strong>‰ΩÜÊòØ</strong></p>
<p>ÈõÜÁæ§ÂêØÂä®ÔºåÊàë‰ª¨Â∏åÊúõÂèØ‰ª•Á±ª‰ººÂÖ∂ÂÆÉËΩØ‰ª∂ÁöÑshellÂëΩ‰ª§Ôºå<strong>‰º†ÈÄí‰∏çÂêåÁöÑÁ´ØÂè£Âè∑ÂêØÂä®‰∏çÂêåÁöÑnacosÂÆû‰æã</strong>„ÄÇ<br><strong>ÂëΩ‰ª§</strong>Ôºö<code>./startup.sh -p 3333</code> Ë°®Á§∫ÂêØÂä®Á´ØÂè£Âè∑‰∏∫3333ÁöÑnacosÊúçÂä°Âô®ÂÆû‰æãÔºåÂíå‰∏ä‰∏ÄÊ≠•ÁöÑcluster.confÈÖçÁΩÆÁöÑ‰∏ÄËá¥„ÄÇ</p>
</blockquote>
<p>‰øÆÊîπÂÜÖÂÆπ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali54.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali54.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali55.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali55.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÊâßË°åÊñπÂºè</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali56.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali56.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<blockquote>
<p>Ê≥®ÊÑè Â¶ÇÊûúÈÖçÁΩÆÊúâÈóÆÈ¢ò  nacos Êó†Ê≥ïÂêØÂä®  ÂêØÂä®ÊàêÂäü  logs ‰∏ã‰ºöÁîüÊàêÊñ∞ÁöÑÊó•ÂøóÂÜÖÂÆπ</p>
<p>Ëã•ÊòØÂÜÖÂ≠ò‰∏çÂ§ü </p>
<p>ÂÜÖÂ≠òÂ§ßÂ∞è‰πüËøõË°å‰∫Ü‰øÆÊîπ</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">if [[ &quot;$&#123;MODE&#125;&quot; &#x3D;&#x3D; &quot;standalone&quot; ]]; then
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -Xms512m -Xmx512m -Xmn256m&quot;
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -Dnacos.standalone&#x3D;true&quot;
else
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -server -Xms2g -Xmx2g -Xmn1g -XX:MetaspaceSize&#x3D;128m -XX:MaxMetaspaceSize&#x3D;320m&quot;
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -XX:-OmitStackTraceInFastThrow -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath&#x3D;$&#123;BASE_DIR&#125;&#x2F;logs&#x2F;java_heapdump.hprof&quot;
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -XX:-UseLargePages&quot;
   
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>‰øÆÊîπÂêé:</p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">if [[ &quot;$&#123;MODE&#125;&quot; &#x3D;&#x3D; &quot;standalone&quot; ]]; then
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -Xms512m -Xmx512m -Xmn256m&quot;
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -Dnacos.standalone&#x3D;true&quot;
else
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -server -Xms500m -Xmx500m -Xmn256m -XX:MetaspaceSize&#x3D;128m -XX:MaxMetaspaceSize&#x3D;320m&quot;
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -XX:-OmitStackTraceInFastThrow -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath&#x3D;$&#123;BASE_DIR&#125;&#x2F;logs&#x2F;java_heapdump.hprof&quot;
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -XX:-UseLargePages&quot;
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -Dserver.port&#x3D;$&#123;PORT&#125;&quot;
    JAVA_OPT&#x3D;&quot;$&#123;JAVA_OPT&#125; -Dnacos.server.ip&#x3D;192.168.44.135&quot;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ÂèÇËÄÉ <a target="_blank" rel="noopener" href="https://blog.csdn.net/wzwwzwwww/article/details/108421600">https://blog.csdn.net/wzwwzwwww/article/details/108421600</a></p>
</blockquote>
<h4 id="5„ÄÅNginxÁöÑÈÖçÁΩÆÔºåÁî±ÂÆÉ‰Ωú‰∏∫Ë¥üËΩΩÂùáË°°Âô®"><a href="#5„ÄÅNginxÁöÑÈÖçÁΩÆÔºåÁî±ÂÆÉ‰Ωú‰∏∫Ë¥üËΩΩÂùáË°°Âô®" class="headerlink" title="5„ÄÅNginxÁöÑÈÖçÁΩÆÔºåÁî±ÂÆÉ‰Ωú‰∏∫Ë¥üËΩΩÂùáË°°Âô®"></a>5„ÄÅNginxÁöÑÈÖçÁΩÆÔºåÁî±ÂÆÉ‰Ωú‰∏∫Ë¥üËΩΩÂùáË°°Âô®</h4><h5 id="‰øÆÊîπnginxÁöÑÈÖçÁΩÆÊñá‰ª∂"><a href="#‰øÆÊîπnginxÁöÑÈÖçÁΩÆÊñá‰ª∂" class="headerlink" title="‰øÆÊîπnginxÁöÑÈÖçÁΩÆÊñá‰ª∂"></a>‰øÆÊîπnginxÁöÑÈÖçÁΩÆÊñá‰ª∂</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali57.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali57.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h5 id="nginx-conf"><a href="#nginx-conf" class="headerlink" title="nginx.conf"></a>nginx.conf</h5><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali58.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali58.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">upstream cluster&#123;
        server 127.0.0.1:3333;
        server 127.0.0.1:4444;
        server 127.0.0.1:5555;
    &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">server &#123;
        listen       1111;
        server_name  localhost;
        #charset koi8-r;
        #access_log  logs&#x2F;host.access.log  main;
        location &#x2F; &#123;
            #root   html;
            #index  index.html index.htm;
            proxy_pass http:&#x2F;&#x2F;cluster;
        &#125;
.......ÁúÅÁï•
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</blockquote>
<h5 id="ÊåâÁÖßÊåáÂÆöÂêØÂä®"><a href="#ÊåâÁÖßÊåáÂÆöÂêØÂä®" class="headerlink" title="ÊåâÁÖßÊåáÂÆöÂêØÂä®"></a>ÊåâÁÖßÊåáÂÆöÂêØÂä®</h5><p>.&#x2F;startup.sh -p 3333</p>
<p>.&#x2F;startup.sh -p 4444</p>
<p>.&#x2F;startup.sh -p 5555</p>
<p>ps -ef | grep nacos |grep -v grep | wc -l   3</p>
<p>nginx ÂêØÂä®</p>
<p> .&#x2F;nginx -c &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.conf</p>
<p>6„ÄÅÊà™Ê≠¢Âà∞Ê≠§Â§ÑÔºå1‰∏™Nginx+3‰∏™nacosÊ≥®ÂÜå‰∏≠ÂøÉ+1‰∏™mysql</p>
<p>ÊµãËØïÈÄöËøánginxËÆøÈóÆnacos   <a target="_blank" rel="noopener" href="http://192.168.111.144:1111/nacos/#/login">http://192.168.111.144:1111/nacos/#/login</a></p>
<p>Êñ∞Âª∫‰∏Ä‰∏™ÈÖçÁΩÆÊµãËØï</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali59.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali59.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>linuxÊúçÂä°Âô®ÁöÑmysqlÊèíÂÖ•‰∏ÄÊù°ËÆ∞ÂΩï</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali60.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali60.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÊµãËØï</p>
<p>ÂæÆÊúçÂä°cloudalibaba-provider-payment9002ÂêØÂä®Ê≥®ÂÜåËøõnacosÈõÜÁæ§</p>
<p>yml</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token comment">#ÈÖçÁΩÆNacosÂú∞ÂùÄ</span>
        <span class="token comment">#server-addr: localhost:8848</span>
        <span class="token comment"># Êç¢ÊàênginxÁöÑ1111Á´ØÂè£ÔºåÂÅöÈõÜÁæ§</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 192.168.72.108<span class="token punctuation">:</span><span class="token number">80</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ÁªìÊûú</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali61.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali61.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>È´òÂèØÁî®Â∞èÊÄªÁªì</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali62.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali62.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h1 id="SpringCloud-Alibaba-SentinelÂÆûÁé∞ÁÜîÊñ≠‰∏éÈôêÊµÅ"><a href="#SpringCloud-Alibaba-SentinelÂÆûÁé∞ÁÜîÊñ≠‰∏éÈôêÊµÅ" class="headerlink" title="SpringCloud Alibaba SentinelÂÆûÁé∞ÁÜîÊñ≠‰∏éÈôêÊµÅ"></a>SpringCloud Alibaba SentinelÂÆûÁé∞ÁÜîÊñ≠‰∏éÈôêÊµÅ</h1><h2 id="Sentinel"><a href="#Sentinel" class="headerlink" title="Sentinel"></a>Sentinel</h2><h3 id="ÂÆòÁΩë-1"><a href="#ÂÆòÁΩë-1" class="headerlink" title="ÂÆòÁΩë"></a>ÂÆòÁΩë</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel">https://github.com/alibaba/Sentinel</a></p>
<p><strong>‰∏≠Êñá</strong> <a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel/wiki/%E4%BB%8B%E7%BB%8D">https://github.com/alibaba/Sentinel/wiki/%E4%BB%8B%E7%BB%8D</a></p>
</blockquote>
<h3 id="ÊòØ‰ªÄ‰πà-2"><a href="#ÊòØ‰ªÄ‰πà-2" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h3><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali63.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali63.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali64.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali64.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>‰∏ÄÂè•ËØùËß£ÈáäÔºå‰πãÂâçÊàë‰ª¨ËÆ≤Ëß£ËøáÁöÑHystrix</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali65.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali65.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="ÂéªÂì™‰∏ã-2"><a href="#ÂéªÂì™‰∏ã-2" class="headerlink" title="ÂéªÂì™‰∏ã"></a>ÂéªÂì™‰∏ã</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel/releases">https://github.com/alibaba/Sentinel/releases</a></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali66.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali66.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="ËÉΩÂπ≤Âòõ-2"><a href="#ËÉΩÂπ≤Âòõ-2" class="headerlink" title="ËÉΩÂπ≤Âòõ"></a>ËÉΩÂπ≤Âòõ</h3><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali67.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali67.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="ÊÄé‰πàÁé©-1"><a href="#ÊÄé‰πàÁé©-1" class="headerlink" title="ÊÄé‰πàÁé©"></a>ÊÄé‰πàÁé©</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_sentinel">https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_sentinel</a></p>
<p><strong>ÊúçÂä°‰ΩøÁî®‰∏≠ÁöÑÂêÑÁßçÈóÆÈ¢ò</strong></p>
<ul>
<li>ÊúçÂä°Èõ™Â¥©</li>
<li>ÊúçÂä°ÈôçÁ∫ß</li>
<li>ÊúçÂä°ÁÜîÊñ≠</li>
<li>ÊúçÂä°ÈôêÊµÅ</li>
</ul>
</blockquote>
<h2 id="ÂÆâË£ÖSentinelÊéßÂà∂Âè∞"><a href="#ÂÆâË£ÖSentinelÊéßÂà∂Âè∞" class="headerlink" title="ÂÆâË£ÖSentinelÊéßÂà∂Âè∞"></a>ÂÆâË£ÖSentinelÊéßÂà∂Âè∞</h2><h3 id="sentinelÁªÑ‰ª∂Áî±2ÈÉ®ÂàÜÊûÑÊàê"><a href="#sentinelÁªÑ‰ª∂Áî±2ÈÉ®ÂàÜÊûÑÊàê" class="headerlink" title="sentinelÁªÑ‰ª∂Áî±2ÈÉ®ÂàÜÊûÑÊàê"></a>sentinelÁªÑ‰ª∂Áî±2ÈÉ®ÂàÜÊûÑÊàê</h3><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali68.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali68.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>ÂêéÂè∞ ÂâçÂè∞8080</strong></p>
</blockquote>
<h3 id="ÂÆâË£ÖÊ≠•È™§"><a href="#ÂÆâË£ÖÊ≠•È™§" class="headerlink" title="ÂÆâË£ÖÊ≠•È™§"></a>ÂÆâË£ÖÊ≠•È™§</h3><h4 id="‰∏ãËΩΩ"><a href="#‰∏ãËΩΩ" class="headerlink" title="‰∏ãËΩΩ"></a>‰∏ãËΩΩ</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel/releases">https://github.com/alibaba/Sentinel/releases</a></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali69.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali69.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>‰∏ãËΩΩÂà∞Êú¨Âú∞sentinel-dashboard-1.7.0.jar</p>
</blockquote>
<h4 id="ËøêË°åÂëΩ‰ª§"><a href="#ËøêË°åÂëΩ‰ª§" class="headerlink" title="ËøêË°åÂëΩ‰ª§"></a>ËøêË°åÂëΩ‰ª§</h4><blockquote>
<p><strong>ÂâçÊèê</strong></p>
<p>java8ÁéØÂ¢ÉOK 8080Á´ØÂè£‰∏çËÉΩË¢´Âç†Áî®</p>
<p><strong>ÂëΩ‰ª§</strong></p>
<p>java -jar sentinel-dashboard-1.7.0.jar</p>
</blockquote>
<h4 id="ËÆøÈóÆsentinelÁÆ°ÁêÜÁïåÈù¢"><a href="#ËÆøÈóÆsentinelÁÆ°ÁêÜÁïåÈù¢" class="headerlink" title="ËÆøÈóÆsentinelÁÆ°ÁêÜÁïåÈù¢"></a>ËÆøÈóÆsentinelÁÆ°ÁêÜÁïåÈù¢</h4><blockquote>
<p><a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali70.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali70.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg">ÁôªÂΩïË¥¶Âè∑ÂØÜÁ†ÅÂùá‰∏∫sentinel</p>
</blockquote>
<h2 id="ÂàùÂßãÂåñÊºîÁ§∫Â∑•Á®ã"><a href="#ÂàùÂßãÂåñÊºîÁ§∫Â∑•Á®ã" class="headerlink" title="ÂàùÂßãÂåñÊºîÁ§∫Â∑•Á®ã"></a>ÂàùÂßãÂåñÊºîÁ§∫Â∑•Á®ã</h2><h3 id="ÂêØÂä®Nacos8848ÊàêÂäü"><a href="#ÂêØÂä®Nacos8848ÊàêÂäü" class="headerlink" title="ÂêØÂä®Nacos8848ÊàêÂäü"></a>ÂêØÂä®Nacos8848ÊàêÂäü</h3><blockquote>
<p><a target="_blank" rel="noopener" href="http://localhost:8848/nacos/#/login">http://localhost:8848/nacos/#/login</a></p>
</blockquote>
<h3 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h3><h4 id="Êñ∞Âª∫-cloudalibaba-sentinel-service8401"><a href="#Êñ∞Âª∫-cloudalibaba-sentinel-service8401" class="headerlink" title="Êñ∞Âª∫ cloudalibaba-sentinel-service8401"></a>Êñ∞Âª∫ cloudalibaba-sentinel-service8401</h4><h4 id="ÊîπPOM-3"><a href="#ÊîπPOM-3" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloudalibaba-sentinel-service8401<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba sentinel-datasource-nacos ÂêéÁª≠ÂÅöÊåÅ‰πÖÂåñÁî®Âà∞--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>sentinel-datasource-nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba sentinel --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--openfeign--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- SpringBootÊï¥ÂêàWebÁªÑ‰ª∂+actuator --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--Êó•Â∏∏ÈÄöÁî®jarÂåÖÈÖçÁΩÆ--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.6.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ÊîπYML-3"><a href="#ÊîπYML-3" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8401</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloudalibaba<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token comment">#NacosÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÂú∞ÂùÄ</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
        <span class="token comment">#ÈÖçÁΩÆSentinel dashboardÂú∞ÂùÄ</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span>
        <span class="token comment">#ÈªòËÆ§8719Á´ØÂè£ÔºåÂÅáÂ¶ÇË¢´Âç†Áî®‰ºöËá™Âä®‰ªé8719ÂºÄÂßã‰æùÊ¨°+1Êâ´Êèè,Áõ¥Ëá≥ÊâæÂà∞Êú™Ë¢´Âç†Áî®ÁöÑÁ´ØÂè£</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span>

<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">'*'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏ªÂêØÂä®-3"><a href="#‰∏ªÂêØÂä®-3" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h4><h5 id="MainApp8401"><a href="#MainApp8401" class="headerlink" title="MainApp8401"></a>MainApp8401</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainApp8401</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MainApp8401</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏öÂä°Á±ªFlowLimitController"><a href="#‰∏öÂä°Á±ªFlowLimitController" class="headerlink" title="‰∏öÂä°Á±ªFlowLimitController"></a>‰∏öÂä°Á±ªFlowLimitController</h4><h5 id="FlowLimitController"><a href="#FlowLimitController" class="headerlink" title="FlowLimitController"></a>FlowLimitController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowLimitController</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testA"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"------testA"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testB"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"------testB"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="ÂêØÂä®Sentinel8080"><a href="#ÂêØÂä®Sentinel8080" class="headerlink" title="ÂêØÂä®Sentinel8080"></a>ÂêØÂä®Sentinel8080</h3><blockquote>
<p>java -jar sentinel-dashboard-1.7.0.jar</p>
</blockquote>
<h3 id="ÂêØÂä®ÂæÆÊúçÂä°8401"><a href="#ÂêØÂä®ÂæÆÊúçÂä°8401" class="headerlink" title="ÂêØÂä®ÂæÆÊúçÂä°8401"></a>ÂêØÂä®ÂæÆÊúçÂä°8401</h3><h3 id="ÂêØÂä®8401ÂæÆÊúçÂä°ÂêéÊü•ÁúãsentienlÊéßÂà∂Âè∞"><a href="#ÂêØÂä®8401ÂæÆÊúçÂä°ÂêéÊü•ÁúãsentienlÊéßÂà∂Âè∞" class="headerlink" title="ÂêØÂä®8401ÂæÆÊúçÂä°ÂêéÊü•ÁúãsentienlÊéßÂà∂Âè∞"></a>ÂêØÂä®8401ÂæÆÊúçÂä°ÂêéÊü•ÁúãsentienlÊéßÂà∂Âè∞</h3><p>Á©∫Á©∫Â¶Ç‰πüÔºåÂï•ÈÉΩÊ≤°Êúâ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali71.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali71.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>SentinelÈááÁî®ÁöÑÊáíÂä†ËΩΩËØ¥Êòé</p>
<p>‚Äã	ÊâßË°å‰∏ÄÊ¨°ËÆøÈóÆÂç≥ÂèØ</p>
<p>‚Äã		<a target="_blank" rel="noopener" href="http://localhost:8401/testA">http://localhost:8401/testA</a> <a target="_blank" rel="noopener" href="http://localhost:8401/testB">http://localhost:8401/testB</a></p>
<p>‚Äã	ÊïàÊûú: </p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali72.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali72.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÁªìËÆ∫: sentinel8080Ê≠£Âú®ÁõëÊéßÂæÆÊúçÂä°8401</p>
<h2 id="ÊµÅÊéßËßÑÂàô"><a href="#ÊµÅÊéßËßÑÂàô" class="headerlink" title="ÊµÅÊéßËßÑÂàô"></a>ÊµÅÊéßËßÑÂàô</h2><h3 id="Âü∫Êú¨‰ªãÁªç"><a href="#Âü∫Êú¨‰ªãÁªç" class="headerlink" title="Âü∫Êú¨‰ªãÁªç"></a>Âü∫Êú¨‰ªãÁªç</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali73.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali73.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>Ëøõ‰∏ÄÊ≠•Ëß£ÈáäËØ¥Êòé</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali74.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali74.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="ÊµÅÊéßÊ®°Âºè"><a href="#ÊµÅÊéßÊ®°Âºè" class="headerlink" title="ÊµÅÊéßÊ®°Âºè"></a>ÊµÅÊéßÊ®°Âºè</h3><h4 id="Áõ¥Êé•-ÈªòËÆ§"><a href="#Áõ¥Êé•-ÈªòËÆ§" class="headerlink" title="Áõ¥Êé•(ÈªòËÆ§)"></a>Áõ¥Êé•(ÈªòËÆ§)</h4><p>Áõ¥Êé•-&gt;Âø´ÈÄüÂ§±Ë¥•  Á≥ªÁªüÈªòËÆ§</p>
<h5 id="ÈÖçÁΩÆÂèäËØ¥Êòé"><a href="#ÈÖçÁΩÆÂèäËØ¥Êòé" class="headerlink" title="ÈÖçÁΩÆÂèäËØ¥Êòé"></a>ÈÖçÁΩÆÂèäËØ¥Êòé</h5><blockquote>
<p><strong>Ë°®Á§∫1ÁßíÈíüÂÜÖÊü•ËØ¢1Ê¨°Â∞±ÊòØOKÔºåËã•Ë∂ÖËøáÊ¨°Êï∞1ÔºåÂ∞±Áõ¥Êé•-Âø´ÈÄüÂ§±Ë¥•ÔºåÊä•ÈªòËÆ§ÈîôËØØ</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali75.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali75.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h5 id="ÊµãËØï-3"><a href="#ÊµãËØï-3" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h5><p>Âø´ÈÄüÁÇπÂáªËÆøÈóÆ<a target="_blank" rel="noopener" href="http://localhost:8401/testA">http://localhost:8401/testA</a></p>
<p>ÁªìÊûú Blocked by Sentinel (flow limiting)</p>
<p>ÊÄùËÄÉ???</p>
<blockquote>
<p>Áõ¥Êé•Ë∞ÉÁî®ÈªòËÆ§Êä•Èîô‰ø°ÊÅØÔºåÊäÄÊúØÊñπÈù¢OK<br>but,ÊòØÂê¶Â∫îËØ•ÊúâÊàë‰ª¨Ëá™Â∑±ÁöÑÂêéÁª≠Â§ÑÁêÜ?</p>
<p>Á±ª‰ººÊúâ‰∏™fallbackÁöÑÂÖúÂ∫ïÊñπÊ≥ïÔºü</p>
</blockquote>
<h4 id="ÂÖ≥ËÅî"><a href="#ÂÖ≥ËÅî" class="headerlink" title="ÂÖ≥ËÅî"></a>ÂÖ≥ËÅî</h4><h5 id="ÊòØ‰ªÄ‰πà-3"><a href="#ÊòØ‰ªÄ‰πà-3" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h5><ul>
<li>ÂΩìÂÖ≥ËÅîÁöÑËµÑÊ∫êËææÂà∞ÈòàÂÄºÊó∂ÔºåÂ∞±ÈôêÊµÅËá™Â∑±</li>
<li>ÂΩì‰∏éAÂÖ≥ËÅîÁöÑËµÑÊ∫êBËææÂà∞ÈòÄÂÄºÂêéÔºåÂ∞±ÈôêÊµÅAËá™Â∑±</li>
<li>BÊÉπ‰∫ãÔºåAÊåÇ‰∫Ü</li>
</ul>
<h5 id="ÈÖçÁΩÆA"><a href="#ÈÖçÁΩÆA" class="headerlink" title="ÈÖçÁΩÆA"></a>ÈÖçÁΩÆA</h5><blockquote>
<p>ËÆæÁΩÆÊïàÊûú<br>ÂΩìÂÖ≥ËÅîËµÑÊ∫ê&#x2F;testBÁöÑqpsÈòÄÂÄºË∂ÖËøá1Êó∂ÔºåÂ∞±ÈôêÊµÅ&#x2F;testAÁöÑRestËÆøÈóÆÂú∞ÂùÄÔºåÂΩìÂÖ≥ËÅîËµÑÊ∫êÂà∞ÈòàÂÄºÂêéÈôêÂà∂ÈÖçÁΩÆÂ•ΩÁöÑËµÑÊ∫êÂêç</p>
<p> <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali76.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali76.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h5 id="postmanÊ®°ÊãüÂπ∂ÂèëÂØÜÈõÜËÆøÈóÆtestB"><a href="#postmanÊ®°ÊãüÂπ∂ÂèëÂØÜÈõÜËÆøÈóÆtestB" class="headerlink" title="postmanÊ®°ÊãüÂπ∂ÂèëÂØÜÈõÜËÆøÈóÆtestB"></a>postmanÊ®°ÊãüÂπ∂ÂèëÂØÜÈõÜËÆøÈóÆtestB</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali77.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali77.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<ol>
<li><p>ËÆøÈóÆtestBÊàêÂäü</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali78.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali78.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</li>
<li><p>postmanÈáåÊñ∞Âª∫Â§öÁ∫øÁ®ãÈõÜÂêàÁªÑ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali79.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali79.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</li>
<li><p>Â∞ÜËÆøÈóÆÂú∞ÂùÄÊ∑ªÂä†ËøõÊñ∞Êñ∞Á∫øÁ®ãÁªÑ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali80.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali80.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</li>
<li><p>Run  </p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali81.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali81.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>Â§ßÊâπÈáèÁ∫øÁ®ãÈ´òÂπ∂ÂèëËÆøÈóÆBÔºåÂØºËá¥AÂ§±Êïà‰∫Ü</p>
</li>
</ol>
<h5 id="ËøêË°åÂêéÂèëÁé∞testAÊåÇ‰∫Ü"><a href="#ËøêË°åÂêéÂèëÁé∞testAÊåÇ‰∫Ü" class="headerlink" title="ËøêË°åÂêéÂèëÁé∞testAÊåÇ‰∫Ü"></a>ËøêË°åÂêéÂèëÁé∞testAÊåÇ‰∫Ü</h5><p>ÁÇπÂáªËÆøÈóÆ<a target="_blank" rel="noopener" href="http://localhost:8401/testA">http://localhost:8401/testA</a></p>
<p>ÁªìÊûú Blocked by Sentinel (flow limiting)</p>
<h4 id="ÈìæË∑Ø"><a href="#ÈìæË∑Ø" class="headerlink" title="ÈìæË∑Ø"></a>ÈìæË∑Ø</h4><p>Â§ö‰∏™ËØ∑Ê±ÇË∞ÉÁî®‰∫ÜÂêå‰∏Ä‰∏™ÂæÆÊúçÂä°</p>
<p>ÂÆ∂Â∫≠‰Ωú‰∏öËØïËØï</p>
<h3 id="ÊµÅÊéßÊïàÊûú"><a href="#ÊµÅÊéßÊïàÊûú" class="headerlink" title="ÊµÅÊéßÊïàÊûú"></a>ÊµÅÊéßÊïàÊûú</h3><h4 id="Áõ¥Êé•-gt-Âø´ÈÄüÂ§±Ë¥•-ÈªòËÆ§ÁöÑÊµÅÊéßÂ§ÑÁêÜ"><a href="#Áõ¥Êé•-gt-Âø´ÈÄüÂ§±Ë¥•-ÈªòËÆ§ÁöÑÊµÅÊéßÂ§ÑÁêÜ" class="headerlink" title="Áõ¥Êé•-&gt;Âø´ÈÄüÂ§±Ë¥•(ÈªòËÆ§ÁöÑÊµÅÊéßÂ§ÑÁêÜ)"></a>Áõ¥Êé•-&gt;Âø´ÈÄüÂ§±Ë¥•(ÈªòËÆ§ÁöÑÊµÅÊéßÂ§ÑÁêÜ)</h4><blockquote>
<p>Áõ¥Êé•Â§±Ë¥•ÔºåÊäõÂá∫ÂºÇÂ∏∏ Blocked by Sentinel (flow limiting)</p>
<p>Ê∫êÁ†Å com.alibaba.csp.sentinel.slots.block.flow.controller.DefaultController</p>
</blockquote>
<h4 id="È¢ÑÁÉ≠"><a href="#È¢ÑÁÉ≠" class="headerlink" title="È¢ÑÁÉ≠"></a>È¢ÑÁÉ≠</h4><h5 id="ËØ¥Êòé"><a href="#ËØ¥Êòé" class="headerlink" title="ËØ¥Êòé"></a>ËØ¥Êòé</h5><blockquote>
<p>ÂÖ¨ÂºèÔºöÈòàÂÄºÈô§‰ª•coldFactor(ÈªòËÆ§ÂÄº‰∏∫3),ÁªèËøáÈ¢ÑÁÉ≠Êó∂ÈïøÂêéÊâç‰ºöËææÂà∞ÈòàÂÄº</p>
</blockquote>
<h5 id="ÂÆòÁΩë-2"><a href="#ÂÆòÁΩë-2" class="headerlink" title="ÂÆòÁΩë"></a>ÂÆòÁΩë</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel/wiki/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6">https://github.com/alibaba/Sentinel/wiki/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6</a></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali82.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali82.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<blockquote>
<p><strong>ÈªòËÆ§coldFactor‰∏∫3ÔºåÂç≥ËØ∑Ê±Ç QPS ‰ªé threshold &#x2F; 3 ÂºÄÂßãÔºåÁªèÈ¢ÑÁÉ≠Êó∂ÈïøÈÄêÊ∏êÂçáËá≥ËÆæÂÆöÁöÑ QPS ÈòàÂÄº„ÄÇ</strong></p>
<p><strong>ÈôêÊµÅ ÂÜ∑ÂêØÂä®</strong> <a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel/wiki/%E9%99%90%E6%B5%81---%E5%86%B7%E5%90%AF%E5%8A%A8">https://github.com/alibaba/Sentinel/wiki/%E9%99%90%E6%B5%81---%E5%86%B7%E5%90%AF%E5%8A%A8</a></p>
</blockquote>
<h5 id="Ê∫êÁ†Å"><a href="#Ê∫êÁ†Å" class="headerlink" title="Ê∫êÁ†Å"></a>Ê∫êÁ†Å</h5><blockquote>
<p>com.alibaba.csp.sentinel.slots.block.flow.controller.WarmUpController</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali83.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali83.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h5 id="WarmUpÈÖçÁΩÆ"><a href="#WarmUpÈÖçÁΩÆ" class="headerlink" title="WarmUpÈÖçÁΩÆ"></a>WarmUpÈÖçÁΩÆ</h5><blockquote>
<p>ÈªòËÆ§ coldFactor ‰∏∫ 3ÔºåÂç≥ËØ∑Ê±ÇQPS‰ªé(threshold &#x2F; 3) ÂºÄÂßãÔºåÁªèÂ§öÂ∞ëÈ¢ÑÁÉ≠Êó∂ÈïøÊâçÈÄêÊ∏êÂçáËá≥ËÆæÂÆöÁöÑ QPS ÈòàÂÄº„ÄÇ</p>
<hr>
<p>Ê°à‰æãÔºåÈòÄÂÄº‰∏∫10+È¢ÑÁÉ≠Êó∂ÈïøËÆæÁΩÆ5Áßí„ÄÇ<br>Á≥ªÁªüÂàùÂßãÂåñÁöÑÈòÄÂÄº‰∏∫10 &#x2F; 3 Á∫¶Á≠â‰∫é3,Âç≥ÈòÄÂÄºÂàöÂºÄÂßã‰∏∫3ÔºõÁÑ∂ÂêéËøá‰∫Ü5ÁßíÂêéÈòÄÂÄºÊâçÊÖ¢ÊÖ¢ÂçáÈ´òÊÅ¢Â§çÂà∞10</p>
<p> <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali84.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali84.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h5 id="Â§öÊ¨°ÁÇπÂáªhttp-localhost-8401-testB-ÂàöÂºÄÂßã‰∏çË°åÔºåÂêéÁª≠ÊÖ¢ÊÖ¢OK"><a href="#Â§öÊ¨°ÁÇπÂáªhttp-localhost-8401-testB-ÂàöÂºÄÂßã‰∏çË°åÔºåÂêéÁª≠ÊÖ¢ÊÖ¢OK" class="headerlink" title="Â§öÊ¨°ÁÇπÂáªhttp://localhost:8401/testB  ÂàöÂºÄÂßã‰∏çË°åÔºåÂêéÁª≠ÊÖ¢ÊÖ¢OK"></a>Â§öÊ¨°ÁÇπÂáª<a target="_blank" rel="noopener" href="http://localhost:8401/testB">http://localhost:8401/testB</a>  ÂàöÂºÄÂßã‰∏çË°åÔºåÂêéÁª≠ÊÖ¢ÊÖ¢OK</h5><h5 id="Â∫îÁî®Âú∫ÊôØ"><a href="#Â∫îÁî®Âú∫ÊôØ" class="headerlink" title="Â∫îÁî®Âú∫ÊôØ"></a>Â∫îÁî®Âú∫ÊôØ</h5><blockquote>
<p><strong>Â¶ÇÔºöÁßíÊùÄÁ≥ªÁªüÂú®ÂºÄÂêØÁöÑÁû¨Èó¥Ôºå‰ºöÊúâÂæàÂ§öÊµÅÈáè‰∏äÊù•ÔºåÂæàÊúâÂèØËÉΩÊääÁ≥ªÁªüÊâìÊ≠ªÔºåÈ¢ÑÁÉ≠ÊñπÂºèÂ∞±ÊòØÊää‰∏∫‰∫Ü‰øùÊä§Á≥ªÁªüÔºåÂèØÊÖ¢ÊÖ¢ÁöÑÊääÊµÅÈáèÊîæËøõÊù•ÔºåÊÖ¢ÊÖ¢ÁöÑÊääÈòÄÂÄºÂ¢ûÈïøÂà∞ËÆæÁΩÆÁöÑÈòÄÂÄº„ÄÇ</strong></p>
</blockquote>
<h4 id="ÊéíÈòüÁ≠âÂæÖ"><a href="#ÊéíÈòüÁ≠âÂæÖ" class="headerlink" title="ÊéíÈòüÁ≠âÂæÖ"></a>ÊéíÈòüÁ≠âÂæÖ</h4><p>ÂåÄÈÄüÊéíÈòüÔºåËÆ©ËØ∑Ê±Ç‰ª•ÂùáÂåÄÁöÑÈÄüÂ∫¶ÈÄöËøáÔºåÈòÄÂÄºÁ±ªÂûãÂøÖÈ°ªËÆæÊàêQPSÔºåÂê¶ÂàôÊó†Êïà„ÄÇ<br>ËÆæÁΩÆÂê´‰πâÔºö&#x2F;testAÊØèÁßí1Ê¨°ËØ∑Ê±ÇÔºåË∂ÖËøáÁöÑËØùÂ∞±ÊéíÈòüÁ≠âÂæÖÔºåÁ≠âÂæÖÁöÑË∂ÖÊó∂Êó∂Èó¥‰∏∫20000ÊØ´Áßí„ÄÇ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali85.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali85.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h5 id="ÂåÄÈÄüÊéíÈòüÔºåÈòàÂÄºÂøÖÈ°ªËÆæÁΩÆ‰∏∫QPS"><a href="#ÂåÄÈÄüÊéíÈòüÔºåÈòàÂÄºÂøÖÈ°ªËÆæÁΩÆ‰∏∫QPS" class="headerlink" title="ÂåÄÈÄüÊéíÈòüÔºåÈòàÂÄºÂøÖÈ°ªËÆæÁΩÆ‰∏∫QPS"></a>ÂåÄÈÄüÊéíÈòüÔºåÈòàÂÄºÂøÖÈ°ªËÆæÁΩÆ‰∏∫QPS</h5><h5 id="ÂÆòÁΩë-3"><a href="#ÂÆòÁΩë-3" class="headerlink" title="ÂÆòÁΩë"></a>ÂÆòÁΩë</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali86.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali86.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><code>https://github.com/alibaba/Sentinel/wiki/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6</code></p>
<h5 id="Ê∫êÁ†Å-1"><a href="#Ê∫êÁ†Å-1" class="headerlink" title="Ê∫êÁ†Å"></a>Ê∫êÁ†Å</h5><p><code>com.alibaba.csp.sentinel.slots.block.flow.controller.RateLimiterController</code></p>
<h5 id="ÊµãËØï-4"><a href="#ÊµãËØï-4" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali87.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali87.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h2 id="ÈôçÁ∫ßËßÑÂàô"><a href="#ÈôçÁ∫ßËßÑÂàô" class="headerlink" title="ÈôçÁ∫ßËßÑÂàô"></a>ÈôçÁ∫ßËßÑÂàô</h2><h3 id="ÂÆòÁΩë-4"><a href="#ÂÆòÁΩë-4" class="headerlink" title="ÂÆòÁΩë"></a>ÂÆòÁΩë</h3><blockquote>
<p><code>[ÁÜîÊñ≠ÈôçÁ∫ß ¬∑ alibaba/Sentinel Wiki ¬∑ GitHub](https://github.com/alibaba/Sentinel/wiki/ÁÜîÊñ≠ÈôçÁ∫ß)</code></p>
</blockquote>
<h3 id="Âü∫Êú¨‰ªãÁªç-1"><a href="#Âü∫Êú¨‰ªãÁªç-1" class="headerlink" title="Âü∫Êú¨‰ªãÁªç"></a>Âü∫Êú¨‰ªãÁªç</h3><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali88.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali88.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>RTÔºàÂπ≥ÂùáÂìçÂ∫îÊó∂Èó¥ÔºåÁßíÁ∫ßÔºâ</strong><br>      <strong>Âπ≥ÂùáÂìçÂ∫îÊó∂Èó¥   Ë∂ÖÂá∫ÈòàÂÄº  ‰∏î   Âú®Êó∂Èó¥Á™óÂè£ÂÜÖÈÄöËøáÁöÑËØ∑Ê±Ç&gt;&#x3D;5Ôºå‰∏§‰∏™Êù°‰ª∂ÂêåÊó∂Êª°Ë∂≥ÂêéËß¶ÂèëÈôçÁ∫ß</strong><br>      <strong>Á™óÂè£ÊúüËøáÂêéÂÖ≥Èó≠Êñ≠Ë∑ØÂô®</strong><br>      <strong>RTÊúÄÂ§ß4900ÔºàÊõ¥Â§ßÁöÑÈúÄË¶ÅÈÄöËøá-Dcsp.sentinel.statistic.max.rt&#x3D;XXXXÊâçËÉΩÁîüÊïàÔºâ</strong></p>
<p><strong>ÂºÇÂ∏∏ÊØîÂàóÔºàÁßíÁ∫ßÔºâ</strong><br>    <strong>QPS &gt;&#x3D; 5 ‰∏îÂºÇÂ∏∏ÊØî‰æãÔºàÁßíÁ∫ßÁªüËÆ°ÔºâË∂ÖËøáÈòàÂÄºÊó∂ÔºåËß¶ÂèëÈôçÁ∫ßÔºõÊó∂Èó¥Á™óÂè£ÁªìÊùüÂêéÔºåÂÖ≥Èó≠ÈôçÁ∫ß</strong></p>
<p><strong>ÂºÇÂ∏∏Êï∞ÔºàÂàÜÈíüÁ∫ßÔºâ</strong><br>     <strong>ÂºÇÂ∏∏Êï∞ÔºàÂàÜÈíüÁªüËÆ°ÔºâË∂ÖËøáÈòàÂÄºÊó∂ÔºåËß¶ÂèëÈôçÁ∫ßÔºõÊó∂Èó¥Á™óÂè£ÁªìÊùüÂêéÔºåÂÖ≥Èó≠ÈôçÁ∫ß</strong></p>
</blockquote>
<h4 id="Ëøõ‰∏ÄÊ≠•ËØ¥Êòé"><a href="#Ëøõ‰∏ÄÊ≠•ËØ¥Êòé" class="headerlink" title="Ëøõ‰∏ÄÊ≠•ËØ¥Êòé"></a>Ëøõ‰∏ÄÊ≠•ËØ¥Êòé</h4><blockquote>
<p><strong>Sentinel ÁÜîÊñ≠ÈôçÁ∫ß‰ºöÂú®Ë∞ÉÁî®ÈìæË∑Ø‰∏≠Êüê‰∏™ËµÑÊ∫êÂá∫Áé∞‰∏çÁ®≥ÂÆöÁä∂ÊÄÅÊó∂Ôºà‰æãÂ¶ÇË∞ÉÁî®Ë∂ÖÊó∂ÊàñÂºÇÂ∏∏ÊØî‰æãÂçáÈ´òÔºâÔºåÂØπËøô‰∏™ËµÑÊ∫êÁöÑË∞ÉÁî®ËøõË°åÈôêÂà∂Ôºå</strong><br><strong>ËÆ©ËØ∑Ê±ÇÂø´ÈÄüÂ§±Ë¥•ÔºåÈÅøÂÖçÂΩ±ÂìçÂà∞ÂÖ∂ÂÆÉÁöÑËµÑÊ∫êËÄåÂØºËá¥Á∫ßËÅîÈîôËØØ„ÄÇ</strong></p>
<p><strong>ÂΩìËµÑÊ∫êË¢´ÈôçÁ∫ßÂêéÔºåÂú®Êé•‰∏ãÊù•ÁöÑÈôçÁ∫ßÊó∂Èó¥Á™óÂè£‰πãÂÜÖÔºåÂØπËØ•ËµÑÊ∫êÁöÑË∞ÉÁî®ÈÉΩËá™Âä®ÁÜîÊñ≠ÔºàÈªòËÆ§Ë°å‰∏∫ÊòØÊäõÂá∫ DegradeExceptionÔºâ„ÄÇ</strong></p>
</blockquote>
<h4 id="SentinelÁöÑÊñ≠Ë∑ØÂô®ÊòØÊ≤°ÊúâÂçäÂºÄÁä∂ÊÄÅÁöÑ"><a href="#SentinelÁöÑÊñ≠Ë∑ØÂô®ÊòØÊ≤°ÊúâÂçäÂºÄÁä∂ÊÄÅÁöÑ" class="headerlink" title="SentinelÁöÑÊñ≠Ë∑ØÂô®ÊòØÊ≤°ÊúâÂçäÂºÄÁä∂ÊÄÅÁöÑ"></a>SentinelÁöÑÊñ≠Ë∑ØÂô®ÊòØÊ≤°ÊúâÂçäÂºÄÁä∂ÊÄÅÁöÑ</h4><blockquote>
<p>ÂçäÂºÄÁöÑÁä∂ÊÄÅÁ≥ªÁªüËá™Âä®ÂéªÊ£ÄÊµãÊòØÂê¶ËØ∑Ê±ÇÊúâÂºÇÂ∏∏Ôºå<br>Ê≤°ÊúâÂºÇÂ∏∏Â∞±ÂÖ≥Èó≠Êñ≠Ë∑ØÂô®ÊÅ¢Â§ç‰ΩøÁî®Ôºå<br>ÊúâÂºÇÂ∏∏ÂàôÁªßÁª≠ÊâìÂºÄÊñ≠Ë∑ØÂô®‰∏çÂèØÁî®„ÄÇÂÖ∑‰ΩìÂèØ‰ª•ÂèÇËÄÉHystrix</p>
<p><strong>Â§ç‰π†Hystrix</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali89.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali89.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="ÈôçÁ∫ßÁ≠ñÁï•ÂÆûÊàò"><a href="#ÈôçÁ∫ßÁ≠ñÁï•ÂÆûÊàò" class="headerlink" title="ÈôçÁ∫ßÁ≠ñÁï•ÂÆûÊàò"></a>ÈôçÁ∫ßÁ≠ñÁï•ÂÆûÊàò</h3><h4 id="RT"><a href="#RT" class="headerlink" title="RT"></a>RT</h4><h5 id="ÊòØ‰ªÄ‰πà-4"><a href="#ÊòØ‰ªÄ‰πà-4" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h5><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali90.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali90.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali91.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali91.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h5 id="ÊµãËØï-5"><a href="#ÊµãËØï-5" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h5><blockquote>
<p>‰ª£Á†Å</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testD"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testD</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//ÊöÇÂÅúÂá†ÁßíÈíüÁ∫øÁ®ã</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"testD ÊµãËØïRT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"------testD"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ÈÖçÁΩÆ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali92.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali92.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>jmeterÂéãÊµã</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali93.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali93.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÁªìËÆ∫ </p>
<p>ÊåâÁÖß‰∏äËø∞ÈÖçÁΩÆÔºå</p>
<p>  Ê∞∏Ëøú‰∏ÄÁßíÈíüÊâìËøõÊù•10‰∏™Á∫øÁ®ãÔºàÂ§ß‰∫é5‰∏™‰∫ÜÔºâË∞ÉÁî®testDÔºåÊàë‰ª¨Â∏åÊúõ200ÊØ´ÁßíÂ§ÑÁêÜÂÆåÊú¨Ê¨°‰ªªÂä°Ôºå<br>Â¶ÇÊûúË∂ÖËøá200ÊØ´ÁßíËøòÊ≤°Â§ÑÁêÜÂÆåÔºåÂú®Êú™Êù•1ÁßíÈíüÁöÑÊó∂Èó¥Á™óÂè£ÂÜÖÔºåÊñ≠Ë∑ØÂô®ÊâìÂºÄ(‰øùÈô©‰∏ùË∑≥Èó∏)ÂæÆÊúçÂä°‰∏çÂèØÁî®Ôºå‰øùÈô©‰∏ùË∑≥Èó∏Êñ≠Áîµ‰∫Ü</p>
<p>ÂêéÁª≠ÊàëÂÅúÊ≠¢jmeterÔºåÊ≤°ÊúâËøô‰πàÂ§ßÁöÑËÆøÈóÆÈáè‰∫ÜÔºåÊñ≠Ë∑ØÂô®ÂÖ≥Èó≠(‰øùÈô©‰∏ùÊÅ¢Â§ç)ÔºåÂæÆÊúçÂä°ÊÅ¢Â§çOK</p>
</blockquote>
<h4 id="ÂºÇÂ∏∏ÊØî‰æã"><a href="#ÂºÇÂ∏∏ÊØî‰æã" class="headerlink" title="ÂºÇÂ∏∏ÊØî‰æã"></a><strong>ÂºÇÂ∏∏ÊØî‰æã</strong></h4><h5 id="ÊòØ‰ªÄ‰πà-5"><a href="#ÊòØ‰ªÄ‰πà-5" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h5><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali94.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali94.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali95.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali95.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h5 id="ÊµãËØï-6"><a href="#ÊµãËØï-6" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h5><blockquote>
<p>‰ª£Á†Å</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testD"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testE</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"testD ÊµãËØïÂºÇÂ∏∏ÊØî‰æã"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"------testD ÊµãËØïÂºÇÂ∏∏ÊØî‰æã"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ÈÖçÁΩÆ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali96.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali96.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>jmeter</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali97.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali97.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÁªìËÆ∫</p>
<p> ÊåâÁÖß‰∏äËø∞ÈÖçÁΩÆÔºå<br>ÂçïÁã¨ËÆøÈóÆ‰∏ÄÊ¨°ÔºåÂøÖÁÑ∂Êù•‰∏ÄÊ¨°Êä•Èîô‰∏ÄÊ¨°(int age  &#x3D; 10&#x2F;0)ÔºåË∞É‰∏ÄÊ¨°Èîô‰∏ÄÊ¨°Ôºõ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali98.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali98.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÂºÄÂêØjmeterÂêéÔºåÁõ¥Êé•È´òÂπ∂ÂèëÂèëÈÄÅËØ∑Ê±ÇÔºåÂ§öÊ¨°Ë∞ÉÁî®ËææÂà∞Êàë‰ª¨ÁöÑÈÖçÁΩÆÊù°‰ª∂‰∫Ü„ÄÇ<br>Êñ≠Ë∑ØÂô®ÂºÄÂêØ(‰øùÈô©‰∏ùË∑≥Èó∏)ÔºåÂæÆÊúçÂä°‰∏çÂèØÁî®‰∫ÜÔºå‰∏çÂÜçÊä•ÈîôerrorËÄåÊòØÊúçÂä°ÈôçÁ∫ß‰∫Ü„ÄÇ</p>
</blockquote>
<h4 id="ÂºÇÂ∏∏Êï∞"><a href="#ÂºÇÂ∏∏Êï∞" class="headerlink" title="ÂºÇÂ∏∏Êï∞"></a>ÂºÇÂ∏∏Êï∞</h4><h5 id="ÊòØ‰ªÄ‰πà-6"><a href="#ÊòØ‰ªÄ‰πà-6" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h5><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali99.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali99.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>Êó∂Èó¥Á™óÂè£‰∏ÄÂÆöË¶ÅÂ§ß‰∫éÁ≠â‰∫é60Áßí„ÄÇ</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali100.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali100.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h5 id="ÂºÇÂ∏∏Êï∞ÊòØÊåâÁÖßÂàÜÈíüÁªüËÆ°ÁöÑ"><a href="#ÂºÇÂ∏∏Êï∞ÊòØÊåâÁÖßÂàÜÈíüÁªüËÆ°ÁöÑ" class="headerlink" title="ÂºÇÂ∏∏Êï∞ÊòØÊåâÁÖßÂàÜÈíüÁªüËÆ°ÁöÑ"></a>ÂºÇÂ∏∏Êï∞ÊòØÊåâÁÖßÂàÜÈíüÁªüËÆ°ÁöÑ</h5><h5 id="ÊµãËØï-7"><a href="#ÊµãËØï-7" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h5><h6 id="‰ª£Á†Å"><a href="#‰ª£Á†Å" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testF"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testF</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"testF ÊµãËØïÂºÇÂ∏∏Êï∞"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"------testF ÊµãËØïÂºÇÂ∏∏Êï∞"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="ÈÖçÁΩÆ"><a href="#ÈÖçÁΩÆ" class="headerlink" title="ÈÖçÁΩÆ"></a>ÈÖçÁΩÆ</h6><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali101.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali101.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><a target="_blank" rel="noopener" href="http://localhost:8401/testE%EF%BC%8C%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%AE%BF%E9%97%AE%E7%BB%9D%E5%AF%B9%E6%8A%A5%E9%94%99%EF%BC%8C%E5%9B%A0%E4%B8%BA%E9%99%A4%E6%95%B0%E4%B8%8D%E8%83%BD%E4%B8%BA%E9%9B%B6%EF%BC%8C">http://localhost:8401/testEÔºåÁ¨¨‰∏ÄÊ¨°ËÆøÈóÆÁªùÂØπÊä•ÈîôÔºåÂõ†‰∏∫Èô§Êï∞‰∏çËÉΩ‰∏∫Èõ∂Ôºå</a><br>Êàë‰ª¨ÁúãÂà∞errorÁ™óÂè£Ôºå‰ΩÜÊòØËææÂà∞5Ê¨°Êä•ÈîôÂêéÔºåËøõÂÖ•ÁÜîÊñ≠ÂêéÈôçÁ∫ß„ÄÇ</p>
<h6 id="jmeter"><a href="#jmeter" class="headerlink" title="jmeter"></a>jmeter</h6><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali102.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali102.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h2 id="ÁÉ≠ÁÇπkeyÈôêÊµÅ"><a href="#ÁÉ≠ÁÇπkeyÈôêÊµÅ" class="headerlink" title="ÁÉ≠ÁÇπkeyÈôêÊµÅ"></a>ÁÉ≠ÁÇπkeyÈôêÊµÅ</h2><h3 id="Âü∫Êú¨‰ªãÁªç-2"><a href="#Âü∫Êú¨‰ªãÁªç-2" class="headerlink" title="Âü∫Êú¨‰ªãÁªç"></a>Âü∫Êú¨‰ªãÁªç</h3><blockquote>
<p>‰Ωï‰∏∫ÁÉ≠ÁÇπ<br>ÁÉ≠ÁÇπÂç≥ÁªèÂ∏∏ËÆøÈóÆÁöÑÊï∞ÊçÆÔºåÂæàÂ§öÊó∂ÂÄôÊàë‰ª¨Â∏åÊúõÁªüËÆ°ÊàñËÄÖÈôêÂà∂Êüê‰∏™ÁÉ≠ÁÇπÊï∞ÊçÆ‰∏≠ËÆøÈóÆÈ¢ëÊ¨°ÊúÄÈ´òÁöÑTopNÊï∞ÊçÆÔºåÂπ∂ÂØπÂÖ∂ËÆøÈóÆËøõË°åÈôêÊµÅÊàñËÄÖÂÖ∂ÂÆÉÊìç‰Ωú</p>
<p> <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali103.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali103.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="ÂÆòÁΩë-5"><a href="#ÂÆòÁΩë-5" class="headerlink" title="ÂÆòÁΩë"></a>ÂÆòÁΩë</h3><blockquote>
<p><code>https://github.com/alibaba/Sentinel/wiki/%E7%83%AD%E7%82%B9%E5%8F%82%E6%95%B0%E9%99%90%E6%B5%81</code></p>
<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel/wiki/%E7%83%AD%E7%82%B9%E5%8F%82%E6%95%B0%E9%99%90%E6%B5%81">https://github.com/alibaba/Sentinel/wiki/ÁÉ≠ÁÇπÂèÇÊï∞ÈôêÊµÅ</a></p>
</blockquote>
<h3 id="Êâø‰∏äÂêØ‰∏ãÂ§ç‰π†start"><a href="#Êâø‰∏äÂêØ‰∏ãÂ§ç‰π†start" class="headerlink" title="Êâø‰∏äÂêØ‰∏ãÂ§ç‰π†start"></a>Êâø‰∏äÂêØ‰∏ãÂ§ç‰π†start</h3><blockquote>
<p><strong>ÂÖúÂ∫ïÊñπÊ≥ï</strong><br><strong>ÂàÜ‰∏∫Á≥ªÁªüÈªòËÆ§ÂíåÂÆ¢Êà∑Ëá™ÂÆö‰πâÔºå‰∏§Áßç</strong></p>
<p>  ‰πãÂâçÁöÑcaseÔºåÈôêÊµÅÂá∫ÈóÆÈ¢òÂêéÔºåÈÉΩÊòØÁî®sentinelÁ≥ªÁªüÈªòËÆ§ÁöÑÊèêÁ§∫ÔºöBlocked by Sentinel (flow limiting)</p>
<p>  Êàë‰ª¨ËÉΩ‰∏çËÉΩËá™ÂÆö?Á±ª‰ººhystrixÔºåÊüê‰∏™ÊñπÊ≥ïÂá∫ÈóÆÈ¢ò‰∫ÜÔºåÂ∞±ÊâæÂØπÂ∫îÁöÑÂÖúÂ∫ïÈôçÁ∫ßÊñπÊ≥ïÔºü</p>
<p><strong>ÁªìËÆ∫</strong><br>    ‰ªéHystrixCommand Âà∞@SentinelResource**</p>
<p> @SentinelResource</p>
</blockquote>
<h3 id="‰ª£Á†Å-1"><a href="#‰ª£Á†Å-1" class="headerlink" title="‰ª£Á†Å"></a>‰ª£Á†Å</h3><blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testHotKey"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"testHotKey"</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">"dealHandler_testHotKey"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testHotKey</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"p1"</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> p1<span class="token punctuation">,</span>
                             <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"p2"</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> p2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"------testHotKey"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">dealHandler_testHotKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> p1<span class="token punctuation">,</span> <span class="token class-name">String</span> p2<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"-----dealHandler_testHotKey"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
<span class="token comment">//    sentinelÁ≥ªÁªüÈªòËÆ§ÁöÑÊèêÁ§∫Ôºö</span>
<span class="token comment">//    Blocked by Sentinel(flow limiting)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>com.alibaba.csp.sentinel.slots.block.BlockException</strong></p>
</blockquote>
<h3 id="ÈÖçÁΩÆ-1"><a href="#ÈÖçÁΩÆ-1" class="headerlink" title="ÈÖçÁΩÆ"></a>ÈÖçÁΩÆ</h3><blockquote>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali104.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali104.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>ÈôêÊµÅÊ®°ÂºèÂè™ÊîØÊåÅQPSÊ®°ÂºèÔºåÂõ∫ÂÆöÂÜôÊ≠ª‰∫Ü„ÄÇÔºàËøôÊâçÂè´ÁÉ≠ÁÇπÔºâ</strong><br><strong>@SentinelResourceÊ≥®Ëß£ÁöÑÊñπÊ≥ïÂèÇÊï∞Á¥¢ÂºïÔºå0‰ª£Ë°®Á¨¨‰∏Ä‰∏™ÂèÇÊï∞Ôºå1‰ª£Ë°®Á¨¨‰∫å‰∏™ÂèÇÊï∞Ôºå‰ª•Ê≠§Á±ªÊé®</strong><br><strong>ÂçïÊú∫ÈòÄÂÄº‰ª•ÂèäÁªüËÆ°Á™óÂè£Êó∂ÈïøË°®Á§∫Âú®Ê≠§Á™óÂè£Êó∂Èó¥Ë∂ÖËøáÈòÄÂÄºÂ∞±ÈôêÊµÅ„ÄÇ</strong><br>&#96;‰∏äÈù¢ÁöÑÊäìÂõæÂ∞±ÊòØÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊúâÂÄºÁöÑËØùÔºå1ÁßíÁöÑQPS‰∏∫1ÔºåË∂ÖËøáÂ∞±ÈôêÊµÅÔºåÈôêÊµÅÂêéË∞ÉÁî®<strong>dealHandler_testHotKeyÊîØÊåÅÊñπÊ≥ï„ÄÇ</strong></p>
</blockquote>
<p>ÈÖçÁΩÆ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali105.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali105.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>1„ÄÅ</p>
<p>‚Äã	@SentinelResource(value &#x3D; ‚ÄútestHotKey‚Äù)</p>
<p>‚Äã	ÂºÇÂ∏∏ÊâìÂà∞‰∫ÜÂâçÂè∞Áî®Êà∑ÁïåÈù¢ÁúãÂà∞Ôºå‰∏çÂèãÂ•Ω</p>
<p>2„ÄÅ</p>
<p>‚Äã	@SentinelResource(value &#x3D; ‚ÄútestHotKey‚Äù,blockHandler &#x3D; ‚ÄúdealHandler_testHotKey‚Äù)</p>
<p>‚Äã	ÊñπÊ≥ïtestHotKeyÈáåÈù¢Á¨¨‰∏Ä‰∏™ÂèÇÊï∞Âè™Ë¶ÅQPSË∂ÖËøáÊØèÁßí1Ê¨°ÔºåÈ©¨‰∏äÈôçÁ∫ßÂ§ÑÁêÜ</p>
<p>‚Äã	Áî®‰∫ÜÊàë‰ª¨Ëá™Â∑±ÂÆö‰πâÁöÑ</p>
<h3 id="ÊµãËØï-8"><a href="#ÊµãËØï-8" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h3><ul>
<li>error <a target="_blank" rel="noopener" href="http://localhost:8401/testHotKey?p1=abc">http://localhost:8401/testHotKey?p1=abc</a></li>
<li>error <a target="_blank" rel="noopener" href="http://localhost:8401/testHotKey?p1=abc&amp;p2=33">http://localhost:8401/testHotKey?p1=abc&amp;p2=33</a></li>
<li>right <a target="_blank" rel="noopener" href="http://localhost:8401/testHotKey?p2=abc">http://localhost:8401/testHotKey?p2=abc</a></li>
</ul>
<h3 id="ÂèÇÊï∞‰æãÂ§ñÈ°π"><a href="#ÂèÇÊï∞‰æãÂ§ñÈ°π" class="headerlink" title="ÂèÇÊï∞‰æãÂ§ñÈ°π"></a>ÂèÇÊï∞‰æãÂ§ñÈ°π</h3><h4 id="‰∏äËø∞Ê°à‰æãÊºîÁ§∫‰∫ÜÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞p1ÔºåÂΩìQPSË∂ÖËøá1Áßí1Ê¨°ÁÇπÂáªÂêéÈ©¨‰∏äË¢´ÈôêÊµÅ"><a href="#‰∏äËø∞Ê°à‰æãÊºîÁ§∫‰∫ÜÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞p1ÔºåÂΩìQPSË∂ÖËøá1Áßí1Ê¨°ÁÇπÂáªÂêéÈ©¨‰∏äË¢´ÈôêÊµÅ" class="headerlink" title="‰∏äËø∞Ê°à‰æãÊºîÁ§∫‰∫ÜÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞p1ÔºåÂΩìQPSË∂ÖËøá1Áßí1Ê¨°ÁÇπÂáªÂêéÈ©¨‰∏äË¢´ÈôêÊµÅ"></a>‰∏äËø∞Ê°à‰æãÊºîÁ§∫‰∫ÜÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞p1ÔºåÂΩìQPSË∂ÖËøá1Áßí1Ê¨°ÁÇπÂáªÂêéÈ©¨‰∏äË¢´ÈôêÊµÅ</h4><h4 id="Áâπ‰æãÊÉÖÂÜµ"><a href="#Áâπ‰æãÊÉÖÂÜµ" class="headerlink" title="Áâπ‰æãÊÉÖÂÜµ"></a>Áâπ‰æãÊÉÖÂÜµ</h4><ul>
<li>ÊôÆÈÄö‚ÄîË∂ÖËøá1ÁßíÈíü‰∏Ä‰∏™ÂêéÔºåËææÂà∞ÈòàÂÄº1ÂêéÈ©¨‰∏äË¢´ÈôêÊµÅ</li>
<li>Êàë‰ª¨ÊúüÊúõp1ÂèÇÊï∞ÂΩìÂÆÉÊòØÊüê‰∏™ÁâπÊÆäÂÄºÊó∂ÔºåÂÆÉÁöÑÈôêÊµÅÂÄºÂíåÂπ≥Êó∂‰∏ç‰∏ÄÊ†∑</li>
<li>Áâπ‰æã‚ÄîÂÅáÂ¶ÇÂΩìp1ÁöÑÂÄºÁ≠â‰∫é5Êó∂ÔºåÂÆÉÁöÑÈòàÂÄºÂèØ‰ª•ËææÂà∞200</li>
</ul>
<h4 id="ÈÖçÁΩÆ-2"><a href="#ÈÖçÁΩÆ-2" class="headerlink" title="ÈÖçÁΩÆ"></a>ÈÖçÁΩÆ</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali106.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali106.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali107.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali107.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>Ê∑ªÂä†ÊåâÈíÆ‰∏çËÉΩÂøò</strong></p>
<h4 id="ÊµãËØï-9"><a href="#ÊµãËØï-9" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h4><ul>
<li><a target="_blank" rel="noopener" href="http://localhost:8401/testHotKey?p1=5">http://localhost:8401/testHotKey?p1=5</a> ‚àö</li>
<li><a target="_blank" rel="noopener" href="http://localhost:8401/testHotKey?p1=3">http://localhost:8401/testHotKey?p1=3</a> √ó</li>
<li>ÂΩìp1Á≠â‰∫é5ÁöÑÊó∂ÂÄôÔºåÈòàÂÄºÂèò‰∏∫200</li>
<li>ÂΩìp1‰∏çÁ≠â‰∫é5ÁöÑÊó∂ÂÄôÔºåÈòàÂÄºÂ∞±ÊòØÂπ≥Â∏∏ÁöÑ1</li>
</ul>
<h4 id="ÂâçÊèêÊù°‰ª∂"><a href="#ÂâçÊèêÊù°‰ª∂" class="headerlink" title="ÂâçÊèêÊù°‰ª∂"></a>ÂâçÊèêÊù°‰ª∂</h4><blockquote>
<p><strong>ÁÉ≠ÁÇπÂèÇÊï∞ÁöÑÊ≥®ÊÑèÁÇπÔºåÂèÇÊï∞ÂøÖÈ°ªÊòØÂü∫Êú¨Á±ªÂûãÊàñËÄÖString</strong></p>
</blockquote>
<h3 id="ÂÖ∂ÂÆÉ"><a href="#ÂÖ∂ÂÆÉ" class="headerlink" title="ÂÖ∂ÂÆÉ"></a>ÂÖ∂ÂÆÉ</h3><blockquote>
<p> ÊâãË¥±Ê∑ªÂä†ÂºÇÂ∏∏ÁúãÁúã‚Ä¶‚Ä¶&#x2F;(„Ñío„Ñí)&#x2F;~~</p>
<p>ÂêéÈù¢ËÆ≤</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"> 
<span class="token annotation punctuation">@SentinelResource</span>
Â§ÑÁêÜÁöÑÊòØ<span class="token class-name">Sentinel</span>ÊéßÂà∂Âè∞ÈÖçÁΩÆÁöÑËøùËßÑÊÉÖÂÜµÔºåÊúâblockHandlerÊñπÊ≥ïÈÖçÁΩÆÁöÑÂÖúÂ∫ïÂ§ÑÁêÜÔºõ
 
 
<span class="token class-name">RuntimeException</span>
<span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">,</span>Ëøô‰∏™ÊòØjavaËøêË°åÊó∂Êä•Âá∫ÁöÑËøêË°åÊó∂ÂºÇÂ∏∏<span class="token class-name">RunTimeException</span>Ôºå<span class="token annotation punctuation">@SentinelResource</span>‰∏çÁÆ°
 
 
ÊÄªÁªì
 <span class="token annotation punctuation">@SentinelResource</span>‰∏ªÁÆ°ÈÖçÁΩÆÂá∫ÈîôÔºåËøêË°åÂá∫ÈîôËØ•Ëµ∞ÂºÇÂ∏∏Ëµ∞ÂºÇÂ∏∏
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h2 id="Á≥ªÁªüËßÑÂàô"><a href="#Á≥ªÁªüËßÑÂàô" class="headerlink" title="Á≥ªÁªüËßÑÂàô"></a>Á≥ªÁªüËßÑÂàô</h2><h3 id="ÊòØ‰ªÄ‰πà-7"><a href="#ÊòØ‰ªÄ‰πà-7" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h3><blockquote>
<p><code>https://github.com/alibaba/Sentinel/wiki/%E7%B3%BB%E7%BB%9F%E8%87%AA%E9%80%82%E5%BA%94%E9%99%90%E6%B5%81</code></p>
</blockquote>
<h3 id="ÂêÑÈ°πÈÖçÁΩÆÂèÇÊï∞ËØ¥Êòé"><a href="#ÂêÑÈ°πÈÖçÁΩÆÂèÇÊï∞ËØ¥Êòé" class="headerlink" title="ÂêÑÈ°πÈÖçÁΩÆÂèÇÊï∞ËØ¥Êòé"></a>ÂêÑÈ°πÈÖçÁΩÆÂèÇÊï∞ËØ¥Êòé</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali108.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali108.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="ÈÖçÁΩÆÂÖ®Â±ÄQPS"><a href="#ÈÖçÁΩÆÂÖ®Â±ÄQPS" class="headerlink" title="ÈÖçÁΩÆÂÖ®Â±ÄQPS"></a>ÈÖçÁΩÆÂÖ®Â±ÄQPS</h3><h2 id="SentinelResource"><a href="#SentinelResource" class="headerlink" title="@SentinelResource"></a>@SentinelResource</h2><h3 id="ÊåâËµÑÊ∫êÂêçÁß∞ÈôêÊµÅ-ÂêéÁª≠Â§ÑÁêÜ"><a href="#ÊåâËµÑÊ∫êÂêçÁß∞ÈôêÊµÅ-ÂêéÁª≠Â§ÑÁêÜ" class="headerlink" title="ÊåâËµÑÊ∫êÂêçÁß∞ÈôêÊµÅ+ÂêéÁª≠Â§ÑÁêÜ"></a>ÊåâËµÑÊ∫êÂêçÁß∞ÈôêÊµÅ+ÂêéÁª≠Â§ÑÁêÜ</h3><h4 id="ÂêØÂä®NacosÊàêÂäü"><a href="#ÂêØÂä®NacosÊàêÂäü" class="headerlink" title="ÂêØÂä®NacosÊàêÂäü"></a>ÂêØÂä®NacosÊàêÂäü</h4><blockquote>
<p> <code>http://localhost:8848/nacos/#/login</code></p>
</blockquote>
<h4 id="ÂêØÂä®SentinelÊàêÂäü"><a href="#ÂêØÂä®SentinelÊàêÂäü" class="headerlink" title="ÂêØÂä®SentinelÊàêÂäü"></a>ÂêØÂä®SentinelÊàêÂäü</h4><blockquote>
<p><code>java -jar sentinel-dashboard-1.7.0.jar</code></p>
</blockquote>
<h4 id="ÊîπModule-cloudalibaba-sentinel-service8401"><a href="#ÊîπModule-cloudalibaba-sentinel-service8401" class="headerlink" title="ÊîπModule cloudalibaba-sentinel-service8401"></a>ÊîπModule cloudalibaba-sentinel-service8401</h4><h5 id="ÊîπPOM-4"><a href="#ÊîπPOM-4" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h5><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ÂºïÂÖ•Ëá™Â∑±ÂÆö‰πâÁöÑapiÈÄöÁî®ÂåÖÔºåÂèØ‰ª•‰ΩøÁî®PaymentÊîØ‰ªòEntity --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;project.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="‰∏öÂä°Á±ªRateLimitController"><a href="#‰∏öÂä°Á±ªRateLimitController" class="headerlink" title="‰∏öÂä°Á±ªRateLimitController"></a>‰∏öÂä°Á±ªRateLimitController</h5><h6 id="RateLimitController"><a href="#RateLimitController" class="headerlink" title="RateLimitController"></a>RateLimitController</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>slots<span class="token punctuation">.</span>block<span class="token punctuation">.</span></span><span class="token class-name">BlockException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RateLimitController</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/byResource"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"byResource"</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">"handleException"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">byResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"ÊåâËµÑÊ∫êÂêçÁß∞ÈôêÊµÅÊµãËØïOK"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020L</span><span class="token punctuation">,</span> <span class="token string">"serial001"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span> exception<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCanonicalName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t ÊúçÂä°‰∏çÂèØÁî®"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>localhost:8401&#x2F;byResource</p>
</blockquote>
<h4 id="ÈÖçÁΩÆÊµÅÊéßËßÑÂàô"><a href="#ÈÖçÁΩÆÊµÅÊéßËßÑÂàô" class="headerlink" title="ÈÖçÁΩÆÊµÅÊéßËßÑÂàô"></a>ÈÖçÁΩÆÊµÅÊéßËßÑÂàô</h4><h5 id="ÈÖçÁΩÆÊ≠•È™§"><a href="#ÈÖçÁΩÆÊ≠•È™§" class="headerlink" title="ÈÖçÁΩÆÊ≠•È™§"></a>ÈÖçÁΩÆÊ≠•È™§</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali109.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali109.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h5 id="ÂõæÂΩ¢ÈÖçÁΩÆÂíå‰ª£Á†ÅÂÖ≥Á≥ª"><a href="#ÂõæÂΩ¢ÈÖçÁΩÆÂíå‰ª£Á†ÅÂÖ≥Á≥ª" class="headerlink" title="ÂõæÂΩ¢ÈÖçÁΩÆÂíå‰ª£Á†ÅÂÖ≥Á≥ª"></a>ÂõæÂΩ¢ÈÖçÁΩÆÂíå‰ª£Á†ÅÂÖ≥Á≥ª</h5><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali110.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali110.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h5 id="Ë°®Á§∫1ÁßíÈíüÂÜÖÊü•ËØ¢Ê¨°Êï∞Â§ß‰∫é1ÔºåÂ∞±Ë∑ëÂà∞Êàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂ§ÑÊµÅÔºåÈôêÊµÅ"><a href="#Ë°®Á§∫1ÁßíÈíüÂÜÖÊü•ËØ¢Ê¨°Êï∞Â§ß‰∫é1ÔºåÂ∞±Ë∑ëÂà∞Êàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂ§ÑÊµÅÔºåÈôêÊµÅ" class="headerlink" title="Ë°®Á§∫1ÁßíÈíüÂÜÖÊü•ËØ¢Ê¨°Êï∞Â§ß‰∫é1ÔºåÂ∞±Ë∑ëÂà∞Êàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂ§ÑÊµÅÔºåÈôêÊµÅ"></a>Ë°®Á§∫1ÁßíÈíüÂÜÖÊü•ËØ¢Ê¨°Êï∞Â§ß‰∫é1ÔºåÂ∞±Ë∑ëÂà∞Êàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂ§ÑÊµÅÔºåÈôêÊµÅ</h5><h4 id="ÊµãËØï-10"><a href="#ÊµãËØï-10" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h4><blockquote>
<p>1ÁßíÈíüÁÇπÂáª1‰∏ãÔºåOK</p>
<p>Ë∂ÖËøá‰∏äËø∞ÔºåÁñØÁãÇÁÇπÂáªÔºåËøîÂõû‰∫ÜËá™Â∑±ÂÆö‰πâÁöÑÈôêÊµÅÂ§ÑÁêÜ‰ø°ÊÅØÔºåÈôêÊµÅÂèëÁîü</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali111.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali111.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h4 id="È¢ùÂ§ñÈóÆÈ¢ò"><a href="#È¢ùÂ§ñÈóÆÈ¢ò" class="headerlink" title="È¢ùÂ§ñÈóÆÈ¢ò"></a>È¢ùÂ§ñÈóÆÈ¢ò</h4><blockquote>
<p> <strong>Ê≠§Êó∂ÂÖ≥Èó≠ÈóÆÊúçÂä°8401ÁúãÁúã</strong></p>
<p> <strong>SentinelÊéßÂà∂Âè∞ÔºåÊµÅÊéßËßÑÂàôÊ∂àÂ§±‰∫ÜÔºüÔºüÔºüÔºüÔºü ‰∏¥Êó∂&#x2F;ÊåÅ‰πÖÔºü</strong>  ‰∏¥Êó∂ÁöÑ</p>
</blockquote>
<h3 id="ÊåâÁÖßUrlÂú∞ÂùÄÈôêÊµÅ-ÂêéÁª≠Â§ÑÁêÜ"><a href="#ÊåâÁÖßUrlÂú∞ÂùÄÈôêÊµÅ-ÂêéÁª≠Â§ÑÁêÜ" class="headerlink" title="ÊåâÁÖßUrlÂú∞ÂùÄÈôêÊµÅ+ÂêéÁª≠Â§ÑÁêÜ"></a>ÊåâÁÖßUrlÂú∞ÂùÄÈôêÊµÅ+ÂêéÁª≠Â§ÑÁêÜ</h3><h4 id="ÈÄöËøáËÆøÈóÆÁöÑURLÊù•ÈôêÊµÅÔºå‰ºöËøîÂõûSentinelËá™Â∏¶ÈªòËÆ§ÁöÑÈôêÊµÅÂ§ÑÁêÜ‰ø°ÊÅØ"><a href="#ÈÄöËøáËÆøÈóÆÁöÑURLÊù•ÈôêÊµÅÔºå‰ºöËøîÂõûSentinelËá™Â∏¶ÈªòËÆ§ÁöÑÈôêÊµÅÂ§ÑÁêÜ‰ø°ÊÅØ" class="headerlink" title="ÈÄöËøáËÆøÈóÆÁöÑURLÊù•ÈôêÊµÅÔºå‰ºöËøîÂõûSentinelËá™Â∏¶ÈªòËÆ§ÁöÑÈôêÊµÅÂ§ÑÁêÜ‰ø°ÊÅØ"></a>ÈÄöËøáËÆøÈóÆÁöÑURLÊù•ÈôêÊµÅÔºå‰ºöËøîÂõûSentinelËá™Â∏¶ÈªòËÆ§ÁöÑÈôêÊµÅÂ§ÑÁêÜ‰ø°ÊÅØ</h4><h4 id="‰∏öÂä°Á±ªRateLimitController-1"><a href="#‰∏öÂä°Á±ªRateLimitController-1" class="headerlink" title="‰∏öÂä°Á±ªRateLimitController"></a>‰∏öÂä°Á±ªRateLimitController</h4><h5 id="RateLimitController-1"><a href="#RateLimitController-1" class="headerlink" title="RateLimitController"></a>RateLimitController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/rateLimit/byUrl"</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"byUrl"</span><span class="token punctuation">)</span>
   <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">byUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"ÊåâurlÈôêÊµÅÊµãËØïOK"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020L</span><span class="token punctuation">,</span> <span class="token string">"serial002"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ËÆøÈóÆ‰∏ÄÊ¨°"><a href="#ËÆøÈóÆ‰∏ÄÊ¨°" class="headerlink" title="ËÆøÈóÆ‰∏ÄÊ¨°"></a>ËÆøÈóÆ‰∏ÄÊ¨°</h4><blockquote>
<p><code>http://localhost:8401/rateLimit/byUrl</code></p>
</blockquote>
<h4 id="SentinelÊéßÂà∂Âè∞ÈÖçÁΩÆ"><a href="#SentinelÊéßÂà∂Âè∞ÈÖçÁΩÆ" class="headerlink" title="SentinelÊéßÂà∂Âè∞ÈÖçÁΩÆ"></a>SentinelÊéßÂà∂Âè∞ÈÖçÁΩÆ</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali112.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali112.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÊµãËØï-11"><a href="#ÊµãËØï-11" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h4><blockquote>
<p>ÁñØÁãÇÁÇπÂáª<a target="_blank" rel="noopener" href="http://localhost:8401/rateLimit/byUrl">http://localhost:8401/rateLimit/byUrl</a></p>
<p>ÁªìÊûú</p>
<p>‚Äã		 ‰ºöËøîÂõûSentinelËá™Â∏¶ÁöÑÈôêÊµÅÂ§ÑÁêÜÁªìÊûú<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali113.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali113.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="‰∏äÈù¢ÂÖúÂ∫ïÊñπÊ°àÈù¢‰∏¥ÁöÑÈóÆÈ¢ò"><a href="#‰∏äÈù¢ÂÖúÂ∫ïÊñπÊ°àÈù¢‰∏¥ÁöÑÈóÆÈ¢ò" class="headerlink" title="‰∏äÈù¢ÂÖúÂ∫ïÊñπÊ°àÈù¢‰∏¥ÁöÑÈóÆÈ¢ò"></a>‰∏äÈù¢ÂÖúÂ∫ïÊñπÊ°àÈù¢‰∏¥ÁöÑÈóÆÈ¢ò</h3><ul>
<li><p>1  Á≥ªÁªüÈªòËÆ§ÁöÑÔºåÊ≤°Êúâ‰ΩìÁé∞Êàë‰ª¨Ëá™Â∑±ÁöÑ‰∏öÂä°Ë¶ÅÊ±Ç„ÄÇ</p>
</li>
<li><p>2  ‰æùÁÖßÁé∞ÊúâÊù°‰ª∂ÔºåÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂ§ÑÁêÜÊñπÊ≥ïÂèàÂíå‰∏öÂä°‰ª£Á†ÅËÄ¶ÂêàÂú®‰∏ÄÂùóÔºå‰∏çÁõ¥ËßÇ„ÄÇ</p>
</li>
<li><p>3  ÊØè‰∏™‰∏öÂä°ÊñπÊ≥ïÈÉΩÊ∑ªÂä†‰∏Ä‰∏™ÂÖúÂ∫ïÁöÑÔºåÈÇ£‰ª£Á†ÅËÜ®ËÉÄÂä†Ââß„ÄÇ</p>
</li>
<li><p>4  ÂÖ®Â±ÄÁªü‰∏ÄÁöÑÂ§ÑÁêÜÊñπÊ≥ïÊ≤°Êúâ‰ΩìÁé∞„ÄÇ</p>
</li>
</ul>
<h3 id="ÂÆ¢Êà∑Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë"><a href="#ÂÆ¢Êà∑Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë" class="headerlink" title="ÂÆ¢Êà∑Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë"></a>ÂÆ¢Êà∑Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë</h3><h4 id="ÂàõÂª∫CustomerBlockHandlerÁ±ªÁî®‰∫éËá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë"><a href="#ÂàõÂª∫CustomerBlockHandlerÁ±ªÁî®‰∫éËá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë" class="headerlink" title="ÂàõÂª∫CustomerBlockHandlerÁ±ªÁî®‰∫éËá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë"></a>ÂàõÂª∫CustomerBlockHandlerÁ±ªÁî®‰∫éËá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë</h4><h4 id="Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÁ±ª-CustomerBlockHandler"><a href="#Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÁ±ª-CustomerBlockHandler" class="headerlink" title="Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÁ±ª CustomerBlockHandler"></a>Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÁ±ª CustomerBlockHandler</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>myhandler</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>slots<span class="token punctuation">.</span>block<span class="token punctuation">.</span></span><span class="token class-name">BlockException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerBlockHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token string">"Ëá™ÂÆö‰πâÁöÑÈôêÊµÅÂ§ÑÁêÜ‰ø°ÊÅØ......CustomerBlockHandler  1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">handleException2</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token string">"Ëá™ÂÆö‰πâÁöÑÈôêÊµÅÂ§ÑÁêÜ‰ø°ÊÅØ......CustomerBlockHandler  2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali114.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali114.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="‰øÆÊîπRateLimitController"><a href="#‰øÆÊîπRateLimitController" class="headerlink" title="‰øÆÊîπRateLimitController"></a>‰øÆÊîπRateLimitController</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
    * Ëá™ÂÆö‰πâÈÄöÁî®ÁöÑÈôêÊµÅÂ§ÑÁêÜÈÄªËæëÔºå
    blockHandlerClass = CustomerBlockHandler.class
    blockHandler = handleException
    ‰∏äËø∞ÈÖçÁΩÆÔºöÊâæCustomerBlockHandlerÁ±ªÈáåÁöÑhandleExceptionÊñπÊ≥ïËøõË°åÂÖúÂ∫ïÂ§ÑÁêÜ
    */</span>
   <span class="token comment">/**
    * Ëá™ÂÆö‰πâÈÄöÁî®ÁöÑÈôêÊµÅÂ§ÑÁêÜÈÄªËæë
    */</span>
   <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/rateLimit/customerBlockHandler"</span><span class="token punctuation">)</span>
   <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"customerBlockHandler"</span><span class="token punctuation">,</span>
           blockHandlerClass <span class="token operator">=</span> <span class="token class-name">CustomerBlockHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">"handleException2"</span><span class="token punctuation">)</span>
   <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">customerBlockHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"ÊåâÂÆ¢Êà∑Ëá™ÂÆö‰πâÈôêÊµÅÂ§ÑÁêÜÈÄªËæë"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ÂêØÂä®ÂæÆÊúçÂä°ÂêéÂÖàË∞ÉÁî®‰∏ÄÊ¨°"><a href="#ÂêØÂä®ÂæÆÊúçÂä°ÂêéÂÖàË∞ÉÁî®‰∏ÄÊ¨°" class="headerlink" title="ÂêØÂä®ÂæÆÊúçÂä°ÂêéÂÖàË∞ÉÁî®‰∏ÄÊ¨°"></a>ÂêØÂä®ÂæÆÊúçÂä°ÂêéÂÖàË∞ÉÁî®‰∏ÄÊ¨°</h4><blockquote>
<p><code>http://localhost:8401/rateLimit/customerBlockHandler</code></p>
</blockquote>
<h4 id="SentinelÊéßÂà∂Âè∞ÈÖçÁΩÆ-1"><a href="#SentinelÊéßÂà∂Âè∞ÈÖçÁΩÆ-1" class="headerlink" title="SentinelÊéßÂà∂Âè∞ÈÖçÁΩÆ"></a>SentinelÊéßÂà∂Âè∞ÈÖçÁΩÆ</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali115.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali115.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÊµãËØïÂêéÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂá∫Êù•‰∫Ü"><a href="#ÊµãËØïÂêéÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂá∫Êù•‰∫Ü" class="headerlink" title="ÊµãËØïÂêéÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂá∫Êù•‰∫Ü"></a>ÊµãËØïÂêéÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂá∫Êù•‰∫Ü</h4><h4 id="Ëøõ‰∏ÄÊ≠•ËØ¥Êòé-1"><a href="#Ëøõ‰∏ÄÊ≠•ËØ¥Êòé-1" class="headerlink" title="Ëøõ‰∏ÄÊ≠•ËØ¥Êòé"></a>Ëøõ‰∏ÄÊ≠•ËØ¥Êòé</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali116.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali116.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="Êõ¥Â§öÊ≥®Ëß£Â±ûÊÄßËØ¥Êòé"><a href="#Êõ¥Â§öÊ≥®Ëß£Â±ûÊÄßËØ¥Êòé" class="headerlink" title="Êõ¥Â§öÊ≥®Ëß£Â±ûÊÄßËØ¥Êòé"></a>Êõ¥Â§öÊ≥®Ëß£Â±ûÊÄßËØ¥Êòé</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali117.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali117.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="Â§öËØ¥‰∏ÄÂè•"><a href="#Â§öËØ¥‰∏ÄÂè•" class="headerlink" title="Â§öËØ¥‰∏ÄÂè•"></a>Â§öËØ¥‰∏ÄÂè•</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali118.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali118.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>ÊâÄÊúâÁöÑ‰ª£Á†ÅÈÉΩË¶ÅÁî®try-catch-finallyÊñπÂºèËøõË°åÂ§ÑÁêÜÔºåo(‚ï•Ôπè‚ï•)o</strong></p>
<h4 id="Sentinel‰∏ªË¶ÅÊúâ‰∏â‰∏™Ê†∏ÂøÉApi"><a href="#Sentinel‰∏ªË¶ÅÊúâ‰∏â‰∏™Ê†∏ÂøÉApi" class="headerlink" title="Sentinel‰∏ªË¶ÅÊúâ‰∏â‰∏™Ê†∏ÂøÉApi"></a>Sentinel‰∏ªË¶ÅÊúâ‰∏â‰∏™Ê†∏ÂøÉApi</h4><ul>
<li><strong>SphUÂÆö‰πâËµÑÊ∫ê</strong></li>
<li><strong>TracerÂÆö‰πâÁªüËÆ°</strong></li>
<li><strong>ContextUtilÂÆö‰πâ‰∫Ü‰∏ä‰∏ãÊñá</strong></li>
</ul>
<h2 id="ÊúçÂä°ÁÜîÊñ≠ÂäüËÉΩ"><a href="#ÊúçÂä°ÁÜîÊñ≠ÂäüËÉΩ" class="headerlink" title="ÊúçÂä°ÁÜîÊñ≠ÂäüËÉΩ"></a>ÊúçÂä°ÁÜîÊñ≠ÂäüËÉΩ</h2><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali119.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali119.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="sentinelÊï¥Âêàribbon-openFeign-fallback"><a href="#sentinelÊï¥Âêàribbon-openFeign-fallback" class="headerlink" title="sentinelÊï¥Âêàribbon+openFeign+fallback"></a>sentinelÊï¥Âêàribbon+openFeign+fallback</h3><h3 id="RibbonÁ≥ªÂàó"><a href="#RibbonÁ≥ªÂàó" class="headerlink" title="RibbonÁ≥ªÂàó"></a>RibbonÁ≥ªÂàó</h3><h4 id="ÂêØÂä®nacosÂíåsentinel"><a href="#ÂêØÂä®nacosÂíåsentinel" class="headerlink" title="ÂêØÂä®nacosÂíåsentinel"></a>ÂêØÂä®nacosÂíåsentinel</h4><h4 id="Êèê‰æõËÄÖ9003-x2F-9004"><a href="#Êèê‰æõËÄÖ9003-x2F-9004" class="headerlink" title="Êèê‰æõËÄÖ9003&#x2F;9004"></a>Êèê‰æõËÄÖ9003&#x2F;9004</h4><h5 id="Êñ∞Âª∫cloudalibaba-provider-payment9003-x2F-9004‰∏§‰∏™‰∏ÄÊ†∑ÁöÑÂÅöÊ≥ï"><a href="#Êñ∞Âª∫cloudalibaba-provider-payment9003-x2F-9004‰∏§‰∏™‰∏ÄÊ†∑ÁöÑÂÅöÊ≥ï" class="headerlink" title="Êñ∞Âª∫cloudalibaba-provider-payment9003&#x2F;9004‰∏§‰∏™‰∏ÄÊ†∑ÁöÑÂÅöÊ≥ï"></a>Êñ∞Âª∫cloudalibaba-provider-payment9003&#x2F;9004‰∏§‰∏™‰∏ÄÊ†∑ÁöÑÂÅöÊ≥ï</h5><h5 id="ÊîπPOM-5"><a href="#ÊîπPOM-5" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h5><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloudalibaba-provider-payment9003<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ÂºïÂÖ•Ëá™Â∑±ÂÆö‰πâÁöÑapiÈÄöÁî®ÂåÖÔºåÂèØ‰ª•‰ΩøÁî®PaymentÊîØ‰ªòEntity --></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;project.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- SpringBootÊï¥ÂêàWebÁªÑ‰ª∂ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--Êó•Â∏∏ÈÄöÁî®jarÂåÖÈÖçÁΩÆ--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ÊîπYML-4"><a href="#ÊîπYML-4" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h5><p>ËÆ∞Âæó‰øÆÊîπ‰∏çÂêåÁöÑÁ´ØÂè£Âè∑</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9003</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#ÈÖçÁΩÆNacosÂú∞ÂùÄ</span>

<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">'*'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="‰∏ªÂêØÂä®-4"><a href="#‰∏ªÂêØÂä®-4" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h5><h6 id="PaymentMain9003"><a href="#PaymentMain9003" class="headerlink" title="PaymentMain9003"></a>PaymentMain9003</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain9003</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain9003</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="‰∏öÂä°Á±ª-3"><a href="#‰∏öÂä°Á±ª-3" class="headerlink" title="‰∏öÂä°Á±ª"></a>‰∏öÂä°Á±ª</h5><h6 id="PaymentController-1"><a href="#PaymentController-1" class="headerlink" title="PaymentController"></a>PaymentController</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;server.port&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">Payment</span><span class="token punctuation">></span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token string">"28a8c1e3bc2742d8848569891fb42181"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token string">"bba8c1e3bc2742d8848569891ac32182"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> <span class="token string">"6ua8c1e3bc2742d8848569891xt92183"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/paymentSQL/&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"from mysql,serverPort:  "</span> <span class="token operator">+</span> serverPort<span class="token punctuation">,</span> payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ÊµãËØïÂú∞ÂùÄ"><a href="#ÊµãËØïÂú∞ÂùÄ" class="headerlink" title="ÊµãËØïÂú∞ÂùÄ"></a>ÊµãËØïÂú∞ÂùÄ</h5><blockquote>
<p><a target="_blank" rel="noopener" href="http://localhost:9003/paymentSQL/1">http://localhost:9003/paymentSQL/1</a></p>
</blockquote>
<h4 id="Ê∂àË¥πËÄÖ84"><a href="#Ê∂àË¥πËÄÖ84" class="headerlink" title="Ê∂àË¥πËÄÖ84"></a>Ê∂àË¥πËÄÖ84</h4><h5 id="Êñ∞Âª∫cloudalibaba-consumer-nacos-order84"><a href="#Êñ∞Âª∫cloudalibaba-consumer-nacos-order84" class="headerlink" title="Êñ∞Âª∫cloudalibaba-consumer-nacos-order84"></a>Êñ∞Âª∫cloudalibaba-consumer-nacos-order84</h5><h5 id="ÊîπPOM-6"><a href="#ÊîπPOM-6" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h5><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloudalibaba-consumer-nacos-order84<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba sentinel --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- ÂºïÂÖ•Ëá™Â∑±ÂÆö‰πâÁöÑapiÈÄöÁî®ÂåÖÔºåÂèØ‰ª•‰ΩøÁî®PaymentÊîØ‰ªòEntity --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!-- SpringBootÊï¥ÂêàWebÁªÑ‰ª∂ --></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--Êó•Â∏∏ÈÄöÁî®jarÂåÖÈÖçÁΩÆ--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ÊîπYML-5"><a href="#ÊîπYML-5" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h5><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">84</span>


<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>order<span class="token punctuation">-</span>consumer
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
        <span class="token comment">#ÈÖçÁΩÆSentinel dashboardÂú∞ÂùÄ</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span>
        <span class="token comment">#ÈªòËÆ§8719Á´ØÂè£ÔºåÂÅáÂ¶ÇË¢´Âç†Áî®‰ºöËá™Âä®‰ªé8719ÂºÄÂßã‰æùÊ¨°+1Êâ´Êèè,Áõ¥Ëá≥ÊâæÂà∞Êú™Ë¢´Âç†Áî®ÁöÑÁ´ØÂè£</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span>


<span class="token comment">#Ê∂àË¥πËÄÖÂ∞ÜË¶ÅÂéªËÆøÈóÆÁöÑÂæÆÊúçÂä°ÂêçÁß∞(Ê≥®ÂÜåÊàêÂäüËøõnacosÁöÑÂæÆÊúçÂä°Êèê‰æõËÄÖ)</span>
<span class="token key atrule">service-url</span><span class="token punctuation">:</span>
  <span class="token key atrule">nacos-user-service</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="‰∏ªÂêØÂä®-5"><a href="#‰∏ªÂêØÂä®-5" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h5><h6 id="OrderNacosMain84"><a href="#OrderNacosMain84" class="headerlink" title="OrderNacosMain84"></a>OrderNacosMain84</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosMain84</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">OrderNacosMain84</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="‰∏öÂä°Á±ª-4"><a href="#‰∏öÂä°Á±ª-4" class="headerlink" title="‰∏öÂä°Á±ª"></a>‰∏öÂä°Á±ª</h5><h6 id="ApplicationContextConfig"><a href="#ApplicationContextConfig" class="headerlink" title="ApplicationContextConfig"></a>ApplicationContextConfig</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>loadbalancer<span class="token punctuation">.</span></span><span class="token class-name">LoadBalanced</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@LoadBalanced</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="CircleBreakerController"><a href="#CircleBreakerController" class="headerlink" title="CircleBreakerController"></a>CircleBreakerController</h6><p>‰øÆÊîπÂêéËØ∑ÈáçÂêØÂæÆÊúçÂä°</p>
<blockquote>
<p><strong>ÁÉ≠ÈÉ®ÁΩ≤ÂØπjava‰ª£Á†ÅÁ∫ßÁîüÊïàÂèäÊó∂ ÂØπ@SentinelResourceÊ≥®Ëß£ÂÜÖÂ±ûÊÄßÔºåÊúâÊó∂ÊïàÊûú‰∏çÂ•Ω</strong></p>
</blockquote>
<p>ÁõÆÁöÑ</p>
<blockquote>
<p><strong>fallbackÁÆ°ËøêË°åÂºÇÂ∏∏   blockHandlerÁÆ°ÈÖçÁΩÆËøùËßÑ</strong></p>
</blockquote>
<p>ÊµãËØïÂú∞ÂùÄ</p>
<blockquote>
<p><code>http://localhost:84/consumer/fallback/1</code></p>
</blockquote>
<p>CircleBreakerController Ê≤°Êúâ‰ªª‰ΩïÈÖçÁΩÆ</p>
<blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleBreakerController</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SERVICE_URL <span class="token operator">=</span> <span class="token string">"http://nacos-payment-provider"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/fallback/&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"fallback"</span><span class="token punctuation">)</span> <span class="token comment">//Ê≤°ÊúâÈÖçÁΩÆ</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">"/paymentSQL/"</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"IllegalArgumentException,ÈùûÊ≥ïÂèÇÊï∞ÂºÇÂ∏∏...."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">"NullPointerException,ËØ•IDÊ≤°ÊúâÂØπÂ∫îËÆ∞ÂΩï,Á©∫ÊåáÈíàÂºÇÂ∏∏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/4">localhost:84&#x2F;consumer&#x2F;fallback&#x2F;4</a></p>
<p><strong>ÁªôÂÆ¢Êà∑errorÈ°µÈù¢Ôºå‰∏çÂèãÂ•Ω</strong></p>
</blockquote>
<p>Âè™ÈÖçÁΩÆfallback</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleBreakerController</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SERVICE_URL <span class="token operator">=</span> <span class="token string">"http://nacos-payment-provider"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/fallback/&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token comment">//@SentinelResource(value = "fallback") //Ê≤°ÊúâÈÖçÁΩÆ</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"fallback"</span><span class="token punctuation">,</span> fallback <span class="token operator">=</span> <span class="token string">"handlerFallback"</span><span class="token punctuation">)</span> <span class="token comment">//fallbackË¥üË¥£‰∏öÂä°ÂºÇÂ∏∏</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">"/paymentSQL/"</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"IllegalArgumentException,ÈùûÊ≥ïÂèÇÊï∞ÂºÇÂ∏∏...."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">"NullPointerException,ËØ•IDÊ≤°ÊúâÂØπÂ∫îËÆ∞ÂΩï,Á©∫ÊåáÈíàÂºÇÂ∏∏"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

        <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerFallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">"fallback,Êó†Ê≠§ÊµÅÊ∞¥,exception  "</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Êú¨‰æãsentinelÊó†ÈÖçÁΩÆ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali120.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali120.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÁªìÊûú</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali121.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali121.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>Âè™ÈÖçÁΩÆblockHandler</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>slots<span class="token punctuation">.</span>block<span class="token punctuation">.</span></span><span class="token class-name">BlockException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleBreakerController</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SERVICE_URL <span class="token operator">=</span> <span class="token string">"http://nacos-payment-provider"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/fallback/&#123;id&#125;"</span><span class="token punctuation">)</span>
<span class="token comment">//    @SentinelResource(value = "fallback") //Ê≤°ÊúâÈÖçÁΩÆ</span>
<span class="token comment">//    @SentinelResource(value = "fallback", fallback = "handlerFallback") //fallbackË¥üË¥£‰∏öÂä°ÂºÇÂ∏∏</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"fallback"</span><span class="token punctuation">,</span>blockHandler <span class="token operator">=</span> <span class="token string">"blockHandler"</span><span class="token punctuation">)</span> <span class="token comment">//blockHandlerË¥üË¥£Âú®sentinelÈáåÈù¢ÈÖçÁΩÆÁöÑÈôçÁ∫ßÈôêÊµÅ</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">"/paymentSQL/"</span><span class="token operator">+</span>id<span class="token punctuation">,</span><span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span> <span class="token punctuation">(</span><span class="token string">"ÈùûÊ≥ïÂèÇÊï∞ÂºÇÂ∏∏...."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span> <span class="token punctuation">(</span><span class="token string">"NullPointerException,ËØ•IDÊ≤°ÊúâÂØπÂ∫îËÆ∞ÂΩï"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerFallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">"fallback,Êó†Ê≠§ÊµÅÊ∞¥,exception  "</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">blockHandler</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> blockException<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">445</span><span class="token punctuation">,</span><span class="token string">"blockHandler-sentinelÈôêÊµÅ,Êó†Ê≠§ÊµÅÊ∞¥: blockException  "</span><span class="token operator">+</span>blockException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali122.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali122.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>Êú¨‰æãsentinelÈúÄÈÖçÁΩÆ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali123.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali123.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>  <strong>ÂºÇÂ∏∏Ë∂ÖËøá2Ê¨°ÂêéÔºåÊñ≠Ë∑ØÂô®ÊâìÂºÄÔºåÊñ≠ÁîµË∑≥Èó∏ÔºåÁ≥ªÁªüË¢´‰øùÊä§</strong></p>
<p>ÁªìÊûú<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali124.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali124.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>fallbackÂíåblockHandlerÈÉΩÈÖçÁΩÆ</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>slots<span class="token punctuation">.</span>block<span class="token punctuation">.</span></span><span class="token class-name">BlockException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleBreakerController</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SERVICE_URL <span class="token operator">=</span> <span class="token string">"http://nacos-payment-provider"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/fallback/&#123;id&#125;"</span><span class="token punctuation">)</span>
<span class="token comment">//    @SentinelResource(value = "fallback") //Ê≤°ÊúâÈÖçÁΩÆ</span>
<span class="token comment">//    @SentinelResource(value = "fallback", fallback = "handlerFallback") //fallbackË¥üË¥£‰∏öÂä°ÂºÇÂ∏∏</span>
<span class="token comment">//    @SentinelResource(value = "fallback",blockHandler = "blockHandler") //blockHandlerË¥üË¥£Âú®sentinelÈáåÈù¢ÈÖçÁΩÆÁöÑÈôçÁ∫ßÈôêÊµÅ</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"fallback"</span><span class="token punctuation">,</span>fallback <span class="token operator">=</span> <span class="token string">"handlerFallback"</span><span class="token punctuation">,</span>blockHandler <span class="token operator">=</span> <span class="token string">"blockHandler"</span><span class="token punctuation">)</span> <span class="token comment">//ÈÉΩÈÖçÁΩÆ</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">"/paymentSQL/"</span><span class="token operator">+</span>id<span class="token punctuation">,</span><span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span> <span class="token punctuation">(</span><span class="token string">"ÈùûÊ≥ïÂèÇÊï∞ÂºÇÂ∏∏...."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span> <span class="token punctuation">(</span><span class="token string">"NullPointerException,ËØ•IDÊ≤°ÊúâÂØπÂ∫îËÆ∞ÂΩï"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerFallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">"fallback,Êó†Ê≠§ÊµÅÊ∞¥,exception  "</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">blockHandler</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> blockException<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">445</span><span class="token punctuation">,</span><span class="token string">"blockHandler-sentinelÈôêÊµÅ,Êó†Ê≠§ÊµÅÊ∞¥: blockException  "</span><span class="token operator">+</span>blockException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali125.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali125.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>Êú¨‰æãsentinelÈúÄÈÖçÁΩÆ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali126.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali126.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÁªìÊûú <img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali127.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali127.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>Ëã• blockHandler Âíå fallback ÈÉΩËøõË°å‰∫ÜÈÖçÁΩÆÔºåÂàôË¢´ÈôêÊµÅÈôçÁ∫ßËÄåÊäõÂá∫ BlockException Êó∂Âè™‰ºöËøõÂÖ• blockHandler Â§ÑÁêÜÈÄªËæë„ÄÇ</strong></p>
<p>ÂøΩÁï•Â±ûÊÄß‚Ä¶‚Ä¶.</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>slots<span class="token punctuation">.</span>block<span class="token punctuation">.</span></span><span class="token class-name">BlockException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleBreakerController</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SERVICE_URL <span class="token operator">=</span> <span class="token string">"http://nacos-payment-provider"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/consumer/fallback/&#123;id&#125;"</span><span class="token punctuation">)</span>
<span class="token comment">//    @SentinelResource(value = "fallback") //Ê≤°ÊúâÈÖçÁΩÆ</span>
<span class="token comment">//    @SentinelResource(value = "fallback", fallback = "handlerFallback") //fallbackË¥üË¥£‰∏öÂä°ÂºÇÂ∏∏</span>
<span class="token comment">//    @SentinelResource(value = "fallback",blockHandler = "blockHandler") //blockHandlerË¥üË¥£Âú®sentinelÈáåÈù¢ÈÖçÁΩÆÁöÑÈôçÁ∫ßÈôêÊµÅ</span>
<span class="token comment">//    @SentinelResource(value = "fallback",fallback = "handlerFallback",blockHandler = "blockHandler") //ÈÉΩÈÖçÁΩÆ</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"fallback"</span><span class="token punctuation">,</span> fallback <span class="token operator">=</span> <span class="token string">"handlerFallback"</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">"blockHandler"</span><span class="token punctuation">,</span>exceptionsToIgnore <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">IllegalArgumentException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">//ÂøΩÁï•Â±ûÊÄß</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">"/paymentSQL/"</span><span class="token operator">+</span>id<span class="token punctuation">,</span><span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span> <span class="token punctuation">(</span><span class="token string">"ÈùûÊ≥ïÂèÇÊï∞ÂºÇÂ∏∏...."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span> <span class="token punctuation">(</span><span class="token string">"NullPointerException,ËØ•IDÊ≤°ÊúâÂØπÂ∫îËÆ∞ÂΩï"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerFallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">"fallback,Êó†Ê≠§ÊµÅÊ∞¥,exception  "</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">blockHandler</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> blockException<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">445</span><span class="token punctuation">,</span><span class="token string">"blockHandler-sentinelÈôêÊµÅ,Êó†Ê≠§ÊµÅÊ∞¥: blockException  "</span><span class="token operator">+</span>blockException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali128.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali128.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>Êú¨‰æãsentinelÊó†ÈÖçÁΩÆ</p>
<p>ÁªìÊûú<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali129.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali129.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>Á®ãÂ∫èÂºÇÂ∏∏ÊâìÂà∞ÂâçÂè∞‰∫ÜÔºåÂØπÁî®Êà∑‰∏çÂèãÂ•Ω</strong></p>
<h3 id="FeignÁ≥ªÂàó"><a href="#FeignÁ≥ªÂàó" class="headerlink" title="FeignÁ≥ªÂàó"></a>FeignÁ≥ªÂàó</h3><h4 id="‰øÆÊîπ84Ê®°Âùó"><a href="#‰øÆÊîπ84Ê®°Âùó" class="headerlink" title="‰øÆÊîπ84Ê®°Âùó"></a>‰øÆÊîπ84Ê®°Âùó</h4><ul>
<li>84Ê∂àË¥πËÄÖË∞ÉÁî®Êèê‰æõËÄÖ9003</li>
<li>FeignÁªÑ‰ª∂‰∏ÄËà¨ÊòØÊ∂àË¥π‰æß</li>
</ul>
<h4 id="ÊîπPOM-7"><a href="#ÊîπPOM-7" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!--SpringCloud openfeign --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ÊîπYML-6"><a href="#ÊîπYML-6" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><h5 id="ÊøÄÊ¥ªSentinelÂØπFeignÁöÑÊîØÊåÅ"><a href="#ÊøÄÊ¥ªSentinelÂØπFeignÁöÑÊîØÊåÅ" class="headerlink" title="ÊøÄÊ¥ªSentinelÂØπFeignÁöÑÊîØÊåÅ"></a>ÊøÄÊ¥ªSentinelÂØπFeignÁöÑÊîØÊåÅ</h5><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># ÊøÄÊ¥ªSentinelÂØπFeignÁöÑÊîØÊåÅ</span>
<span class="token key atrule">feign</span><span class="token punctuation">:</span>
  <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="‰∏öÂä°Á±ª-5"><a href="#‰∏öÂä°Á±ª-5" class="headerlink" title="‰∏öÂä°Á±ª"></a>‰∏öÂä°Á±ª</h4><h5 id="PaymentService-Â∏¶-FeignClientÊ≥®Ëß£ÁöÑ‰∏öÂä°Êé•Âè£"><a href="#PaymentService-Â∏¶-FeignClientÊ≥®Ëß£ÁöÑ‰∏öÂä°Êé•Âè£" class="headerlink" title="PaymentService Â∏¶@FeignClientÊ≥®Ëß£ÁöÑ‰∏öÂä°Êé•Âè£"></a>PaymentService Â∏¶@FeignClientÊ≥®Ëß£ÁöÑ‰∏öÂä°Êé•Âè£</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">FeignClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * ‰ΩøÁî® fallback ÊñπÂºèÊòØÊó†Ê≥ïËé∑ÂèñÂºÇÂ∏∏‰ø°ÊÅØÁöÑÔºå
 * Â¶ÇÊûúÊÉ≥Ë¶ÅËé∑ÂèñÂºÇÂ∏∏‰ø°ÊÅØÔºåÂèØ‰ª•‰ΩøÁî® fallbackFactoryÂèÇÊï∞
 */</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"nacos-payment-provider"</span><span class="token punctuation">,</span> fallback <span class="token operator">=</span> <span class="token class-name">PaymentFallbackService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//Ë∞ÉÁî®‰∏≠ÂÖ≥Èó≠9003ÊúçÂä°Êèê‰æõËÄÖ</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PaymentService</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/paymentSQL/&#123;id&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="fallback-x3D-PaymentFallbackService-class"><a href="#fallback-x3D-PaymentFallbackService-class" class="headerlink" title="fallback &#x3D; PaymentFallbackService.class"></a>fallback &#x3D; PaymentFallbackService.class</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentFallbackService</span> <span class="token keyword">implements</span> <span class="token class-name">PaymentService</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span> <span class="token string">"ÊúçÂä°ÈôçÁ∫ßËøîÂõû,Ê≤°ÊúâËØ•ÊµÅÊ∞¥‰ø°ÊÅØ"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token string">"errorSerial......"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="CircleBreakerController-1"><a href="#CircleBreakerController-1" class="headerlink" title="CircleBreakerController"></a>CircleBreakerController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//==================OpenFeign</span>
   <span class="token annotation punctuation">@Resource</span>
   <span class="token keyword">private</span> <span class="token class-name">PaymentService</span> paymentService<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/consumer/paymentSQL/&#123;id&#125;"</span><span class="token punctuation">)</span>
   <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">></span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
           <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"Ê≤°ÊúâËØ•id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span>
       <span class="token keyword">return</span> paymentService<span class="token punctuation">.</span><span class="token function">paymentSQL</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏ªÂêØÂä®-6"><a href="#‰∏ªÂêØÂä®-6" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableFeignClients</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosMain84</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">OrderNacosMain84</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="Ê∑ªÂä†-EnableFeignClientsÂêØÂä®FeignÁöÑÂäüËÉΩ"><a href="#Ê∑ªÂä†-EnableFeignClientsÂêØÂä®FeignÁöÑÂäüËÉΩ" class="headerlink" title="Ê∑ªÂä†@EnableFeignClientsÂêØÂä®FeignÁöÑÂäüËÉΩ"></a>Ê∑ªÂä†@EnableFeignClientsÂêØÂä®FeignÁöÑÂäüËÉΩ</h5><blockquote>
<p><code>http://localhost:84/consumer/paymentSQL/1</code></p>
</blockquote>
<p><strong>ÊµãËØï84Ë∞ÉÁî®9003 9004ÔºåÊ≠§Êó∂ÊïÖÊÑèÂÖ≥Èó≠9003 9004ÂæÆÊúçÂä°Êèê‰æõËÄÖÔºåÁúã84Ê∂àË¥π‰æßËá™Âä®ÈôçÁ∫ßÔºå‰∏ç‰ºöË¢´ËÄóÊ≠ª</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali130.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali130.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="ÁÜîÊñ≠Ê°ÜÊû∂ÊØîËæÉ"><a href="#ÁÜîÊñ≠Ê°ÜÊû∂ÊØîËæÉ" class="headerlink" title="ÁÜîÊñ≠Ê°ÜÊû∂ÊØîËæÉ"></a>ÁÜîÊñ≠Ê°ÜÊû∂ÊØîËæÉ</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali131.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali131.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h2 id="ËßÑÂàôÊåÅ‰πÖÂåñ"><a href="#ËßÑÂàôÊåÅ‰πÖÂåñ" class="headerlink" title="ËßÑÂàôÊåÅ‰πÖÂåñ"></a>ËßÑÂàôÊåÅ‰πÖÂåñ</h2><h3 id="ÊòØ‰ªÄ‰πà-8"><a href="#ÊòØ‰ªÄ‰πà-8" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h3><blockquote>
<p> <strong>‰∏ÄÊó¶Êàë‰ª¨ÈáçÂêØÂ∫îÁî®ÔºåsentinelËßÑÂàôÂ∞ÜÊ∂àÂ§±ÔºåÁîü‰∫ßÁéØÂ¢ÉÈúÄË¶ÅÂ∞ÜÈÖçÁΩÆËßÑÂàôËøõË°åÊåÅ‰πÖÂåñ</strong></p>
</blockquote>
<h3 id="ÊÄé‰πàÁé©-2"><a href="#ÊÄé‰πàÁé©-2" class="headerlink" title="ÊÄé‰πàÁé©"></a>ÊÄé‰πàÁé©</h3><blockquote>
<p><strong>Â∞ÜÈôêÊµÅÈÖçÁΩÆËßÑÂàôÊåÅ‰πÖÂåñËøõNacos‰øùÂ≠òÔºåÂè™Ë¶ÅÂà∑Êñ∞8401Êüê‰∏™restÂú∞ÂùÄÔºåsentinelÊéßÂà∂Âè∞</strong><br><strong>ÁöÑÊµÅÊéßËßÑÂàôÂ∞±ËÉΩÁúãÂà∞ÔºåÂè™Ë¶ÅNacosÈáåÈù¢ÁöÑÈÖçÁΩÆ‰∏çÂà†Èô§ÔºåÈíàÂØπ8401‰∏äsentinel‰∏äÁöÑÊµÅÊéßËßÑÂàôÊåÅÁª≠ÊúâÊïà</strong></p>
</blockquote>
<h3 id="Ê≠•È™§"><a href="#Ê≠•È™§" class="headerlink" title="Ê≠•È™§"></a>Ê≠•È™§</h3><h4 id="‰øÆÊîπcloudalibaba-sentinel-service8401"><a href="#‰øÆÊîπcloudalibaba-sentinel-service8401" class="headerlink" title="‰øÆÊîπcloudalibaba-sentinel-service8401"></a>‰øÆÊîπcloudalibaba-sentinel-service8401</h4><h4 id="ÊîπPOM-8"><a href="#ÊîπPOM-8" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!--SpringCloud ailibaba sentinel-datasource-nacos --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>sentinel-datasource-nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ÊîπYML-7"><a href="#ÊîπYML-7" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><p><strong>Ê∑ªÂä†NacosÊï∞ÊçÆÊ∫êÈÖçÁΩÆ</strong></p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
        <span class="token key atrule">ds1</span><span class="token punctuation">:</span>
          <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
            <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
            <span class="token key atrule">dataId</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span>spring.application.name<span class="token punctuation">&#125;</span>
            <span class="token key atrule">groupId</span><span class="token punctuation">:</span> DEFAULT_GROUP
            <span class="token key atrule">data-type</span><span class="token punctuation">:</span> json
            <span class="token key atrule">rule-type</span><span class="token punctuation">:</span> flow
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="Ê∑ªÂä†Nacos‰∏öÂä°ËßÑÂàôÈÖçÁΩÆ"><a href="#Ê∑ªÂä†Nacos‰∏öÂä°ËßÑÂàôÈÖçÁΩÆ" class="headerlink" title="Ê∑ªÂä†Nacos‰∏öÂä°ËßÑÂàôÈÖçÁΩÆ"></a>Ê∑ªÂä†Nacos‰∏öÂä°ËßÑÂàôÈÖçÁΩÆ</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali132.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali132.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h5 id="ÂÜÖÂÆπËß£Êûê"><a href="#ÂÜÖÂÆπËß£Êûê" class="headerlink" title="ÂÜÖÂÆπËß£Êûê"></a>ÂÜÖÂÆπËß£Êûê</h5><pre class="line-numbers language-json" data-language="json"><code class="language-json"> 
<span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
        <span class="token property">"resource"</span><span class="token operator">:</span> <span class="token string">"/rateLimit/byUrl"</span><span class="token punctuation">,</span>
        <span class="token property">"limitApp"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
        <span class="token property">"grade"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"count"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">"strategy"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"controlBehavior"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"clusterMode"</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span>

 
resourceÔºöËµÑÊ∫êÂêçÁß∞Ôºõ
limitAppÔºöÊù•Ê∫êÂ∫îÁî®Ôºõ
gradeÔºöÈòàÂÄºÁ±ªÂûãÔºå<span class="token number">0</span>Ë°®Á§∫Á∫øÁ®ãÊï∞Ôºå<span class="token number">1</span>Ë°®Á§∫QPSÔºõ
countÔºöÂçïÊú∫ÈòàÂÄºÔºõ
strategyÔºöÊµÅÊéßÊ®°ÂºèÔºå<span class="token number">0</span>Ë°®Á§∫Áõ¥Êé•Ôºå<span class="token number">1</span>Ë°®Á§∫ÂÖ≥ËÅîÔºå<span class="token number">2</span>Ë°®Á§∫ÈìæË∑ØÔºõ
controlBehaviorÔºöÊµÅÊéßÊïàÊûúÔºå<span class="token number">0</span>Ë°®Á§∫Âø´ÈÄüÂ§±Ë¥•Ôºå<span class="token number">1</span>Ë°®Á§∫Warm UpÔºå<span class="token number">2</span>Ë°®Á§∫ÊéíÈòüÁ≠âÂæÖÔºõ
clusterModeÔºöÊòØÂê¶ÈõÜÁæ§„ÄÇ
 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ÂêØÂä®8401ÂêéÂà∑Êñ∞sentinelÂèëÁé∞‰∏öÂä°ËßÑÂàôÊúâ‰∫Ü"><a href="#ÂêØÂä®8401ÂêéÂà∑Êñ∞sentinelÂèëÁé∞‰∏öÂä°ËßÑÂàôÊúâ‰∫Ü" class="headerlink" title="ÂêØÂä®8401ÂêéÂà∑Êñ∞sentinelÂèëÁé∞‰∏öÂä°ËßÑÂàôÊúâ‰∫Ü"></a>ÂêØÂä®8401ÂêéÂà∑Êñ∞sentinelÂèëÁé∞‰∏öÂä°ËßÑÂàôÊúâ‰∫Ü</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali133.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali133.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="Âø´ÈÄüËÆøÈóÆÊµãËØïÊé•Âè£"><a href="#Âø´ÈÄüËÆøÈóÆÊµãËØïÊé•Âè£" class="headerlink" title="Âø´ÈÄüËÆøÈóÆÊµãËØïÊé•Âè£"></a>Âø´ÈÄüËÆøÈóÆÊµãËØïÊé•Âè£</h4><p><a target="_blank" rel="noopener" href="http://localhost:8401/rateLimit/byUrl">http://localhost:8401/rateLimit/byUrl</a>  ÈªòËÆ§<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali134.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali134.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÂÅúÊ≠¢8401ÂÜçÁúãsentinel"><a href="#ÂÅúÊ≠¢8401ÂÜçÁúãsentinel" class="headerlink" title="ÂÅúÊ≠¢8401ÂÜçÁúãsentinel"></a>ÂÅúÊ≠¢8401ÂÜçÁúãsentinel</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali135.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali135.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÈáçÊñ∞ÂêØÂä®8401ÂÜçÁúãsentinel"><a href="#ÈáçÊñ∞ÂêØÂä®8401ÂÜçÁúãsentinel" class="headerlink" title="ÈáçÊñ∞ÂêØÂä®8401ÂÜçÁúãsentinel"></a>ÈáçÊñ∞ÂêØÂä®8401ÂÜçÁúãsentinel</h4><ul>
<li>‰πç‰∏ÄÁúãËøòÊòØÊ≤°ÊúâÔºåÁ®çÁ≠â‰∏Ä‰ºöÂÑø</li>
<li>Â§öÊ¨°Ë∞ÉÁî® <a target="_blank" rel="noopener" href="http://localhost:8401/rateLimit/byUrl">http://localhost:8401/rateLimit/byUrl</a></li>
<li>ÈáçÊñ∞ÈÖçÁΩÆÂá∫Áé∞‰∫ÜÔºåÊåÅ‰πÖÂåñÈ™åËØÅÈÄöËøá</li>
</ul>
<h1 id="SpringCloud-Alibaba-SeataÂ§ÑÁêÜÂàÜÂ∏ÉÂºè‰∫ãÂä°"><a href="#SpringCloud-Alibaba-SeataÂ§ÑÁêÜÂàÜÂ∏ÉÂºè‰∫ãÂä°" class="headerlink" title="SpringCloud Alibaba SeataÂ§ÑÁêÜÂàÜÂ∏ÉÂºè‰∫ãÂä°"></a>SpringCloud Alibaba SeataÂ§ÑÁêÜÂàÜÂ∏ÉÂºè‰∫ãÂä°</h1><h2 id="ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈóÆÈ¢ò"><a href="#ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈóÆÈ¢ò" class="headerlink" title="ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈóÆÈ¢ò"></a>ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈóÆÈ¢ò</h2><h3 id="ÂàÜÂ∏ÉÂºèÂâç"><a href="#ÂàÜÂ∏ÉÂºèÂâç" class="headerlink" title="ÂàÜÂ∏ÉÂºèÂâç"></a>ÂàÜÂ∏ÉÂºèÂâç</h3><blockquote>
<p>ÂçïÊú∫ÂçïÂ∫ìÊ≤°Ëøô‰∏™ÈóÆÈ¢ò  O(‚à©_‚à©)O</p>
<p>‰ªé1Ôºö1  -&gt;  1ÔºöN  -&gt;  NÔºöN</p>
</blockquote>
<h3 id="ÂàÜÂ∏ÉÂºè‰πãÂêé"><a href="#ÂàÜÂ∏ÉÂºè‰πãÂêé" class="headerlink" title="ÂàÜÂ∏ÉÂºè‰πãÂêé"></a>ÂàÜÂ∏ÉÂºè‰πãÂêé</h3><blockquote>
<p>Âçï‰ΩìÂ∫îÁî®Ë¢´ÊãÜÂàÜÊàêÂæÆÊúçÂä°Â∫îÁî®ÔºåÂéüÊù•ÁöÑ‰∏â‰∏™Ê®°ÂùóË¢´ÊãÜÂàÜÊàê<strong>‰∏â‰∏™Áã¨Á´ãÁöÑÂ∫îÁî®</strong>ÔºåÂàÜÂà´‰ΩøÁî®<strong>‰∏â‰∏™Áã¨Á´ãÁöÑÊï∞ÊçÆÊ∫ê</strong>Ôºå<br>‰∏öÂä°Êìç‰ΩúÈúÄË¶ÅË∞ÉÁî®‰∏â‰∏™ÊúçÂä°Êù•ÂÆåÊàê„ÄÇÊ≠§Êó∂<strong>ÊØè‰∏™ÊúçÂä°ÂÜÖÈÉ®ÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÁî±Êú¨Âú∞‰∫ãÂä°Êù•‰øùËØÅÔºå‰ΩÜÊòØÂÖ®Â±ÄÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÈóÆÈ¢òÊ≤°Ê≥ï‰øùËØÅ</strong>„ÄÇ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali136.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali136.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="‰∏ÄÂè•ËØù"><a href="#‰∏ÄÂè•ËØù" class="headerlink" title="‰∏ÄÂè•ËØù"></a>‰∏ÄÂè•ËØù</h3><blockquote>
<p><strong>‰∏ÄÊ¨°‰∏öÂä°Êìç‰ΩúÈúÄË¶ÅË∑®Â§ö‰∏™Êï∞ÊçÆÊ∫êÊàñÈúÄË¶ÅË∑®Â§ö‰∏™Á≥ªÁªüËøõË°åËøúÁ®ãË∞ÉÁî®ÔºåÂ∞±‰ºö‰∫ßÁîüÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈóÆÈ¢ò</strong></p>
</blockquote>
<h2 id="SeataÁÆÄ‰ªã"><a href="#SeataÁÆÄ‰ªã" class="headerlink" title="SeataÁÆÄ‰ªã"></a>SeataÁÆÄ‰ªã</h2><h3 id="ÊòØ‰ªÄ‰πà-9"><a href="#ÊòØ‰ªÄ‰πà-9" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h3><blockquote>
<p>SeataÊòØ‰∏ÄÊ¨æÂºÄÊ∫êÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°àÔºåËá¥Âäõ‰∫éÂú®ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏ãÊèê‰æõÈ´òÊÄßËÉΩÂíåÁÆÄÂçïÊòìÁî®ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ÊúçÂä°„ÄÇ</p>
<p>ÂÆòÁΩëÂú∞ÂùÄ  <a target="_blank" rel="noopener" href="http://seata.io/zh-cn/">http://seata.io/zh-cn/</a></p>
</blockquote>
<h3 id="ËÉΩÂπ≤Âòõ-3"><a href="#ËÉΩÂπ≤Âòõ-3" class="headerlink" title="ËÉΩÂπ≤Âòõ"></a>ËÉΩÂπ≤Âòõ</h3><blockquote>
<p>‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ËøáÁ®ã</p>
<p>‚Äã	ÂàÜÂ∏ÉÂºè‰∫ãÂä°Â§ÑÁêÜËøáÁ®ãÁöÑ‰∏ÄID+‰∏âÁªÑ‰ª∂Ê®°Âûã</p>
<p>‚Äã		Transaction ID XID   ÂÖ®Â±ÄÂîØ‰∏ÄÁöÑ‰∫ãÂä°ID</p>
<p>‚Äã		3ÁªÑ‰ª∂Ê¶ÇÂøµ</p>
<table>
<thead>
<tr>
<th>Transaction Coordinator (TC)</th>
<th>‰∫ãÂä°ÂçèË∞ÉÂô®ÔºåÁª¥Êä§ÂÖ®Â±Ä‰∫ãÂä°ÁöÑËøêË°åÁä∂ÊÄÅÔºåË¥üË¥£ÂçèË∞ÉÂπ∂È©±Âä®ÂÖ®Â±Ä‰∫ãÂä°ÁöÑÊèê‰∫§ÊàñÂõûÊªöÔºõ</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Transaction Manager (TM)</strong></td>
<td><strong>ÊéßÂà∂ÂÖ®Â±Ä‰∫ãÂä°ÁöÑËæπÁïåÔºåË¥üË¥£ÂºÄÂêØ‰∏Ä‰∏™ÂÖ®Â±Ä‰∫ãÂä°ÔºåÂπ∂ÊúÄÁªàÂèëËµ∑ÂÖ®Â±ÄÊèê‰∫§ÊàñÂÖ®Â±ÄÂõûÊªöÁöÑÂÜ≥ËÆÆÔºõ</strong></td>
</tr>
<tr>
<td><strong>Resource Manager (RM)</strong></td>
<td><strong>ÊéßÂà∂ÂàÜÊîØ‰∫ãÂä°ÔºåË¥üË¥£ÂàÜÊîØÊ≥®ÂÜå„ÄÅÁä∂ÊÄÅÊ±áÊä•ÔºåÂπ∂Êé•Êî∂‰∫ãÂä°ÂçèË∞ÉÂô®ÁöÑÊåá‰ª§ÔºåÈ©±Âä®ÂàÜÊîØÔºàÊú¨Âú∞Ôºâ‰∫ãÂä°ÁöÑÊèê‰∫§ÂíåÂõûÊªö</strong></td>
</tr>
</tbody></table>
<p>‚Äã	Â§ÑÁêÜËøáÁ®ã</p>
<blockquote>
<p><strong>1„ÄÅTM Âêë TC Áî≥ËØ∑ÂºÄÂêØ‰∏Ä‰∏™ÂÖ®Â±Ä‰∫ãÂä°ÔºåÂÖ®Â±Ä‰∫ãÂä°ÂàõÂª∫ÊàêÂäüÂπ∂ÁîüÊàê‰∏Ä‰∏™ÂÖ®Â±ÄÂîØ‰∏ÄÁöÑ XIDÔºõ</strong><br><strong>2„ÄÅXID Âú®ÂæÆÊúçÂä°Ë∞ÉÁî®ÈìæË∑ØÁöÑ‰∏ä‰∏ãÊñá‰∏≠‰º†Êí≠Ôºõ</strong><br><strong>3„ÄÅRM Âêë TC Ê≥®ÂÜåÂàÜÊîØ‰∫ãÂä°ÔºåÂ∞ÜÂÖ∂Á∫≥ÂÖ• XID ÂØπÂ∫îÂÖ®Â±Ä‰∫ãÂä°ÁöÑÁÆ°ËæñÔºõ</strong><br><strong>4„ÄÅTM Âêë TC ÂèëËµ∑ÈíàÂØπ XID ÁöÑÂÖ®Â±ÄÊèê‰∫§ÊàñÂõûÊªöÂÜ≥ËÆÆÔºõ</strong><br><strong>5„ÄÅTC Ë∞ÉÂ∫¶ XID ‰∏ãÁÆ°ËæñÁöÑÂÖ®ÈÉ®ÂàÜÊîØ‰∫ãÂä°ÂÆåÊàêÊèê‰∫§ÊàñÂõûÊªöËØ∑Ê±Ç„ÄÇ</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali137.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali137.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
</blockquote>
<h3 id="ÂéªÂì™‰∏ã-3"><a href="#ÂéªÂì™‰∏ã-3" class="headerlink" title="ÂéªÂì™‰∏ã"></a>ÂéªÂì™‰∏ã</h3><blockquote>
<p>ÂèëÂ∏ÉËØ¥Êòé: <a target="_blank" rel="noopener" href="https://github.com/seata/seata/releases">https://github.com/seata/seata/releases</a></p>
</blockquote>
<h3 id="ÊÄé‰πàÁé©-3"><a href="#ÊÄé‰πàÁé©-3" class="headerlink" title="ÊÄé‰πàÁé©"></a>ÊÄé‰πàÁé©</h3><blockquote>
<p>Êú¨Âú∞@Transactional</p>
<p>ÂÖ®Â±Ä@GlobalTransactional  SEATA ÁöÑÂàÜÂ∏ÉÂºè‰∫§ÊòìËß£ÂÜ≥ÊñπÊ°à<img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali138.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali138.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h2 id="Seata-ServerÂÆâË£Ö"><a href="#Seata-ServerÂÆâË£Ö" class="headerlink" title="Seata-ServerÂÆâË£Ö"></a>Seata-ServerÂÆâË£Ö</h2><h3 id="ÂÆòÁΩëÂú∞ÂùÄ"><a href="#ÂÆòÁΩëÂú∞ÂùÄ" class="headerlink" title="ÂÆòÁΩëÂú∞ÂùÄ"></a>ÂÆòÁΩëÂú∞ÂùÄ</h3><blockquote>
<p><a target="_blank" rel="noopener" href="http://seata.io/zh-cn/">http://seata.io/zh-cn/</a></p>
</blockquote>
<h3 id="‰∏ãËΩΩÁâàÊú¨"><a href="#‰∏ãËΩΩÁâàÊú¨" class="headerlink" title="‰∏ãËΩΩÁâàÊú¨"></a>‰∏ãËΩΩÁâàÊú¨</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/seata/seata/releases">https://github.com/seata/seata/releases</a></p>
<p>‰∏ãËΩΩÁöÑÊòØseata-server-0.9.0.zip</p>
<p>Êú¨Ê¨°Êà™Ê≠¢2020.2Êúà‰ªΩÂêéÁª≠ÊòØÂê¶ÂçáÁ∫ßËá™Â∑±ÂÜ≥ÂÆö</p>
</blockquote>
<h3 id="seata-server-0-9-0-zipËß£ÂéãÂà∞ÊåáÂÆöÁõÆÂΩïÂπ∂‰øÆÊîπconfÁõÆÂΩï‰∏ãÁöÑfile-confÈÖçÁΩÆÊñá‰ª∂"><a href="#seata-server-0-9-0-zipËß£ÂéãÂà∞ÊåáÂÆöÁõÆÂΩïÂπ∂‰øÆÊîπconfÁõÆÂΩï‰∏ãÁöÑfile-confÈÖçÁΩÆÊñá‰ª∂" class="headerlink" title="seata-server-0.9.0.zipËß£ÂéãÂà∞ÊåáÂÆöÁõÆÂΩïÂπ∂‰øÆÊîπconfÁõÆÂΩï‰∏ãÁöÑfile.confÈÖçÁΩÆÊñá‰ª∂"></a>seata-server-0.9.0.zipËß£ÂéãÂà∞ÊåáÂÆöÁõÆÂΩïÂπ∂‰øÆÊîπconfÁõÆÂΩï‰∏ãÁöÑfile.confÈÖçÁΩÆÊñá‰ª∂</h3><blockquote>
<p>ÂÖàÂ§á‰ªΩÂéüÂßãfile.confÊñá‰ª∂</p>
<p><strong>‰∏ªË¶Å‰øÆÊîπÔºöËá™ÂÆö‰πâ‰∫ãÂä°ÁªÑÂêçÁß∞+‰∫ãÂä°Êó•ÂøóÂ≠òÂÇ®Ê®°Âºè‰∏∫db+Êï∞ÊçÆÂ∫ìËøûÊé•‰ø°ÊÅØ</strong></p>
<p>file.conf</p>
<p>‚Äã	serviceÊ®°Âùó</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">service <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">vgroup</span><span class="token expression"><span class="token operator">-></span>rgroup</span></span>
  vgroup_mapping<span class="token punctuation">.</span>my_test_tx_group <span class="token operator">=</span> <span class="token string">"fsp_tx_group"</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">only</span> <span class="token expression">support single node</span></span>
  <span class="token keyword">default</span><span class="token punctuation">.</span>grouplist <span class="token operator">=</span> <span class="token string">"127.0.0.1:8091"</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">degrade</span> <span class="token expression">current not support</span></span>
  enableDegrade <span class="token operator">=</span> false
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">disable</span></span>
  disable <span class="token operator">=</span> false
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">unit</span> <span class="token expression">ms<span class="token punctuation">,</span>s<span class="token punctuation">,</span>m<span class="token punctuation">,</span>h<span class="token punctuation">,</span>d represents milliseconds<span class="token punctuation">,</span> seconds<span class="token punctuation">,</span> minutes<span class="token punctuation">,</span> hours<span class="token punctuation">,</span> days<span class="token punctuation">,</span> <span class="token keyword">default</span> permanent</span></span>
  max<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token string">"-1"</span>
  max<span class="token punctuation">.</span>rollback<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token string">"-1"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>‚Äã	storeÊ®°Âùó</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">## transaction log store
store <span class="token punctuation">&#123;</span>
  ## store mode<span class="token operator">:</span> file„ÄÅdb
  mode <span class="token operator">=</span> <span class="token string">"db"</span>

  ## file store
  file <span class="token punctuation">&#123;</span>
    dir <span class="token operator">=</span> <span class="token string">"sessionStore"</span>

    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">branch</span> <span class="token expression">session size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded first try compress lockkey<span class="token punctuation">,</span> still exceeded throws exceptions</span></span>
    max<span class="token operator">-</span>branch<span class="token operator">-</span>session<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">16384</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">globe</span> <span class="token expression">session size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded throws exceptions</span></span>
    max<span class="token operator">-</span>global<span class="token operator">-</span>session<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">512</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span> <span class="token expression">buffer size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded allocate new buffer</span></span>
    file<span class="token operator">-</span>write<span class="token operator">-</span>buffer<span class="token operator">-</span>cache<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">16384</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">when</span> <span class="token expression">recover batch read size</span></span>
    session<span class="token punctuation">.</span>reload<span class="token punctuation">.</span>read_size <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">async</span><span class="token expression"><span class="token punctuation">,</span> sync</span></span>
    flush<span class="token operator">-</span>disk<span class="token operator">-</span>mode <span class="token operator">=</span> async
  <span class="token punctuation">&#125;</span>

  ## database store
  db <span class="token punctuation">&#123;</span>
    ## the implement of javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DataSource<span class="token punctuation">,</span> such as <span class="token function">DruidDataSource</span><span class="token punctuation">(</span>druid<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">BasicDataSource</span><span class="token punctuation">(</span>dbcp<span class="token punctuation">)</span> etc<span class="token punctuation">.</span>
    datasource <span class="token operator">=</span> <span class="token string">"dbcp"</span>
    ## mysql<span class="token operator">/</span>oracle<span class="token operator">/</span>h2<span class="token operator">/</span>oceanbase etc<span class="token punctuation">.</span>
    db<span class="token operator">-</span>type <span class="token operator">=</span> <span class="token string">"mysql"</span>
    driver<span class="token operator">-</span>class<span class="token operator">-</span>name <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span>
    url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://127.0.0.1:3306/seata"</span>
    user <span class="token operator">=</span> <span class="token string">"root"</span>
    password <span class="token operator">=</span> <span class="token string">"142857"</span>
    min<span class="token operator">-</span>conn <span class="token operator">=</span> <span class="token number">1</span>
    max<span class="token operator">-</span>conn <span class="token operator">=</span> <span class="token number">3</span>
    global<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"global_table"</span>
    branch<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"branch_table"</span>
    lock<span class="token operator">-</span>table <span class="token operator">=</span> <span class="token string">"lock_table"</span>
    query<span class="token operator">-</span>limit <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</blockquote>
<h3 id="mysql5-7Êï∞ÊçÆÂ∫ìÊñ∞Âª∫Â∫ìseata"><a href="#mysql5-7Êï∞ÊçÆÂ∫ìÊñ∞Âª∫Â∫ìseata" class="headerlink" title="mysql5.7Êï∞ÊçÆÂ∫ìÊñ∞Âª∫Â∫ìseata"></a>mysql5.7Êï∞ÊçÆÂ∫ìÊñ∞Âª∫Â∫ìseata</h3><h3 id="Âú®seataÂ∫ìÈáåÂª∫Ë°®"><a href="#Âú®seataÂ∫ìÈáåÂª∫Ë°®" class="headerlink" title="Âú®seataÂ∫ìÈáåÂª∫Ë°®"></a>Âú®seataÂ∫ìÈáåÂª∫Ë°®</h3><blockquote>
<p><strong>Âª∫Ë°®db_store.sqlÂú®\seata-server-0.9.0\seata\confÁõÆÂΩïÈáåÈù¢   db_store.sql</strong></p>
<p>SQL </p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- the table to store GlobalSession data</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> <span class="token identifier"><span class="token punctuation">`</span>global_table<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>global_table<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>  <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>transaction_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>application_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>transaction_service_group<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>transaction_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>timeout<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>begin_time<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>application_data<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">key</span> <span class="token identifier"><span class="token punctuation">`</span>idx_gmt_modified_status<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">key</span> <span class="token identifier"><span class="token punctuation">`</span>idx_transaction_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>transaction_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- the table to store BranchSession data</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> <span class="token identifier"><span class="token punctuation">`</span>branch_table<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>branch_table<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>transaction_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>resource_group_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>resource_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>lock_key<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>branch_type<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>client_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>application_data<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">key</span> <span class="token identifier"><span class="token punctuation">`</span>idx_xid<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- the table to store lock data</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> <span class="token identifier"><span class="token punctuation">`</span>lock_table<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>lock_table<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>row_key<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>transaction_id<span class="token punctuation">`</span></span> long <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span> long<span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>resource_id<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>table_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>pk<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>row_key<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali139.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali139.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="‰øÆÊîπseata-server-0-9-0-seata-confÁõÆÂΩï‰∏ãÁöÑregistry-confÈÖçÁΩÆÊñá‰ª∂"><a href="#‰øÆÊîπseata-server-0-9-0-seata-confÁõÆÂΩï‰∏ãÁöÑregistry-confÈÖçÁΩÆÊñá‰ª∂" class="headerlink" title="‰øÆÊîπseata-server-0.9.0\seata\confÁõÆÂΩï‰∏ãÁöÑregistry.confÈÖçÁΩÆÊñá‰ª∂"></a>‰øÆÊîπseata-server-0.9.0\seata\confÁõÆÂΩï‰∏ãÁöÑregistry.confÈÖçÁΩÆÊñá‰ª∂</h3><blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">registry <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span> <span class="token expression">„ÄÅnacos „ÄÅeureka„ÄÅredis„ÄÅzk„ÄÅconsul„ÄÅetcd3„ÄÅsofa</span></span>
  type <span class="token operator">=</span> <span class="token string">"nacos"</span>

  nacos <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost:8848"</span>
    namespace <span class="token operator">=</span> <span class="token string">""</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ÁõÆÁöÑÊòØÔºöÊåáÊòéÊ≥®ÂÜå‰∏≠ÂøÉ‰∏∫nacosÔºåÂèä‰øÆÊîπnacosËøûÊé•‰ø°ÊÅØ</strong></p>
</blockquote>
<h3 id="ÂÖàÂêØÂä®NacosÁ´ØÂè£Âè∑8848"><a href="#ÂÖàÂêØÂä®NacosÁ´ØÂè£Âè∑8848" class="headerlink" title="ÂÖàÂêØÂä®NacosÁ´ØÂè£Âè∑8848"></a>ÂÖàÂêØÂä®NacosÁ´ØÂè£Âè∑8848</h3><blockquote>
<p><strong>softs\nacos-server-1.1.4\nacos\bin</strong></p>
</blockquote>
<h3 id="ÂÜçÂêØÂä®seata-server"><a href="#ÂÜçÂêØÂä®seata-server" class="headerlink" title="ÂÜçÂêØÂä®seata-server"></a>ÂÜçÂêØÂä®seata-server</h3><blockquote>
<p><strong>softs\seata-server-0.9.0\seata\bin    seata-server.bat</strong></p>
</blockquote>
<h2 id="ËÆ¢Âçï-x2F-Â∫ìÂ≠ò-x2F-Ë¥¶Êà∑‰∏öÂä°Êï∞ÊçÆÂ∫ìÂáÜÂ§á"><a href="#ËÆ¢Âçï-x2F-Â∫ìÂ≠ò-x2F-Ë¥¶Êà∑‰∏öÂä°Êï∞ÊçÆÂ∫ìÂáÜÂ§á" class="headerlink" title="ËÆ¢Âçï&#x2F;Â∫ìÂ≠ò&#x2F;Ë¥¶Êà∑‰∏öÂä°Êï∞ÊçÆÂ∫ìÂáÜÂ§á"></a>ËÆ¢Âçï&#x2F;Â∫ìÂ≠ò&#x2F;Ë¥¶Êà∑‰∏öÂä°Êï∞ÊçÆÂ∫ìÂáÜÂ§á</h2><h3 id="‰ª•‰∏ãÊºîÁ§∫ÈÉΩÈúÄË¶ÅÂÖàÂêØÂä®NacosÂêéÂêØÂä®SeataÔºå‰øùËØÅ‰∏§‰∏™ÈÉΩOK"><a href="#‰ª•‰∏ãÊºîÁ§∫ÈÉΩÈúÄË¶ÅÂÖàÂêØÂä®NacosÂêéÂêØÂä®SeataÔºå‰øùËØÅ‰∏§‰∏™ÈÉΩOK" class="headerlink" title="‰ª•‰∏ãÊºîÁ§∫ÈÉΩÈúÄË¶ÅÂÖàÂêØÂä®NacosÂêéÂêØÂä®SeataÔºå‰øùËØÅ‰∏§‰∏™ÈÉΩOK"></a>‰ª•‰∏ãÊºîÁ§∫ÈÉΩÈúÄË¶Å<strong>ÂÖàÂêØÂä®NacosÂêéÂêØÂä®Seata</strong>Ôºå‰øùËØÅ‰∏§‰∏™ÈÉΩOK</h3><p><code>SeataÊ≤°ÂêØÂä®Êä•Èîôno available server to connect</code></p>
<h3 id="ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏öÂä°ËØ¥Êòé"><a href="#ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏öÂä°ËØ¥Êòé" class="headerlink" title="ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏öÂä°ËØ¥Êòé"></a>ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏öÂä°ËØ¥Êòé</h3><p>‰∏öÂä°ËØ¥Êòé</p>
<blockquote>
<p>ËøôÈáåÊàë‰ª¨‰ºöÂàõÂª∫‰∏â‰∏™ÊúçÂä°Ôºå‰∏Ä‰∏™ËÆ¢ÂçïÊúçÂä°Ôºå‰∏Ä‰∏™Â∫ìÂ≠òÊúçÂä°Ôºå‰∏Ä‰∏™Ë¥¶Êà∑ÊúçÂä°„ÄÇ</p>
<p><strong>ÂΩìÁî®Êà∑‰∏ãÂçïÊó∂Ôºå‰ºöÂú®ËÆ¢ÂçïÊúçÂä°‰∏≠ÂàõÂª∫‰∏Ä‰∏™ËÆ¢ÂçïÔºåÁÑ∂ÂêéÈÄöËøáËøúÁ®ãË∞ÉÁî®Â∫ìÂ≠òÊúçÂä°Êù•Êâ£Âáè‰∏ãÂçïÂïÜÂìÅÁöÑÂ∫ìÂ≠òÔºå</strong><br><strong>ÂÜçÈÄöËøáËøúÁ®ãË∞ÉÁî®Ë¥¶Êà∑ÊúçÂä°Êù•Êâ£ÂáèÁî®Êà∑Ë¥¶Êà∑ÈáåÈù¢ÁöÑ‰ΩôÈ¢ùÔºå</strong><br><strong>ÊúÄÂêéÂú®ËÆ¢ÂçïÊúçÂä°‰∏≠‰øÆÊîπËÆ¢ÂçïÁä∂ÊÄÅ‰∏∫Â∑≤ÂÆåÊàê</strong>„ÄÇ</p>
<p>ËØ•Êìç‰ΩúË∑®Ë∂ä‰∏â‰∏™Êï∞ÊçÆÂ∫ìÔºåÊúâ‰∏§Ê¨°ËøúÁ®ãË∞ÉÁî®ÔºåÂæàÊòéÊòæ‰ºöÊúâÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈóÆÈ¢ò„ÄÇ</p>
</blockquote>
<p>‰∏ãËÆ¢Âçï‚Äî&gt;Êâ£Â∫ìÂ≠ò‚Äî&gt;ÂáèË¥¶Êà∑(‰ΩôÈ¢ù)</p>
<h3 id="ÂàõÂª∫‰∏öÂä°Êï∞ÊçÆÂ∫ì"><a href="#ÂàõÂª∫‰∏öÂä°Êï∞ÊçÆÂ∫ì" class="headerlink" title="ÂàõÂª∫‰∏öÂä°Êï∞ÊçÆÂ∫ì"></a>ÂàõÂª∫‰∏öÂä°Êï∞ÊçÆÂ∫ì</h3><ul>
<li>seata_orderÔºöÂ≠òÂÇ®ËÆ¢ÂçïÁöÑÊï∞ÊçÆÂ∫ìÔºõ</li>
<li>seata_storageÔºöÂ≠òÂÇ®Â∫ìÂ≠òÁöÑÊï∞ÊçÆÂ∫ìÔºõ</li>
<li>seata_accountÔºöÂ≠òÂÇ®Ë¥¶Êà∑‰ø°ÊÅØÁöÑÊï∞ÊçÆÂ∫ì„ÄÇ</li>
</ul>
<p>Âª∫Â∫ìSQL</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> seata_order<span class="token punctuation">;</span>
 
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> seata_storage<span class="token punctuation">;</span>
 
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> seata_account<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ÊåâÁÖß‰∏äËø∞3Â∫ìÂàÜÂà´Âª∫ÂØπÂ∫î‰∏öÂä°Ë°®"><a href="#ÊåâÁÖß‰∏äËø∞3Â∫ìÂàÜÂà´Âª∫ÂØπÂ∫î‰∏öÂä°Ë°®" class="headerlink" title="ÊåâÁÖß‰∏äËø∞3Â∫ìÂàÜÂà´Âª∫ÂØπÂ∫î‰∏öÂä°Ë°®"></a>ÊåâÁÖß‰∏äËø∞3Â∫ìÂàÜÂà´Âª∫ÂØπÂ∫î‰∏öÂä°Ë°®</h3><p>seata_orderÂ∫ì‰∏ãÂª∫t_orderË°®</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t_order <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'Áî®Êà∑id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>product_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰∫ßÂìÅid'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>count<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'Êï∞Èáè'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>money<span class="token punctuation">`</span></span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÈáëÈ¢ù'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ËÆ¢ÂçïÁä∂ÊÄÅÔºö0ÔºöÂàõÂª∫‰∏≠Ôºõ1ÔºöÂ∑≤ÂÆåÁªì'</span> 
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">7</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t_order<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>seata_storageÂ∫ì‰∏ãÂª∫t_storage Ë°®</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t_storage <span class="token punctuation">(</span>
 <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
 <span class="token identifier"><span class="token punctuation">`</span>product_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'‰∫ßÂìÅid'</span><span class="token punctuation">,</span>
 <span class="token identifier"><span class="token punctuation">`</span>total<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÊÄªÂ∫ìÂ≠ò'</span><span class="token punctuation">,</span>
 <span class="token identifier"><span class="token punctuation">`</span>used<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'Â∑≤Áî®Â∫ìÂ≠ò'</span><span class="token punctuation">,</span>
 <span class="token identifier"><span class="token punctuation">`</span>residue<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'Ââ©‰ΩôÂ∫ìÂ≠ò'</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
 
 
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> seata_storage<span class="token punctuation">.</span>t_storage<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>product_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>total<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>used<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>residue<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'100'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'100'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t_storage<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>seata_accountÂ∫ì‰∏ãÂª∫t_account Ë°®</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t_account <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">COMMENT</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'Áî®Êà∑id'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>total<span class="token punctuation">`</span></span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'ÊÄªÈ¢ùÂ∫¶'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>used<span class="token punctuation">`</span></span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'Â∑≤Áî®‰ΩôÈ¢ù'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>residue<span class="token punctuation">`</span></span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">'0'</span> <span class="token keyword">COMMENT</span> <span class="token string">'Ââ©‰ΩôÂèØÁî®È¢ùÂ∫¶'</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
 
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> seata_account<span class="token punctuation">.</span>t_account<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>total<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>used<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>residue<span class="token punctuation">`</span></span><span class="token punctuation">)</span>  <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'1000'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'1000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t_account<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ÊåâÁÖß‰∏äËø∞3Â∫ìÂàÜÂà´Âª∫ÂØπÂ∫îÁöÑÂõûÊªöÊó•ÂøóË°®"><a href="#ÊåâÁÖß‰∏äËø∞3Â∫ìÂàÜÂà´Âª∫ÂØπÂ∫îÁöÑÂõûÊªöÊó•ÂøóË°®" class="headerlink" title="ÊåâÁÖß‰∏äËø∞3Â∫ìÂàÜÂà´Âª∫ÂØπÂ∫îÁöÑÂõûÊªöÊó•ÂøóË°®"></a>ÊåâÁÖß‰∏äËø∞3Â∫ìÂàÜÂà´Âª∫ÂØπÂ∫îÁöÑÂõûÊªöÊó•ÂøóË°®</h3><p>ËÆ¢Âçï-Â∫ìÂ≠ò-Ë¥¶Êà∑3‰∏™Â∫ì‰∏ãÈÉΩÈúÄË¶ÅÂª∫ÂêÑËá™ÁöÑÂõûÊªöÊó•ÂøóË°®</p>
<p><code>\seata-server-0.9.0\seata\confÁõÆÂΩï‰∏ãÁöÑdb_undo_log.sql</code></p>
<p>Âª∫Ë°®SQL</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token comment">-- the table to store seata xid data</span>
<span class="token comment">-- 0.7.0+ add context</span>
<span class="token comment">-- you must to init this sql for you business databese. the seata server not need it.</span>
<span class="token comment">-- Ê≠§ËÑöÊú¨ÂøÖÈ°ªÂàùÂßãÂåñÂú®‰Ω†ÂΩìÂâçÁöÑ‰∏öÂä°Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÁî®‰∫éAT Ê®°ÂºèXIDËÆ∞ÂΩï„ÄÇ‰∏éserverÁ´ØÊó†ÂÖ≥ÔºàÊ≥®Ôºö‰∏öÂä°Êï∞ÊçÆÂ∫ìÔºâ</span>
<span class="token comment">-- Ê≥®ÊÑèÊ≠§Â§Ñ0.3.0+ Â¢ûÂä†ÂîØ‰∏ÄÁ¥¢Âºï ux_undo_log</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">`</span>undo_log<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>undo_log<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>context<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>rollback_info<span class="token punctuation">`</span></span> <span class="token keyword">longblob</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>log_status<span class="token punctuation">`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>log_created<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>log_modified<span class="token punctuation">`</span></span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>ext<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>ux_undo_log<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="ÊúÄÁªàÊïàÊûú"><a href="#ÊúÄÁªàÊïàÊûú" class="headerlink" title="ÊúÄÁªàÊïàÊûú"></a>ÊúÄÁªàÊïàÊûú</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali140.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali140.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h2 id="ËÆ¢Âçï-x2F-Â∫ìÂ≠ò-x2F-Ë¥¶Êà∑‰∏öÂä°ÂæÆÊúçÂä°ÂáÜÂ§á"><a href="#ËÆ¢Âçï-x2F-Â∫ìÂ≠ò-x2F-Ë¥¶Êà∑‰∏öÂä°ÂæÆÊúçÂä°ÂáÜÂ§á" class="headerlink" title="ËÆ¢Âçï&#x2F;Â∫ìÂ≠ò&#x2F;Ë¥¶Êà∑‰∏öÂä°ÂæÆÊúçÂä°ÂáÜÂ§á"></a>ËÆ¢Âçï&#x2F;Â∫ìÂ≠ò&#x2F;Ë¥¶Êà∑‰∏öÂä°ÂæÆÊúçÂä°ÂáÜÂ§á</h2><h3 id="‰∏öÂä°ÈúÄÊ±Ç"><a href="#‰∏öÂä°ÈúÄÊ±Ç" class="headerlink" title="‰∏öÂä°ÈúÄÊ±Ç"></a>‰∏öÂä°ÈúÄÊ±Ç</h3><p>‰∏ãËÆ¢Âçï-&gt;ÂáèÂ∫ìÂ≠ò-&gt;Êâ£‰ΩôÈ¢ù-&gt;Êîπ(ËÆ¢Âçï)Áä∂ÊÄÅ</p>
<h3 id="Êñ∞Âª∫ËÆ¢ÂçïOrder-Module"><a href="#Êñ∞Âª∫ËÆ¢ÂçïOrder-Module" class="headerlink" title="Êñ∞Âª∫ËÆ¢ÂçïOrder-Module"></a>Êñ∞Âª∫ËÆ¢ÂçïOrder-Module</h3><h4 id="seata-order-service2001"><a href="#seata-order-service2001" class="headerlink" title="seata-order-service2001"></a>seata-order-service2001</h4><h4 id="ÊîπPOM-9"><a href="#ÊîπPOM-9" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-order-service2001<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--nacos--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--seata--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--feign--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--web-actuator--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--mysql-druid--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.1.49<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>



<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ÊîπYML-8"><a href="#ÊîπYML-8" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">2001</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>order<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">alibaba</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span>
        <span class="token comment">#Ëá™ÂÆö‰πâ‰∫ãÂä°ÁªÑÂêçÁß∞ÈúÄË¶Å‰∏éseata-server‰∏≠ÁöÑÂØπÂ∫î</span>
        <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> fsp_tx_group
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/seata_order
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">142857</span>

<span class="token key atrule">feign</span><span class="token punctuation">:</span>
  <span class="token key atrule">hystrix</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">io</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span> info

<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">mapperLocations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">*.xml</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Êîπfile-conf"><a href="#Êîπfile-conf" class="headerlink" title="Êîπfile.conf"></a>Êîπfile.conf</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">transport <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcp</span> <span class="token expression">udt unix<span class="token operator">-</span>domain<span class="token operator">-</span>socket</span></span>
  type <span class="token operator">=</span> <span class="token string">"TCP"</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token expression">NIO NATIVE</span></span>
  server <span class="token operator">=</span> <span class="token string">"NIO"</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">enable</span> <span class="token expression">heartbeat</span></span>
  heartbeat <span class="token operator">=</span> true
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">thread</span> <span class="token expression">factory <span class="token keyword">for</span> netty</span></span>
  thread<span class="token operator">-</span>factory <span class="token punctuation">&#123;</span>
    boss<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyBoss"</span>
    worker<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyServerNIOWorker"</span>
    server<span class="token operator">-</span>executor<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyServerBizHandler"</span>
    share<span class="token operator">-</span>boss<span class="token operator">-</span>worker <span class="token operator">=</span> false
    client<span class="token operator">-</span>selector<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyClientSelector"</span>
    client<span class="token operator">-</span>selector<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">1</span>
    client<span class="token operator">-</span>worker<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyClientWorkerThread"</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">netty</span> <span class="token expression">boss thread size<span class="token punctuation">,</span>will not be used <span class="token keyword">for</span> UDT</span></span>
    boss<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">auto</span> <span class="token expression"><span class="token keyword">default</span> pin or <span class="token number">8</span></span></span>
    worker<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">8</span>
  <span class="token punctuation">&#125;</span>
  shutdown <span class="token punctuation">&#123;</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">when</span> <span class="token expression">destroy server<span class="token punctuation">,</span> wait seconds</span></span>
    wait <span class="token operator">=</span> <span class="token number">3</span>
  <span class="token punctuation">&#125;</span>
  serialization <span class="token operator">=</span> <span class="token string">"seata"</span>
  compressor <span class="token operator">=</span> <span class="token string">"none"</span>
<span class="token punctuation">&#125;</span>

service <span class="token punctuation">&#123;</span>

  vgroup_mapping<span class="token punctuation">.</span>fsp_tx_group <span class="token operator">=</span> <span class="token string">"default"</span> #‰øÆÊîπËá™ÂÆö‰πâ‰∫ãÂä°ÁªÑÂêçÁß∞

  <span class="token keyword">default</span><span class="token punctuation">.</span>grouplist <span class="token operator">=</span> <span class="token string">"127.0.0.1:8091"</span>
  enableDegrade <span class="token operator">=</span> false
  disable <span class="token operator">=</span> false
  max<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token string">"-1"</span>
  max<span class="token punctuation">.</span>rollback<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token string">"-1"</span>
  disableGlobalTransaction <span class="token operator">=</span> false
<span class="token punctuation">&#125;</span>


client <span class="token punctuation">&#123;</span>
  async<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>buffer<span class="token punctuation">.</span>limit <span class="token operator">=</span> <span class="token number">10000</span>
  lock <span class="token punctuation">&#123;</span>
    retry<span class="token punctuation">.</span>internal <span class="token operator">=</span> <span class="token number">10</span>
    retry<span class="token punctuation">.</span>times <span class="token operator">=</span> <span class="token number">30</span>
  <span class="token punctuation">&#125;</span>
  report<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">5</span>
  tm<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span>
  tm<span class="token punctuation">.</span>rollback<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">&#125;</span>

## transaction log store
store <span class="token punctuation">&#123;</span>
  ## store mode<span class="token operator">:</span> file„ÄÅdb
  mode <span class="token operator">=</span> <span class="token string">"db"</span>

  ## file store
  file <span class="token punctuation">&#123;</span>
    dir <span class="token operator">=</span> <span class="token string">"sessionStore"</span>

    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">branch</span> <span class="token expression">session size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded first try compress lockkey<span class="token punctuation">,</span> still exceeded throws exceptions</span></span>
    max<span class="token operator">-</span>branch<span class="token operator">-</span>session<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">16384</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">globe</span> <span class="token expression">session size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded throws exceptions</span></span>
    max<span class="token operator">-</span>global<span class="token operator">-</span>session<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">512</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span> <span class="token expression">buffer size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded allocate new buffer</span></span>
    file<span class="token operator">-</span>write<span class="token operator">-</span>buffer<span class="token operator">-</span>cache<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">16384</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">when</span> <span class="token expression">recover batch read size</span></span>
    session<span class="token punctuation">.</span>reload<span class="token punctuation">.</span>read_size <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">async</span><span class="token expression"><span class="token punctuation">,</span> sync</span></span>
    flush<span class="token operator">-</span>disk<span class="token operator">-</span>mode <span class="token operator">=</span> async
  <span class="token punctuation">&#125;</span>

  ## database store
  db <span class="token punctuation">&#123;</span>
    ## the implement of javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DataSource<span class="token punctuation">,</span> such as <span class="token function">DruidDataSource</span><span class="token punctuation">(</span>druid<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">BasicDataSource</span><span class="token punctuation">(</span>dbcp<span class="token punctuation">)</span> etc<span class="token punctuation">.</span>
    datasource <span class="token operator">=</span> <span class="token string">"dbcp"</span>
    ## mysql<span class="token operator">/</span>oracle<span class="token operator">/</span>h2<span class="token operator">/</span>oceanbase etc<span class="token punctuation">.</span>
    db<span class="token operator">-</span>type <span class="token operator">=</span> <span class="token string">"mysql"</span>
    driver<span class="token operator">-</span>class<span class="token operator">-</span>name <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span>
    url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://127.0.0.1:3306/seata"</span>
    user <span class="token operator">=</span> <span class="token string">"root"</span>
    password <span class="token operator">=</span> <span class="token string">"142857"</span>
    min<span class="token operator">-</span>conn <span class="token operator">=</span> <span class="token number">1</span>
    max<span class="token operator">-</span>conn <span class="token operator">=</span> <span class="token number">3</span>
    global<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"global_table"</span>
    branch<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"branch_table"</span>
    lock<span class="token operator">-</span>table <span class="token operator">=</span> <span class="token string">"lock_table"</span>
    query<span class="token operator">-</span>limit <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
lock <span class="token punctuation">&#123;</span>
  ## the lock store mode<span class="token operator">:</span> local„ÄÅremote
  mode <span class="token operator">=</span> <span class="token string">"remote"</span>

  local <span class="token punctuation">&#123;</span>
    ## store locks in user's database
  <span class="token punctuation">&#125;</span>

  remote <span class="token punctuation">&#123;</span>
    ## store locks in the seata's server
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
recovery <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">committing retry period in milliseconds</span></span>
  committing<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">asyn committing retry period in milliseconds</span></span>
  asyn<span class="token operator">-</span>committing<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">rollbacking retry period in milliseconds</span></span>
  rollbacking<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">timeout retry period in milliseconds</span></span>
  timeout<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
<span class="token punctuation">&#125;</span>

transaction <span class="token punctuation">&#123;</span>
  undo<span class="token punctuation">.</span>data<span class="token punctuation">.</span>validation <span class="token operator">=</span> true
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>serialization <span class="token operator">=</span> <span class="token string">"jackson"</span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>save<span class="token punctuation">.</span>days <span class="token operator">=</span> <span class="token number">7</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">delete expired undo_log in milliseconds</span></span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>delete<span class="token punctuation">.</span>period <span class="token operator">=</span> <span class="token number">86400000</span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"undo_log"</span>
<span class="token punctuation">&#125;</span>

## metrics settings
metrics <span class="token punctuation">&#123;</span>
  enabled <span class="token operator">=</span> false
  registry<span class="token operator">-</span>type <span class="token operator">=</span> <span class="token string">"compact"</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">multi</span> <span class="token expression">exporters use comma divided</span></span>
  exporter<span class="token operator">-</span>list <span class="token operator">=</span> <span class="token string">"prometheus"</span>
  exporter<span class="token operator">-</span>prometheus<span class="token operator">-</span>port <span class="token operator">=</span> <span class="token number">9898</span>
<span class="token punctuation">&#125;</span>

support <span class="token punctuation">&#123;</span>
  ## spring
  spring <span class="token punctuation">&#123;</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">auto</span> <span class="token expression">proxy the DataSource bean</span></span>
    datasource<span class="token punctuation">.</span>autoproxy <span class="token operator">=</span> false
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Êîπregistry-conf"><a href="#Êîπregistry-conf" class="headerlink" title="Êîπregistry.conf"></a>Êîπregistry.conf</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">registry <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span> <span class="token expression">„ÄÅnacos „ÄÅeureka„ÄÅredis„ÄÅzk„ÄÅconsul„ÄÅetcd3„ÄÅsofa</span></span>
  type <span class="token operator">=</span> <span class="token string">"nacos"</span>

  nacos <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost:8848"</span>
    namespace <span class="token operator">=</span> <span class="token string">""</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
  <span class="token punctuation">&#125;</span>
  eureka <span class="token punctuation">&#123;</span>
    serviceUrl <span class="token operator">=</span> <span class="token string">"http://localhost:8761/eureka"</span>
    application <span class="token operator">=</span> <span class="token string">"default"</span>
    weight <span class="token operator">=</span> <span class="token string">"1"</span>
  <span class="token punctuation">&#125;</span>
  redis <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost:6379"</span>
    db <span class="token operator">=</span> <span class="token string">"0"</span>
  <span class="token punctuation">&#125;</span>
  zk <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:2181"</span>
    session<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">6000</span>
    connect<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2000</span>
  <span class="token punctuation">&#125;</span>
  consul <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:8500"</span>
  <span class="token punctuation">&#125;</span>
  etcd3 <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"http://localhost:2379"</span>
  <span class="token punctuation">&#125;</span>
  sofa <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:9603"</span>
    application <span class="token operator">=</span> <span class="token string">"default"</span>
    region <span class="token operator">=</span> <span class="token string">"DEFAULT_ZONE"</span>
    datacenter <span class="token operator">=</span> <span class="token string">"DefaultDataCenter"</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    group <span class="token operator">=</span> <span class="token string">"SEATA_GROUP"</span>
    addressWaitTime <span class="token operator">=</span> <span class="token string">"3000"</span>
  <span class="token punctuation">&#125;</span>
  file <span class="token punctuation">&#123;</span>
    name <span class="token operator">=</span> <span class="token string">"file.conf"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

config <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span><span class="token expression">„ÄÅnacos „ÄÅapollo„ÄÅzk„ÄÅconsul„ÄÅetcd3</span></span>
  type <span class="token operator">=</span> <span class="token string">"file"</span>

  nacos <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost"</span>
    namespace <span class="token operator">=</span> <span class="token string">""</span>
  <span class="token punctuation">&#125;</span>
  consul <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:8500"</span>
  <span class="token punctuation">&#125;</span>
  apollo <span class="token punctuation">&#123;</span>
    app<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">"seata-server"</span>
    apollo<span class="token punctuation">.</span>meta <span class="token operator">=</span> <span class="token string">"http://192.168.1.204:8801"</span>
  <span class="token punctuation">&#125;</span>
  zk <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:2181"</span>
    session<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">6000</span>
    connect<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2000</span>
  <span class="token punctuation">&#125;</span>
  etcd3 <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"http://localhost:2379"</span>
  <span class="token punctuation">&#125;</span>
  file <span class="token punctuation">&#123;</span>
    name <span class="token operator">=</span> <span class="token string">"file.conf"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="domain"><a href="#domain" class="headerlink" title="domain"></a>domain</h4><h5 id="CommonResult"><a href="#CommonResult" class="headerlink" title="CommonResult"></a>CommonResult</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span>  message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span>       data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span>message<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="Order"><a href="#Order" class="headerlink" title="Order"></a>Order</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> productId<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> count<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">;</span>

    <span class="token comment">/**
     * ËÆ¢ÂçïÁä∂ÊÄÅÔºö0ÔºöÂàõÂª∫‰∏≠Ôºõ1ÔºöÂ∑≤ÂÆåÁªì
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="DaoÊé•Âè£ÂèäÂÆûÁé∞"><a href="#DaoÊé•Âè£ÂèäÂÆûÁé∞" class="headerlink" title="DaoÊé•Âè£ÂèäÂÆûÁé∞"></a>DaoÊé•Âè£ÂèäÂÆûÁé∞</h4><h5 id="OrderDao"><a href="#OrderDao" class="headerlink" title="OrderDao"></a>OrderDao</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Param</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderDao</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">/**
     * ÂàõÂª∫ËÆ¢Âçï
     */</span>
    <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * ‰øÆÊîπËÆ¢ÂçïÁä∂ÊÄÅÔºå‰ªéÈõ∂Êîπ‰∏∫Â£π
     */</span>
    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä†-OrderMapper-xml"><a href="#resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä†-OrderMapper-xml" class="headerlink" title="resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä† OrderMapper.xml"></a>resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä† OrderMapper.xml</h5><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> <span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ctrl.springcloud.dao.OrderDao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BaseResultMap<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ctrl.springcloud.domain.Order<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BIGINT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user_id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userId<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BIGINT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>product_id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>productId<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BIGINT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>count<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>count<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INTEGER<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>money<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>money<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DECIMAL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>status<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INTEGER<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>create<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        INSERT INTO `t_order` (`id`, `user_id`, `product_id`, `count`, `money`, `status`)
        VALUES (NULL, #&#123;userId&#125;, #&#123;productId&#125;, #&#123;count&#125;, #&#123;money&#125;, 0);
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>update<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        UPDATE `t_order`
        SET status = 1
        WHERE user_id = #&#123;userId&#125; AND status = #&#123;status&#125;;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ServiceÊé•Âè£ÂèäÂÆûÁé∞"><a href="#ServiceÊé•Âè£ÂèäÂÆûÁé∞" class="headerlink" title="ServiceÊé•Âè£ÂèäÂÆûÁé∞"></a>ServiceÊé•Âè£ÂèäÂÆûÁé∞</h4><h5 id="OrderService"><a href="#OrderService" class="headerlink" title="OrderService"></a>OrderService</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderService</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">/**
     * ÂàõÂª∫ËÆ¢Âçï
     */</span>
    <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="OrderServiceImpl"><a href="#OrderServiceImpl" class="headerlink" title="OrderServiceImpl"></a>OrderServiceImpl</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">OrderDao</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AccountService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">OrderService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">StorageService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>seata<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GlobalTransactional</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span>
<span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderDao</span> orderDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">StorageService</span> storageService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountService</span> accountService<span class="token punctuation">;</span>

    <span class="token comment">/**
     * ÂàõÂª∫ËÆ¢Âçï->Ë∞ÉÁî®Â∫ìÂ≠òÊúçÂä°Êâ£ÂáèÂ∫ìÂ≠ò->Ë∞ÉÁî®Ë¥¶Êà∑ÊúçÂä°Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ù->‰øÆÊîπËÆ¢ÂçïÁä∂ÊÄÅ
     * ÁÆÄÂçïËØ¥Ôºö
     * ‰∏ãËÆ¢Âçï->ÂáèÂ∫ìÂ≠ò->Âáè‰ΩôÈ¢ù->ÊîπÁä∂ÊÄÅ
     */</span>
    <span class="token annotation punctuation">@Override</span>
<span class="token comment">//    @GlobalTransactional(name = "fsp-create-order",rollbackFor = Exception.class)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->‰∏ãÂçïÂºÄÂßã"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Êú¨Â∫îÁî®ÂàõÂª∫ËÆ¢Âçï</span>
        orderDao<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ËøúÁ®ãË∞ÉÁî®Â∫ìÂ≠òÊúçÂä°Êâ£ÂáèÂ∫ìÂ≠ò</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->order-service‰∏≠Êâ£ÂáèÂ∫ìÂ≠òÂºÄÂßã"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        storageService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>order<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->order-service‰∏≠Êâ£ÂáèÂ∫ìÂ≠òÁªìÊùü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ËøúÁ®ãË∞ÉÁî®Ë¥¶Êà∑ÊúçÂä°Êâ£Âáè‰ΩôÈ¢ù</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->order-service‰∏≠Êâ£Âáè‰ΩôÈ¢ùÂºÄÂßã"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        accountService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>order<span class="token punctuation">.</span><span class="token function">getMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->order-service‰∏≠Êâ£Âáè‰ΩôÈ¢ùÁªìÊùü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//‰øÆÊîπËÆ¢ÂçïÁä∂ÊÄÅ‰∏∫Â∑≤ÂÆåÊàê</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->order-service‰∏≠‰øÆÊîπËÆ¢ÂçïÁä∂ÊÄÅÂºÄÂßã"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        orderDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->order-service‰∏≠‰øÆÊîπËÆ¢ÂçïÁä∂ÊÄÅÁªìÊùü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->‰∏ãÂçïÁªìÊùü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="StorageService"><a href="#StorageService" class="headerlink" title="StorageService"></a>StorageService</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">FeignClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"seata-storage-service"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StorageService</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">/**
     * Êâ£ÂáèÂ∫ìÂ≠ò
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/storage/decrease"</span><span class="token punctuation">)</span>
    <span class="token class-name">CommonResult</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"productId"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="AccountService"><a href="#AccountService" class="headerlink" title="AccountService"></a>AccountService</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">FeignClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"seata-account-service"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountService</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">/**
     * Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ù
     */</span>
    <span class="token comment">//@RequestMapping(value = "/account/decrease", method = RequestMethod.POST, produces = "application/json; charset=UTF-8")</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/account/decrease"</span><span class="token punctuation">)</span>
    <span class="token class-name">CommonResult</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"money"</span><span class="token punctuation">)</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h4><h5 id="OrderController"><a href="#OrderController" class="headerlink" title="OrderController"></a>OrderController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">OrderService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderService<span class="token punctuation">;</span>

    <span class="token comment">/**
     * ÂàõÂª∫ËÆ¢Âçï
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/order/create"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        orderService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"ËÆ¢ÂçïÂàõÂª∫ÊàêÂäü!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ConfigÈÖçÁΩÆ"><a href="#ConfigÈÖçÁΩÆ" class="headerlink" title="ConfigÈÖçÁΩÆ"></a>ConfigÈÖçÁΩÆ</h4><h5 id="MyBatisConfig"><a href="#MyBatisConfig" class="headerlink" title="MyBatisConfig"></a>MyBatisConfig</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">MapperScan</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"com.ctrl.springcloud.dao"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBatisConfig</span> <span class="token punctuation">&#123;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="DataSourceProxyConfig"><a href="#DataSourceProxyConfig" class="headerlink" title="DataSourceProxyConfig"></a>DataSourceProxyConfig</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span></span><span class="token class-name">DruidDataSource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>seata<span class="token punctuation">.</span>rm<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span></span><span class="token class-name">DataSourceProxy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span></span><span class="token class-name">SpringManagedTransactionFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * ‰ΩøÁî®SeataÂØπÊï∞ÊçÆÊ∫êËøõË°å‰ª£ÁêÜ
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSourceProxyConfig</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;mybatis.mapperLocations&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mapperLocations<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.datasource"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">druidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSourceProxy</span> <span class="token function">dataSourceProxy</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProxy</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">sqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProxy</span> dataSourceProxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SqlSessionFactoryBean</span> sqlSessionFactoryBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSourceProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setMapperLocations</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>mapperLocations<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setTransactionFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SpringManagedTransactionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏ªÂêØÂä®-7"><a href="#‰∏ªÂêØÂä®-7" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h4><h5 id="SeataOrderMainApp2001"><a href="#SeataOrderMainApp2001" class="headerlink" title="SeataOrderMainApp2001"></a>SeataOrderMainApp2001</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">EnableFeignClients</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@EnableFeignClients</span>
<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//ÂèñÊ∂àÊï∞ÊçÆÊ∫êÁöÑËá™Âä®ÂàõÂª∫</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeataOrderMainApp2001</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SeataOrderMainApp2001</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="Êñ∞Âª∫Â∫ìÂ≠òStorage-Module"><a href="#Êñ∞Âª∫Â∫ìÂ≠òStorage-Module" class="headerlink" title="Êñ∞Âª∫Â∫ìÂ≠òStorage-Module"></a>Êñ∞Âª∫Â∫ìÂ≠òStorage-Module</h3><h4 id="seata-storage-service2002"><a href="#seata-storage-service2002" class="headerlink" title="seata-storage-service2002"></a>seata-storage-service2002</h4><h4 id="ÊîπPOM-10"><a href="#ÊîπPOM-10" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-storage-service2002<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--nacos--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--seata--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--feign--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.1.49<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>



<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ÊîπYML-9"><a href="#ÊîπYML-9" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">2002</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>storage<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">alibaba</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span>
        <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> fsp_tx_group
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/seata_storage
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">142857</span>

<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">io</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span> info

<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">mapperLocations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">*.xml</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Êîπfile-conf-1"><a href="#Êîπfile-conf-1" class="headerlink" title="Êîπfile.conf"></a>Êîπfile.conf</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">transport <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcp</span> <span class="token expression">udt unix<span class="token operator">-</span>domain<span class="token operator">-</span>socket</span></span>
  type <span class="token operator">=</span> <span class="token string">"TCP"</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token expression">NIO NATIVE</span></span>
  server <span class="token operator">=</span> <span class="token string">"NIO"</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">enable</span> <span class="token expression">heartbeat</span></span>
  heartbeat <span class="token operator">=</span> true
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">thread</span> <span class="token expression">factory <span class="token keyword">for</span> netty</span></span>
  thread<span class="token operator">-</span>factory <span class="token punctuation">&#123;</span>
    boss<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyBoss"</span>
    worker<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyServerNIOWorker"</span>
    server<span class="token operator">-</span>executor<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyServerBizHandler"</span>
    share<span class="token operator">-</span>boss<span class="token operator">-</span>worker <span class="token operator">=</span> false
    client<span class="token operator">-</span>selector<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyClientSelector"</span>
    client<span class="token operator">-</span>selector<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">1</span>
    client<span class="token operator">-</span>worker<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyClientWorkerThread"</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">netty</span> <span class="token expression">boss thread size<span class="token punctuation">,</span>will not be used <span class="token keyword">for</span> UDT</span></span>
    boss<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">auto</span> <span class="token expression"><span class="token keyword">default</span> pin or <span class="token number">8</span></span></span>
    worker<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">8</span>
  <span class="token punctuation">&#125;</span>
  shutdown <span class="token punctuation">&#123;</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">when</span> <span class="token expression">destroy server<span class="token punctuation">,</span> wait seconds</span></span>
    wait <span class="token operator">=</span> <span class="token number">3</span>
  <span class="token punctuation">&#125;</span>
  serialization <span class="token operator">=</span> <span class="token string">"seata"</span>
  compressor <span class="token operator">=</span> <span class="token string">"none"</span>
<span class="token punctuation">&#125;</span>

service <span class="token punctuation">&#123;</span>

  vgroup_mapping<span class="token punctuation">.</span>fsp_tx_group <span class="token operator">=</span> <span class="token string">"default"</span> #‰øÆÊîπËá™ÂÆö‰πâ‰∫ãÂä°ÁªÑÂêçÁß∞

  <span class="token keyword">default</span><span class="token punctuation">.</span>grouplist <span class="token operator">=</span> <span class="token string">"127.0.0.1:8091"</span>
  enableDegrade <span class="token operator">=</span> false
  disable <span class="token operator">=</span> false
  max<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token string">"-1"</span>
  max<span class="token punctuation">.</span>rollback<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token string">"-1"</span>
  disableGlobalTransaction <span class="token operator">=</span> false
<span class="token punctuation">&#125;</span>


client <span class="token punctuation">&#123;</span>
  async<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>buffer<span class="token punctuation">.</span>limit <span class="token operator">=</span> <span class="token number">10000</span>
  lock <span class="token punctuation">&#123;</span>
    retry<span class="token punctuation">.</span>internal <span class="token operator">=</span> <span class="token number">10</span>
    retry<span class="token punctuation">.</span>times <span class="token operator">=</span> <span class="token number">30</span>
  <span class="token punctuation">&#125;</span>
  report<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">5</span>
  tm<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span>
  tm<span class="token punctuation">.</span>rollback<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">&#125;</span>

## transaction log store
store <span class="token punctuation">&#123;</span>
  ## store mode<span class="token operator">:</span> file„ÄÅdb
  mode <span class="token operator">=</span> <span class="token string">"db"</span>

  ## file store
  file <span class="token punctuation">&#123;</span>
    dir <span class="token operator">=</span> <span class="token string">"sessionStore"</span>

    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">branch</span> <span class="token expression">session size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded first try compress lockkey<span class="token punctuation">,</span> still exceeded throws exceptions</span></span>
    max<span class="token operator">-</span>branch<span class="token operator">-</span>session<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">16384</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">globe</span> <span class="token expression">session size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded throws exceptions</span></span>
    max<span class="token operator">-</span>global<span class="token operator">-</span>session<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">512</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span> <span class="token expression">buffer size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded allocate new buffer</span></span>
    file<span class="token operator">-</span>write<span class="token operator">-</span>buffer<span class="token operator">-</span>cache<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">16384</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">when</span> <span class="token expression">recover batch read size</span></span>
    session<span class="token punctuation">.</span>reload<span class="token punctuation">.</span>read_size <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">async</span><span class="token expression"><span class="token punctuation">,</span> sync</span></span>
    flush<span class="token operator">-</span>disk<span class="token operator">-</span>mode <span class="token operator">=</span> async
  <span class="token punctuation">&#125;</span>

  ## database store
  db <span class="token punctuation">&#123;</span>
    ## the implement of javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DataSource<span class="token punctuation">,</span> such as <span class="token function">DruidDataSource</span><span class="token punctuation">(</span>druid<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">BasicDataSource</span><span class="token punctuation">(</span>dbcp<span class="token punctuation">)</span> etc<span class="token punctuation">.</span>
    datasource <span class="token operator">=</span> <span class="token string">"dbcp"</span>
    ## mysql<span class="token operator">/</span>oracle<span class="token operator">/</span>h2<span class="token operator">/</span>oceanbase etc<span class="token punctuation">.</span>
    db<span class="token operator">-</span>type <span class="token operator">=</span> <span class="token string">"mysql"</span>
    driver<span class="token operator">-</span>class<span class="token operator">-</span>name <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span>
    url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://127.0.0.1:3306/seata"</span>
    user <span class="token operator">=</span> <span class="token string">"root"</span>
    password <span class="token operator">=</span> <span class="token string">"142857"</span>
    min<span class="token operator">-</span>conn <span class="token operator">=</span> <span class="token number">1</span>
    max<span class="token operator">-</span>conn <span class="token operator">=</span> <span class="token number">3</span>
    global<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"global_table"</span>
    branch<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"branch_table"</span>
    lock<span class="token operator">-</span>table <span class="token operator">=</span> <span class="token string">"lock_table"</span>
    query<span class="token operator">-</span>limit <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
lock <span class="token punctuation">&#123;</span>
  ## the lock store mode<span class="token operator">:</span> local„ÄÅremote
  mode <span class="token operator">=</span> <span class="token string">"remote"</span>

  local <span class="token punctuation">&#123;</span>
    ## store locks in user's database
  <span class="token punctuation">&#125;</span>

  remote <span class="token punctuation">&#123;</span>
    ## store locks in the seata's server
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
recovery <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">committing retry period in milliseconds</span></span>
  committing<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">asyn committing retry period in milliseconds</span></span>
  asyn<span class="token operator">-</span>committing<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">rollbacking retry period in milliseconds</span></span>
  rollbacking<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">timeout retry period in milliseconds</span></span>
  timeout<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
<span class="token punctuation">&#125;</span>

transaction <span class="token punctuation">&#123;</span>
  undo<span class="token punctuation">.</span>data<span class="token punctuation">.</span>validation <span class="token operator">=</span> true
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>serialization <span class="token operator">=</span> <span class="token string">"jackson"</span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>save<span class="token punctuation">.</span>days <span class="token operator">=</span> <span class="token number">7</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">delete expired undo_log in milliseconds</span></span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>delete<span class="token punctuation">.</span>period <span class="token operator">=</span> <span class="token number">86400000</span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"undo_log"</span>
<span class="token punctuation">&#125;</span>

## metrics settings
metrics <span class="token punctuation">&#123;</span>
  enabled <span class="token operator">=</span> false
  registry<span class="token operator">-</span>type <span class="token operator">=</span> <span class="token string">"compact"</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">multi</span> <span class="token expression">exporters use comma divided</span></span>
  exporter<span class="token operator">-</span>list <span class="token operator">=</span> <span class="token string">"prometheus"</span>
  exporter<span class="token operator">-</span>prometheus<span class="token operator">-</span>port <span class="token operator">=</span> <span class="token number">9898</span>
<span class="token punctuation">&#125;</span>

support <span class="token punctuation">&#123;</span>
  ## spring
  spring <span class="token punctuation">&#123;</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">auto</span> <span class="token expression">proxy the DataSource bean</span></span>
    datasource<span class="token punctuation">.</span>autoproxy <span class="token operator">=</span> false
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Êîπregistry-conf-1"><a href="#Êîπregistry-conf-1" class="headerlink" title="Êîπregistry.conf"></a>Êîπregistry.conf</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">registry <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span> <span class="token expression">„ÄÅnacos „ÄÅeureka„ÄÅredis„ÄÅzk„ÄÅconsul„ÄÅetcd3„ÄÅsofa</span></span>
  type <span class="token operator">=</span> <span class="token string">"nacos"</span>

  nacos <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost:8848"</span>
    namespace <span class="token operator">=</span> <span class="token string">""</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
  <span class="token punctuation">&#125;</span>
  eureka <span class="token punctuation">&#123;</span>
    serviceUrl <span class="token operator">=</span> <span class="token string">"http://localhost:8761/eureka"</span>
    application <span class="token operator">=</span> <span class="token string">"default"</span>
    weight <span class="token operator">=</span> <span class="token string">"1"</span>
  <span class="token punctuation">&#125;</span>
  redis <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost:6379"</span>
    db <span class="token operator">=</span> <span class="token string">"0"</span>
  <span class="token punctuation">&#125;</span>
  zk <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:2181"</span>
    session<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">6000</span>
    connect<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2000</span>
  <span class="token punctuation">&#125;</span>
  consul <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:8500"</span>
  <span class="token punctuation">&#125;</span>
  etcd3 <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"http://localhost:2379"</span>
  <span class="token punctuation">&#125;</span>
  sofa <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:9603"</span>
    application <span class="token operator">=</span> <span class="token string">"default"</span>
    region <span class="token operator">=</span> <span class="token string">"DEFAULT_ZONE"</span>
    datacenter <span class="token operator">=</span> <span class="token string">"DefaultDataCenter"</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    group <span class="token operator">=</span> <span class="token string">"SEATA_GROUP"</span>
    addressWaitTime <span class="token operator">=</span> <span class="token string">"3000"</span>
  <span class="token punctuation">&#125;</span>
  file <span class="token punctuation">&#123;</span>
    name <span class="token operator">=</span> <span class="token string">"file.conf"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

config <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span><span class="token expression">„ÄÅnacos „ÄÅapollo„ÄÅzk„ÄÅconsul„ÄÅetcd3</span></span>
  type <span class="token operator">=</span> <span class="token string">"file"</span>

  nacos <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost"</span>
    namespace <span class="token operator">=</span> <span class="token string">""</span>
  <span class="token punctuation">&#125;</span>
  consul <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:8500"</span>
  <span class="token punctuation">&#125;</span>
  apollo <span class="token punctuation">&#123;</span>
    app<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">"seata-server"</span>
    apollo<span class="token punctuation">.</span>meta <span class="token operator">=</span> <span class="token string">"http://192.168.1.204:8801"</span>
  <span class="token punctuation">&#125;</span>
  zk <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:2181"</span>
    session<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">6000</span>
    connect<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2000</span>
  <span class="token punctuation">&#125;</span>
  etcd3 <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"http://localhost:2379"</span>
  <span class="token punctuation">&#125;</span>
  file <span class="token punctuation">&#123;</span>
    name <span class="token operator">=</span> <span class="token string">"file.conf"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="domain-1"><a href="#domain-1" class="headerlink" title="domain"></a>domain</h4><h5 id="CommonResult-1"><a href="#CommonResult-1" class="headerlink" title="CommonResult"></a>CommonResult</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span> data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="Storage"><a href="#Storage" class="headerlink" title="Storage"></a>Storage</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Storage</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token comment">/**
     * ‰∫ßÂìÅid
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> productId<span class="token punctuation">;</span>

    <span class="token comment">/**
     * ÊÄªÂ∫ìÂ≠ò
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> total<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Â∑≤Áî®Â∫ìÂ≠ò
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> used<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Ââ©‰ΩôÂ∫ìÂ≠ò
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> residue<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="DaoÊé•Âè£ÂèäÂÆûÁé∞-1"><a href="#DaoÊé•Âè£ÂèäÂÆûÁé∞-1" class="headerlink" title="DaoÊé•Âè£ÂèäÂÆûÁé∞"></a>DaoÊé•Âè£ÂèäÂÆûÁé∞</h4><h5 id="StorageDao"><a href="#StorageDao" class="headerlink" title="StorageDao"></a>StorageDao</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Param</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StorageDao</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">/**
     * Êâ£ÂáèÂ∫ìÂ≠ò
     */</span>
    <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"productId"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"count"</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä†-StorageMapper-xml"><a href="#resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä†-StorageMapper-xml" class="headerlink" title="resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä† StorageMapper.xml"></a>resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä† StorageMapper.xml</h5><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> <span class="token punctuation">></span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ctrl.springcloud.dao.StorageDao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BaseResultMap<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ctrl.springcloud.domain.Storage<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BIGINT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>product_id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>productId<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BIGINT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>total<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>total<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INTEGER<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>used<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>used<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INTEGER<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>residue<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>residue<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INTEGER<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>decrease<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        UPDATE t_storage
        SET used    = used + #&#123;count&#125;,
            residue = residue - #&#123;count&#125;
        WHERE product_id = #&#123;productId&#125;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ServiceÊé•Âè£ÂèäÂÆûÁé∞-1"><a href="#ServiceÊé•Âè£ÂèäÂÆûÁé∞-1" class="headerlink" title="ServiceÊé•Âè£ÂèäÂÆûÁé∞"></a>ServiceÊé•Âè£ÂèäÂÆûÁé∞</h4><h5 id="StorageService-1"><a href="#StorageService-1" class="headerlink" title="StorageService"></a>StorageService</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StorageService</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/**
     * Êâ£ÂáèÂ∫ìÂ≠ò
     */</span>
    <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="StorageServiceImpl"><a href="#StorageServiceImpl" class="headerlink" title="StorageServiceImpl"></a>StorageServiceImpl</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">StorageDao</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">StorageService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StorageServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">StorageService</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> LOGGER <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">StorageServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">StorageDao</span> storageDao<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Êâ£ÂáèÂ∫ìÂ≠ò
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->storage-service‰∏≠Êâ£ÂáèÂ∫ìÂ≠òÂºÄÂßã"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        storageDao<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>productId<span class="token punctuation">,</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->storage-service‰∏≠Êâ£ÂáèÂ∫ìÂ≠òÁªìÊùü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Controller-1"><a href="#Controller-1" class="headerlink" title="Controller"></a>Controller</h4><h5 id="StorageController"><a href="#StorageController" class="headerlink" title="StorageController"></a>StorageController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">StorageService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StorageController</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StorageService</span> storageService<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Êâ£ÂáèÂ∫ìÂ≠ò
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/storage/decrease"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        storageService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>productId<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"Êâ£ÂáèÂ∫ìÂ≠òÊàêÂäüÔºÅ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ConfigÈÖçÁΩÆ-1"><a href="#ConfigÈÖçÁΩÆ-1" class="headerlink" title="ConfigÈÖçÁΩÆ"></a>ConfigÈÖçÁΩÆ</h4><h5 id="MyBatisConfig-1"><a href="#MyBatisConfig-1" class="headerlink" title="MyBatisConfig"></a>MyBatisConfig</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">MapperScan</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"com.ctrl.springcloud.dao"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBatisConfig</span> <span class="token punctuation">&#123;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="DataSourceProxyConfig-1"><a href="#DataSourceProxyConfig-1" class="headerlink" title="DataSourceProxyConfig"></a>DataSourceProxyConfig</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span></span><span class="token class-name">DruidDataSource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>seata<span class="token punctuation">.</span>rm<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span></span><span class="token class-name">DataSourceProxy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span></span><span class="token class-name">SpringManagedTransactionFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * ‰ΩøÁî®SeataÂØπÊï∞ÊçÆÊ∫êËøõË°å‰ª£ÁêÜ
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSourceProxyConfig</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;mybatis.mapperLocations&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mapperLocations<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.datasource"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">druidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSourceProxy</span> <span class="token function">dataSourceProxy</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProxy</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">sqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProxy</span> dataSourceProxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SqlSessionFactoryBean</span> sqlSessionFactoryBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSourceProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setMapperLocations</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>mapperLocations<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setTransactionFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SpringManagedTransactionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏ªÂêØÂä®-8"><a href="#‰∏ªÂêØÂä®-8" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h4><h5 id="SeataStorageServiceApplication2002"><a href="#SeataStorageServiceApplication2002" class="headerlink" title="SeataStorageServiceApplication2002"></a>SeataStorageServiceApplication2002</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">EnableFeignClients</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@EnableFeignClients</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeataStorageServiceApplication2002</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SeataStorageServiceApplication2002</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="Êñ∞Âª∫Ë¥¶Êà∑Account-Module"><a href="#Êñ∞Âª∫Ë¥¶Êà∑Account-Module" class="headerlink" title="Êñ∞Âª∫Ë¥¶Êà∑Account-Module"></a>Êñ∞Âª∫Ë¥¶Êà∑Account-Module</h3><h4 id="seata-account-service2003"><a href="#seata-account-service2003" class="headerlink" title="seata-account-service2003"></a>seata-account-service2003</h4><h4 id="ÊîπPOM-11"><a href="#ÊîπPOM-11" class="headerlink" title="ÊîπPOM"></a>ÊîπPOM</h4><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>Learn-SpringCloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.ctrl.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-account-service2003<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--nacos--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--seata--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-alibaba-seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--feign--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.1.49<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ÊîπYML-10"><a href="#ÊîπYML-10" class="headerlink" title="ÊîπYML"></a>ÊîπYML</h4><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">2003</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>account<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">alibaba</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span>
        <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> fsp_tx_group
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/seata_account
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">142857</span>

<span class="token key atrule">feign</span><span class="token punctuation">:</span>
  <span class="token key atrule">hystrix</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">io</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span> info

<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">mapperLocations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">*.xml</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Êîπfile-conf-2"><a href="#Êîπfile-conf-2" class="headerlink" title="Êîπfile.conf"></a>Êîπfile.conf</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">transport <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">tcp</span> <span class="token expression">udt unix<span class="token operator">-</span>domain<span class="token operator">-</span>socket</span></span>
  type <span class="token operator">=</span> <span class="token string">"TCP"</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token expression">NIO NATIVE</span></span>
  server <span class="token operator">=</span> <span class="token string">"NIO"</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">enable</span> <span class="token expression">heartbeat</span></span>
  heartbeat <span class="token operator">=</span> true
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">thread</span> <span class="token expression">factory <span class="token keyword">for</span> netty</span></span>
  thread<span class="token operator">-</span>factory <span class="token punctuation">&#123;</span>
    boss<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyBoss"</span>
    worker<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyServerNIOWorker"</span>
    server<span class="token operator">-</span>executor<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyServerBizHandler"</span>
    share<span class="token operator">-</span>boss<span class="token operator">-</span>worker <span class="token operator">=</span> false
    client<span class="token operator">-</span>selector<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyClientSelector"</span>
    client<span class="token operator">-</span>selector<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">1</span>
    client<span class="token operator">-</span>worker<span class="token operator">-</span>thread<span class="token operator">-</span>prefix <span class="token operator">=</span> <span class="token string">"NettyClientWorkerThread"</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">netty</span> <span class="token expression">boss thread size<span class="token punctuation">,</span>will not be used <span class="token keyword">for</span> UDT</span></span>
    boss<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">auto</span> <span class="token expression"><span class="token keyword">default</span> pin or <span class="token number">8</span></span></span>
    worker<span class="token operator">-</span>thread<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">8</span>
  <span class="token punctuation">&#125;</span>
  shutdown <span class="token punctuation">&#123;</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">when</span> <span class="token expression">destroy server<span class="token punctuation">,</span> wait seconds</span></span>
    wait <span class="token operator">=</span> <span class="token number">3</span>
  <span class="token punctuation">&#125;</span>
  serialization <span class="token operator">=</span> <span class="token string">"seata"</span>
  compressor <span class="token operator">=</span> <span class="token string">"none"</span>
<span class="token punctuation">&#125;</span>

service <span class="token punctuation">&#123;</span>

  vgroup_mapping<span class="token punctuation">.</span>fsp_tx_group <span class="token operator">=</span> <span class="token string">"default"</span> #‰øÆÊîπËá™ÂÆö‰πâ‰∫ãÂä°ÁªÑÂêçÁß∞

  <span class="token keyword">default</span><span class="token punctuation">.</span>grouplist <span class="token operator">=</span> <span class="token string">"127.0.0.1:8091"</span>
  enableDegrade <span class="token operator">=</span> false
  disable <span class="token operator">=</span> false
  max<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token string">"-1"</span>
  max<span class="token punctuation">.</span>rollback<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token string">"-1"</span>
  disableGlobalTransaction <span class="token operator">=</span> false
<span class="token punctuation">&#125;</span>


client <span class="token punctuation">&#123;</span>
  async<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>buffer<span class="token punctuation">.</span>limit <span class="token operator">=</span> <span class="token number">10000</span>
  lock <span class="token punctuation">&#123;</span>
    retry<span class="token punctuation">.</span>internal <span class="token operator">=</span> <span class="token number">10</span>
    retry<span class="token punctuation">.</span>times <span class="token operator">=</span> <span class="token number">30</span>
  <span class="token punctuation">&#125;</span>
  report<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">5</span>
  tm<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span>
  tm<span class="token punctuation">.</span>rollback<span class="token punctuation">.</span>retry<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">&#125;</span>

## transaction log store
store <span class="token punctuation">&#123;</span>
  ## store mode<span class="token operator">:</span> file„ÄÅdb
  mode <span class="token operator">=</span> <span class="token string">"db"</span>

  ## file store
  file <span class="token punctuation">&#123;</span>
    dir <span class="token operator">=</span> <span class="token string">"sessionStore"</span>

    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">branch</span> <span class="token expression">session size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded first try compress lockkey<span class="token punctuation">,</span> still exceeded throws exceptions</span></span>
    max<span class="token operator">-</span>branch<span class="token operator">-</span>session<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">16384</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">globe</span> <span class="token expression">session size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded throws exceptions</span></span>
    max<span class="token operator">-</span>global<span class="token operator">-</span>session<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">512</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span> <span class="token expression">buffer size <span class="token punctuation">,</span> <span class="token keyword">if</span> exceeded allocate new buffer</span></span>
    file<span class="token operator">-</span>write<span class="token operator">-</span>buffer<span class="token operator">-</span>cache<span class="token operator">-</span>size <span class="token operator">=</span> <span class="token number">16384</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">when</span> <span class="token expression">recover batch read size</span></span>
    session<span class="token punctuation">.</span>reload<span class="token punctuation">.</span>read_size <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">async</span><span class="token expression"><span class="token punctuation">,</span> sync</span></span>
    flush<span class="token operator">-</span>disk<span class="token operator">-</span>mode <span class="token operator">=</span> async
  <span class="token punctuation">&#125;</span>

  ## database store
  db <span class="token punctuation">&#123;</span>
    ## the implement of javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DataSource<span class="token punctuation">,</span> such as <span class="token function">DruidDataSource</span><span class="token punctuation">(</span>druid<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">BasicDataSource</span><span class="token punctuation">(</span>dbcp<span class="token punctuation">)</span> etc<span class="token punctuation">.</span>
    datasource <span class="token operator">=</span> <span class="token string">"dbcp"</span>
    ## mysql<span class="token operator">/</span>oracle<span class="token operator">/</span>h2<span class="token operator">/</span>oceanbase etc<span class="token punctuation">.</span>
    db<span class="token operator">-</span>type <span class="token operator">=</span> <span class="token string">"mysql"</span>
    driver<span class="token operator">-</span>class<span class="token operator">-</span>name <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span>
    url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://127.0.0.1:3306/seata"</span>
    user <span class="token operator">=</span> <span class="token string">"root"</span>
    password <span class="token operator">=</span> <span class="token string">"142857"</span>
    min<span class="token operator">-</span>conn <span class="token operator">=</span> <span class="token number">1</span>
    max<span class="token operator">-</span>conn <span class="token operator">=</span> <span class="token number">3</span>
    global<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"global_table"</span>
    branch<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"branch_table"</span>
    lock<span class="token operator">-</span>table <span class="token operator">=</span> <span class="token string">"lock_table"</span>
    query<span class="token operator">-</span>limit <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
lock <span class="token punctuation">&#123;</span>
  ## the lock store mode<span class="token operator">:</span> local„ÄÅremote
  mode <span class="token operator">=</span> <span class="token string">"remote"</span>

  local <span class="token punctuation">&#123;</span>
    ## store locks in user's database
  <span class="token punctuation">&#125;</span>

  remote <span class="token punctuation">&#123;</span>
    ## store locks in the seata's server
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
recovery <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">committing retry period in milliseconds</span></span>
  committing<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">asyn committing retry period in milliseconds</span></span>
  asyn<span class="token operator">-</span>committing<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">rollbacking retry period in milliseconds</span></span>
  rollbacking<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">timeout retry period in milliseconds</span></span>
  timeout<span class="token operator">-</span>retry<span class="token operator">-</span>period <span class="token operator">=</span> <span class="token number">1000</span>
<span class="token punctuation">&#125;</span>

transaction <span class="token punctuation">&#123;</span>
  undo<span class="token punctuation">.</span>data<span class="token punctuation">.</span>validation <span class="token operator">=</span> true
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>serialization <span class="token operator">=</span> <span class="token string">"jackson"</span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>save<span class="token punctuation">.</span>days <span class="token operator">=</span> <span class="token number">7</span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">schedule</span> <span class="token expression">delete expired undo_log in milliseconds</span></span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>delete<span class="token punctuation">.</span>period <span class="token operator">=</span> <span class="token number">86400000</span>
  undo<span class="token punctuation">.</span>log<span class="token punctuation">.</span>table <span class="token operator">=</span> <span class="token string">"undo_log"</span>
<span class="token punctuation">&#125;</span>

## metrics settings
metrics <span class="token punctuation">&#123;</span>
  enabled <span class="token operator">=</span> false
  registry<span class="token operator">-</span>type <span class="token operator">=</span> <span class="token string">"compact"</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">multi</span> <span class="token expression">exporters use comma divided</span></span>
  exporter<span class="token operator">-</span>list <span class="token operator">=</span> <span class="token string">"prometheus"</span>
  exporter<span class="token operator">-</span>prometheus<span class="token operator">-</span>port <span class="token operator">=</span> <span class="token number">9898</span>
<span class="token punctuation">&#125;</span>

support <span class="token punctuation">&#123;</span>
  ## spring
  spring <span class="token punctuation">&#123;</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">auto</span> <span class="token expression">proxy the DataSource bean</span></span>
    datasource<span class="token punctuation">.</span>autoproxy <span class="token operator">=</span> false
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Êîπregistry-conf-2"><a href="#Êîπregistry-conf-2" class="headerlink" title="Êîπregistry.conf"></a>Êîπregistry.conf</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c">registry <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span> <span class="token expression">„ÄÅnacos „ÄÅeureka„ÄÅredis„ÄÅzk„ÄÅconsul„ÄÅetcd3„ÄÅsofa</span></span>
  type <span class="token operator">=</span> <span class="token string">"nacos"</span>

  nacos <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost:8848"</span>
    namespace <span class="token operator">=</span> <span class="token string">""</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
  <span class="token punctuation">&#125;</span>
  eureka <span class="token punctuation">&#123;</span>
    serviceUrl <span class="token operator">=</span> <span class="token string">"http://localhost:8761/eureka"</span>
    application <span class="token operator">=</span> <span class="token string">"default"</span>
    weight <span class="token operator">=</span> <span class="token string">"1"</span>
  <span class="token punctuation">&#125;</span>
  redis <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost:6379"</span>
    db <span class="token operator">=</span> <span class="token string">"0"</span>
  <span class="token punctuation">&#125;</span>
  zk <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:2181"</span>
    session<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">6000</span>
    connect<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2000</span>
  <span class="token punctuation">&#125;</span>
  consul <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:8500"</span>
  <span class="token punctuation">&#125;</span>
  etcd3 <span class="token punctuation">&#123;</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"http://localhost:2379"</span>
  <span class="token punctuation">&#125;</span>
  sofa <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:9603"</span>
    application <span class="token operator">=</span> <span class="token string">"default"</span>
    region <span class="token operator">=</span> <span class="token string">"DEFAULT_ZONE"</span>
    datacenter <span class="token operator">=</span> <span class="token string">"DefaultDataCenter"</span>
    cluster <span class="token operator">=</span> <span class="token string">"default"</span>
    group <span class="token operator">=</span> <span class="token string">"SEATA_GROUP"</span>
    addressWaitTime <span class="token operator">=</span> <span class="token string">"3000"</span>
  <span class="token punctuation">&#125;</span>
  file <span class="token punctuation">&#123;</span>
    name <span class="token operator">=</span> <span class="token string">"file.conf"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

config <span class="token punctuation">&#123;</span>
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">file</span><span class="token expression">„ÄÅnacos „ÄÅapollo„ÄÅzk„ÄÅconsul„ÄÅetcd3</span></span>
  type <span class="token operator">=</span> <span class="token string">"file"</span>

  nacos <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"localhost"</span>
    namespace <span class="token operator">=</span> <span class="token string">""</span>
  <span class="token punctuation">&#125;</span>
  consul <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:8500"</span>
  <span class="token punctuation">&#125;</span>
  apollo <span class="token punctuation">&#123;</span>
    app<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">"seata-server"</span>
    apollo<span class="token punctuation">.</span>meta <span class="token operator">=</span> <span class="token string">"http://192.168.1.204:8801"</span>
  <span class="token punctuation">&#125;</span>
  zk <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"127.0.0.1:2181"</span>
    session<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">6000</span>
    connect<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">2000</span>
  <span class="token punctuation">&#125;</span>
  etcd3 <span class="token punctuation">&#123;</span>
    serverAddr <span class="token operator">=</span> <span class="token string">"http://localhost:2379"</span>
  <span class="token punctuation">&#125;</span>
  file <span class="token punctuation">&#123;</span>
    name <span class="token operator">=</span> <span class="token string">"file.conf"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="domain-2"><a href="#domain-2" class="headerlink" title="domain"></a>domain</h4><h5 id="CommonResult-2"><a href="#CommonResult-2" class="headerlink" title="CommonResult"></a>CommonResult</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span> data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="Account"><a href="#Account" class="headerlink" title="Account"></a>Account</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Áî®Êà∑id
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

    <span class="token comment">/**
     * ÊÄªÈ¢ùÂ∫¶
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> total<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Â∑≤Áî®È¢ùÂ∫¶
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> used<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Ââ©‰ΩôÈ¢ùÂ∫¶
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> residue<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="DaoÊé•Âè£ÂèäÂÆûÁé∞-2"><a href="#DaoÊé•Âè£ÂèäÂÆûÁé∞-2" class="headerlink" title="DaoÊé•Âè£ÂèäÂÆûÁé∞"></a>DaoÊé•Âè£ÂèäÂÆûÁé∞</h4><h5 id="AccountDao"><a href="#AccountDao" class="headerlink" title="AccountDao"></a>AccountDao</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Param</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountDao</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">/**
     * Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ù
     */</span>
    <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"money"</span><span class="token punctuation">)</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä†-AccountMapper-xml"><a href="#resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä†-AccountMapper-xml" class="headerlink" title="resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä† AccountMapper.xml"></a>resourcesÊñá‰ª∂Â§π‰∏ãÊñ∞Âª∫mapperÊñá‰ª∂Â§πÂêéÊ∑ªÂä† AccountMapper.xml</h5><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> <span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ctrl.springcloud.dao.AccountDao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BaseResultMap<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.ctrl.springcloud.domain.Account<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BIGINT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user_id<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userId<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BIGINT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>total<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>total<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DECIMAL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>used<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>used<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DECIMAL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>residue<span class="token punctuation">"</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>residue<span class="token punctuation">"</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DECIMAL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>decrease<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        UPDATE t_account
        SET
            residue = residue - #&#123;money&#125;,used = used + #&#123;money&#125;
        WHERE
            user_id = #&#123;userId&#125;;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ServiceÊé•Âè£ÂèäÂÆûÁé∞-2"><a href="#ServiceÊé•Âè£ÂèäÂÆûÁé∞-2" class="headerlink" title="ServiceÊé•Âè£ÂèäÂÆûÁé∞"></a>ServiceÊé•Âè£ÂèäÂÆûÁé∞</h4><h5 id="AccountService-1"><a href="#AccountService-1" class="headerlink" title="AccountService"></a>AccountService</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountService</span> <span class="token punctuation">&#123;</span>

    <span class="token comment">/**
     * Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ù
     * @param userId Áî®Êà∑id
     * @param money ÈáëÈ¢ù
     */</span>
    <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"money"</span><span class="token punctuation">)</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h6 id="AccountServiceImpl"><a href="#AccountServiceImpl" class="headerlink" title="AccountServiceImpl"></a>AccountServiceImpl</h6><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">AccountDao</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AccountService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Ë¥¶Êà∑‰∏öÂä°ÂÆûÁé∞Á±ª
 */</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">AccountService</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> LOGGER <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">AccountServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">AccountDao</span> accountDao<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ù
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->account-service‰∏≠Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ùÂºÄÂßã"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Ê®°ÊãüË∂ÖÊó∂ÂºÇÂ∏∏ÔºåÂÖ®Â±Ä‰∫ãÂä°ÂõûÊªö</span>
        <span class="token comment">//ÊöÇÂÅúÂá†ÁßíÈíüÁ∫øÁ®ã</span>
        <span class="token comment">//try &#123; TimeUnit.SECONDS.sleep(30); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125;</span>
        accountDao<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->account-service‰∏≠Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ùÁªìÊùü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Controller-2"><a href="#Controller-2" class="headerlink" title="Controller"></a>Controller</h4><h5 id="AccountController"><a href="#AccountController" class="headerlink" title="AccountController"></a>AccountController</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AccountService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountController</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">AccountService</span> accountService<span class="token punctuation">;</span>

    <span class="token comment">/**
     * Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ù
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/account/decrease"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"userId"</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"money"</span><span class="token punctuation">)</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        accountService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ùÊàêÂäüÔºÅ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="ConfigÈÖçÁΩÆ-2"><a href="#ConfigÈÖçÁΩÆ-2" class="headerlink" title="ConfigÈÖçÁΩÆ"></a>ConfigÈÖçÁΩÆ</h4><h5 id="MyBatisConfig-2"><a href="#MyBatisConfig-2" class="headerlink" title="MyBatisConfig"></a>MyBatisConfig</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">MapperScan</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"com.ctrl.springcloud.dao"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBatisConfig</span> <span class="token punctuation">&#123;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h5 id="DataSourceProxyConfig-2"><a href="#DataSourceProxyConfig-2" class="headerlink" title="DataSourceProxyConfig"></a>DataSourceProxyConfig</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span></span><span class="token class-name">DruidDataSource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>seata<span class="token punctuation">.</span>rm<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span></span><span class="token class-name">DataSourceProxy</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span></span><span class="token class-name">SpringManagedTransactionFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * ‰ΩøÁî®SeataÂØπÊï∞ÊçÆÊ∫êËøõË°å‰ª£ÁêÜ
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSourceProxyConfig</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;mybatis.mapperLocations&#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mapperLocations<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.datasource"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">druidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSourceProxy</span> <span class="token function">dataSourceProxy</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProxy</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">sqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProxy</span> dataSourceProxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SqlSessionFactoryBean</span> sqlSessionFactoryBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSourceProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setMapperLocations</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>mapperLocations<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setTransactionFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SpringManagedTransactionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>


<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="‰∏ªÂêØÂä®-9"><a href="#‰∏ªÂêØÂä®-9" class="headerlink" title="‰∏ªÂêØÂä®"></a>‰∏ªÂêØÂä®</h4><h5 id="SeataAccountMainApp2003"><a href="#SeataAccountMainApp2003" class="headerlink" title="SeataAccountMainApp2003"></a>SeataAccountMainApp2003</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span>springcloud</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">EnableFeignClients</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@EnableFeignClients</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeataAccountMainApp2003</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SeataAccountMainApp2003</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><h3 id="‰∏ãËÆ¢Âçï-gt-ÂáèÂ∫ìÂ≠ò-gt-Êâ£‰ΩôÈ¢ù-gt-Êîπ-ËÆ¢Âçï-Áä∂ÊÄÅ"><a href="#‰∏ãËÆ¢Âçï-gt-ÂáèÂ∫ìÂ≠ò-gt-Êâ£‰ΩôÈ¢ù-gt-Êîπ-ËÆ¢Âçï-Áä∂ÊÄÅ" class="headerlink" title="‰∏ãËÆ¢Âçï-&gt;ÂáèÂ∫ìÂ≠ò-&gt;Êâ£‰ΩôÈ¢ù-&gt;Êîπ(ËÆ¢Âçï)Áä∂ÊÄÅ"></a>‰∏ãËÆ¢Âçï-&gt;ÂáèÂ∫ìÂ≠ò-&gt;Êâ£‰ΩôÈ¢ù-&gt;Êîπ(ËÆ¢Âçï)Áä∂ÊÄÅ</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali138.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali138.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="Êï∞ÊçÆÂ∫ìÂàùÂßãÊÉÖÂÜµ"><a href="#Êï∞ÊçÆÂ∫ìÂàùÂßãÊÉÖÂÜµ" class="headerlink" title="Êï∞ÊçÆÂ∫ìÂàùÂßãÊÉÖÂÜµ"></a>Êï∞ÊçÆÂ∫ìÂàùÂßãÊÉÖÂÜµ</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span>  <span class="token keyword">FROM</span>  <span class="token identifier"><span class="token punctuation">`</span>seata_order<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>t_order<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>seata_storage<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>t_storage<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>  <span class="token keyword">FROM</span>  <span class="token identifier"><span class="token punctuation">`</span>seata_account<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>t_account<span class="token punctuation">`</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali142.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali142.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="Ê≠£Â∏∏‰∏ãÂçï"><a href="#Ê≠£Â∏∏‰∏ãÂçï" class="headerlink" title="Ê≠£Â∏∏‰∏ãÂçï"></a>Ê≠£Â∏∏‰∏ãÂçï</h3><p><a target="_blank" rel="noopener" href="http://localhost:2001/order/create?userId=1&amp;productId=1&amp;count=10&amp;money=100">http://localhost:2001/order/create?userId=1&amp;productId=1&amp;count=10&amp;money=100</a></p>
<p>Êï∞ÊçÆÂ∫ìÊÉÖÂÜµ</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali143.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali143.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="Ë∂ÖÊó∂ÂºÇÂ∏∏ÔºåÊ≤°Âä†-GlobalTransactional"><a href="#Ë∂ÖÊó∂ÂºÇÂ∏∏ÔºåÊ≤°Âä†-GlobalTransactional" class="headerlink" title="Ë∂ÖÊó∂ÂºÇÂ∏∏ÔºåÊ≤°Âä†@GlobalTransactional"></a>Ë∂ÖÊó∂ÂºÇÂ∏∏ÔºåÊ≤°Âä†@GlobalTransactional</h3><h4 id="AccountServiceImplÊ∑ªÂä†Ë∂ÖÊó∂"><a href="#AccountServiceImplÊ∑ªÂä†Ë∂ÖÊó∂" class="headerlink" title="AccountServiceImplÊ∑ªÂä†Ë∂ÖÊó∂"></a>AccountServiceImplÊ∑ªÂä†Ë∂ÖÊó∂</h4><p>seata-account-service2003  AccountServiceImpl</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**
     * Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ù
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->account-service‰∏≠Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ùÂºÄÂßã"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Ê®°ÊãüË∂ÖÊó∂ÂºÇÂ∏∏ÔºåÂÖ®Â±Ä‰∫ãÂä°ÂõûÊªö</span>
        <span class="token comment">//ÊöÇÂÅúÂá†ÁßíÈíüÁ∫øÁ®ã</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
        accountDao<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"------->account-service‰∏≠Êâ£ÂáèË¥¶Êà∑‰ΩôÈ¢ùÁªìÊùü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="Êï∞ÊçÆÂ∫ìÊÉÖÂÜµ"><a href="#Êï∞ÊçÆÂ∫ìÊÉÖÂÜµ" class="headerlink" title="Êï∞ÊçÆÂ∫ìÊÉÖÂÜµ"></a>Êï∞ÊçÆÂ∫ìÊÉÖÂÜµ</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali144.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali144.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="ÊïÖÈöúÊÉÖÂÜµ"><a href="#ÊïÖÈöúÊÉÖÂÜµ" class="headerlink" title="ÊïÖÈöúÊÉÖÂÜµ"></a>ÊïÖÈöúÊÉÖÂÜµ</h4><blockquote>
<p><strong>ÂΩìÂ∫ìÂ≠òÂíåË¥¶Êà∑ÈáëÈ¢ùÊâ£ÂáèÂêéÔºåËÆ¢ÂçïÁä∂ÊÄÅÂπ∂Ê≤°ÊúâËÆæÁΩÆ‰∏∫Â∑≤ÁªèÂÆåÊàêÔºåÊ≤°Êúâ‰ªéÈõ∂Êîπ‰∏∫Â£π</strong></p>
<p><strong>ËÄå‰∏îÁî±‰∫éfeignÁöÑÈáçËØïÊú∫Âà∂ÔºåË¥¶Êà∑‰ΩôÈ¢ùËøòÊúâÂèØËÉΩË¢´Â§öÊ¨°Êâ£Âáè</strong></p>
</blockquote>
<h3 id="Ë∂ÖÊó∂ÂºÇÂ∏∏ÔºåÊ∑ªÂä†-GlobalTransactional"><a href="#Ë∂ÖÊó∂ÂºÇÂ∏∏ÔºåÊ∑ªÂä†-GlobalTransactional" class="headerlink" title="Ë∂ÖÊó∂ÂºÇÂ∏∏ÔºåÊ∑ªÂä†@GlobalTransactional"></a>Ë∂ÖÊó∂ÂºÇÂ∏∏ÔºåÊ∑ªÂä†@GlobalTransactional</h3><h4 id="AccountServiceImplÊ∑ªÂä†Ë∂ÖÊó∂-1"><a href="#AccountServiceImplÊ∑ªÂä†Ë∂ÖÊó∂-1" class="headerlink" title="AccountServiceImplÊ∑ªÂä†Ë∂ÖÊó∂"></a>AccountServiceImplÊ∑ªÂä†Ë∂ÖÊó∂</h4><h4 id="seata-order-service2001-OrderServiceImpl-GlobalTransactional"><a href="#seata-order-service2001-OrderServiceImpl-GlobalTransactional" class="headerlink" title="seata-order-service2001 OrderServiceImpl@GlobalTransactional"></a>seata-order-service2001 OrderServiceImpl@GlobalTransactional</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GlobalTransactional</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"fsp-create-order"</span><span class="token punctuation">,</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="‰∏ãÂçïÂêéÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÂπ∂Ê≤°Êúâ‰ªª‰ΩïÊîπÂèò"><a href="#‰∏ãÂçïÂêéÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÂπ∂Ê≤°Êúâ‰ªª‰ΩïÊîπÂèò" class="headerlink" title="‰∏ãÂçïÂêéÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÂπ∂Ê≤°Êúâ‰ªª‰ΩïÊîπÂèò"></a>‰∏ãÂçïÂêéÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÂπ∂Ê≤°Êúâ‰ªª‰ΩïÊîπÂèò</h4><blockquote>
<p> <strong>ËÆ∞ÂΩïÈÉΩÊ∑ªÂä†‰∏çËøõÊù•</strong></p>
</blockquote>
<h2 id="‰∏ÄÈÉ®ÂàÜË°•ÂÖÖ"><a href="#‰∏ÄÈÉ®ÂàÜË°•ÂÖÖ" class="headerlink" title="‰∏ÄÈÉ®ÂàÜË°•ÂÖÖ"></a>‰∏ÄÈÉ®ÂàÜË°•ÂÖÖ</h2><h3 id="Seata"><a href="#Seata" class="headerlink" title="Seata"></a>Seata</h3><p>2019Âπ¥1Êúà‰ªΩËöÇËöÅÈáëÊúçÂíåÈòøÈáåÂ∑¥Â∑¥ÂÖ±ÂêåÂºÄÊ∫êÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°à</p>
<p>Simple Extensible Autonomous Transaction ArchitectureÔºåÁÆÄÂçïÂèØÊâ©Â±ïËá™Ê≤ª‰∫ãÂä°Ê°ÜÊû∂</p>
<p>2020Ëµ∑ÂßãÔºåÂèÇÂä†Â∑•‰ΩúÂêéÁî®1.0‰ª•ÂêéÁöÑÁâàÊú¨</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali145.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali145.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h3 id="ÂÜçÁúãTC-x2F-TM-x2F-RM‰∏âÂ§ßÁªÑ‰ª∂"><a href="#ÂÜçÁúãTC-x2F-TM-x2F-RM‰∏âÂ§ßÁªÑ‰ª∂" class="headerlink" title="ÂÜçÁúãTC&#x2F;TM&#x2F;RM‰∏âÂ§ßÁªÑ‰ª∂"></a>ÂÜçÁúãTC&#x2F;TM&#x2F;RM‰∏âÂ§ßÁªÑ‰ª∂</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali146.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali146.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali147.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali147.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p><strong>ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÊâßË°åÊµÅÁ®ã</strong></p>
<ul>
<li>TM ÂºÄÂêØÂàÜÂ∏ÉÂºè‰∫ãÂä°ÔºàTM Âêë TC Ê≥®ÂÜåÂÖ®Â±Ä‰∫ãÂä°ËÆ∞ÂΩïÔºâÔºõ</li>
<li>Êåâ‰∏öÂä°Âú∫ÊôØÔºåÁºñÊéíÊï∞ÊçÆÂ∫ì„ÄÅÊúçÂä°Á≠â‰∫ãÂä°ÂÜÖËµÑÊ∫êÔºàRM Âêë TC Ê±áÊä•ËµÑÊ∫êÂáÜÂ§áÁä∂ÊÄÅ ÔºâÔºõ</li>
<li>TM ÁªìÊùüÂàÜÂ∏ÉÂºè‰∫ãÂä°Ôºå‰∫ãÂä°‰∏ÄÈò∂ÊÆµÁªìÊùüÔºàTM ÈÄöÁü• TC Êèê‰∫§&#x2F;ÂõûÊªöÂàÜÂ∏ÉÂºè‰∫ãÂä°ÔºâÔºõ</li>
<li>TC Ê±áÊÄª‰∫ãÂä°‰ø°ÊÅØÔºåÂÜ≥ÂÆöÂàÜÂ∏ÉÂºè‰∫ãÂä°ÊòØÊèê‰∫§ËøòÊòØÂõûÊªöÔºõ</li>
<li>TC ÈÄöÁü•ÊâÄÊúâ RM Êèê‰∫§&#x2F;ÂõûÊªö ËµÑÊ∫êÔºå‰∫ãÂä°‰∫åÈò∂ÊÆµÁªìÊùü„ÄÇ</li>
</ul>
<h3 id="ATÊ®°ÂºèÂ¶Ç‰ΩïÂÅöÂà∞ÂØπ‰∏öÂä°ÁöÑÊó†‰æµÂÖ•"><a href="#ATÊ®°ÂºèÂ¶Ç‰ΩïÂÅöÂà∞ÂØπ‰∏öÂä°ÁöÑÊó†‰æµÂÖ•" class="headerlink" title="ATÊ®°ÂºèÂ¶Ç‰ΩïÂÅöÂà∞ÂØπ‰∏öÂä°ÁöÑÊó†‰æµÂÖ•"></a>ATÊ®°ÂºèÂ¶Ç‰ΩïÂÅöÂà∞ÂØπ‰∏öÂä°ÁöÑÊó†‰æµÂÖ•</h3><h4 id="ÊòØ‰ªÄ‰πà-10"><a href="#ÊòØ‰ªÄ‰πà-10" class="headerlink" title="ÊòØ‰ªÄ‰πà"></a>ÊòØ‰ªÄ‰πà</h4><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali148.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali148.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<h4 id="‰∏ÄÈò∂ÊÆµÂä†ËΩΩ"><a href="#‰∏ÄÈò∂ÊÆµÂä†ËΩΩ" class="headerlink" title="‰∏ÄÈò∂ÊÆµÂä†ËΩΩ"></a>‰∏ÄÈò∂ÊÆµÂä†ËΩΩ</h4><blockquote>
<p><strong>Âú®‰∏ÄÈò∂ÊÆµÔºåSeata ‰ºöÊã¶Êà™‚Äú‰∏öÂä° SQL‚ÄùÔºå</strong><br><strong>1  Ëß£Êûê SQL ËØ≠‰πâÔºåÊâæÂà∞‚Äú‰∏öÂä° SQL‚ÄùË¶ÅÊõ¥Êñ∞ÁöÑ‰∏öÂä°Êï∞ÊçÆÔºåÂú®‰∏öÂä°Êï∞ÊçÆË¢´Êõ¥Êñ∞ÂâçÔºåÂ∞ÜÂÖ∂‰øùÂ≠òÊàê‚Äúbefore image‚ÄùÔºå</strong><br><strong>2  ÊâßË°å‚Äú‰∏öÂä° SQL‚ÄùÊõ¥Êñ∞‰∏öÂä°Êï∞ÊçÆÔºåÂú®‰∏öÂä°Êï∞ÊçÆÊõ¥Êñ∞‰πãÂêéÔºå</strong><br><strong>3  ÂÖ∂‰øùÂ≠òÊàê‚Äúafter image‚ÄùÔºåÊúÄÂêéÁîüÊàêË°åÈîÅ„ÄÇ</strong><br><strong>‰ª•‰∏äÊìç‰ΩúÂÖ®ÈÉ®Âú®‰∏Ä‰∏™Êï∞ÊçÆÂ∫ì‰∫ãÂä°ÂÜÖÂÆåÊàêÔºåËøôÊ†∑‰øùËØÅ‰∫Ü‰∏ÄÈò∂ÊÆµÊìç‰ΩúÁöÑÂéüÂ≠êÊÄß„ÄÇ</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali149.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali149.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h4 id="‰∫åÈò∂ÊÆµÊèê‰∫§"><a href="#‰∫åÈò∂ÊÆµÊèê‰∫§" class="headerlink" title="‰∫åÈò∂ÊÆµÊèê‰∫§"></a>‰∫åÈò∂ÊÆµÊèê‰∫§</h4><blockquote>
<p><strong>‰∫åÈò∂ÊÆµÂ¶ÇÊòØÈ°∫Âà©Êèê‰∫§ÁöÑËØùÔºå</strong><br><strong>Âõ†‰∏∫‚Äú‰∏öÂä° SQL‚ÄùÂú®‰∏ÄÈò∂ÊÆµÂ∑≤ÁªèÊèê‰∫§Ëá≥Êï∞ÊçÆÂ∫ìÔºåÊâÄ‰ª•SeataÊ°ÜÊû∂Âè™ÈúÄÂ∞Ü‰∏ÄÈò∂ÊÆµ‰øùÂ≠òÁöÑÂø´ÁÖßÊï∞ÊçÆÂíåË°åÈîÅÂà†ÊéâÔºåÂÆåÊàêÊï∞ÊçÆÊ∏ÖÁêÜÂç≥ÂèØ„ÄÇ</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali150.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali150.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h4 id="‰∫åÈò∂ÊÆµÂõûÊªö"><a href="#‰∫åÈò∂ÊÆµÂõûÊªö" class="headerlink" title="‰∫åÈò∂ÊÆµÂõûÊªö"></a>‰∫åÈò∂ÊÆµÂõûÊªö</h4><blockquote>
<p><strong>‰∫åÈò∂ÊÆµÂõûÊªöÔºö</strong><br><strong>‰∫åÈò∂ÊÆµÂ¶ÇÊûúÊòØÂõûÊªöÁöÑËØùÔºåSeata Â∞±ÈúÄË¶ÅÂõûÊªö‰∏ÄÈò∂ÊÆµÂ∑≤ÁªèÊâßË°åÁöÑ‚Äú‰∏öÂä° SQL‚ÄùÔºåËøòÂéü‰∏öÂä°Êï∞ÊçÆ„ÄÇ</strong><br><strong>ÂõûÊªöÊñπÂºè‰æøÊòØÁî®‚Äúbefore image‚ÄùËøòÂéü‰∏öÂä°Êï∞ÊçÆÔºõ‰ΩÜÂú®ËøòÂéüÂâçË¶ÅÈ¶ñÂÖàË¶ÅÊ†°È™åËÑèÂÜôÔºåÂØπÊØî‚ÄúÊï∞ÊçÆÂ∫ìÂΩìÂâç‰∏öÂä°Êï∞ÊçÆ‚ÄùÂíå ‚Äúafter image‚ÄùÔºå</strong><br><strong>Â¶ÇÊûú‰∏§‰ªΩÊï∞ÊçÆÂÆåÂÖ®‰∏ÄËá¥Â∞±ËØ¥ÊòéÊ≤°ÊúâËÑèÂÜôÔºåÂèØ‰ª•ËøòÂéü‰∏öÂä°Êï∞ÊçÆÔºåÂ¶ÇÊûú‰∏ç‰∏ÄËá¥Â∞±ËØ¥ÊòéÊúâËÑèÂÜôÔºåÂá∫Áé∞ËÑèÂÜôÂ∞±ÈúÄË¶ÅËΩ¨‰∫∫Â∑•Â§ÑÁêÜ„ÄÇ</strong></p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali151.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali151.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
</blockquote>
<h3 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h3><blockquote>
<p>ÂéªÈô§ÂâçÈù¢ÁöÑË∂ÖÊó∂ÂºÇÂ∏∏</p>
<p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali152.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali152.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>
<p>ÊâìÊñ≠ÁÇπÂêéË∞ÉÁî®</p>
<p><a target="_blank" rel="noopener" href="http://localhost:2001/order/create?userId=1&amp;productId=1&amp;count=10&amp;money=100">http://localhost:2001/order/create?userId=1&amp;productId=1&amp;count=10&amp;money=100</a></p>
</blockquote>
<h3 id="Ë°•ÂÖÖ"><a href="#Ë°•ÂÖÖ" class="headerlink" title="Ë°•ÂÖÖ"></a>Ë°•ÂÖÖ</h3><p><img src="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali153.png" class="lazyload placeholder" data-srcset="/image/Learn-SpringCloud-ali/Learn-SpringCloud-ali153.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg"></p>

      </div>
      <div class="post-tags-categories">
        
        <div class="tags">
          
            <a href="/tags/SpringCloudAlibaba/" class="">
              SpringCloudAlibaba
            </a>
          
            <a href="/tags/SpringCloud/" class="">
              SpringCloud
            </a>
          
            <a href="/tags/Spring/" class="">
              Spring
            </a>
          
        </div>
        
      </div>
      
        <div class="copyright">
  <ul class="post-copyright">
    <li class="post-copyright-author">
    <strong>‰ΩúËÄÖ:  </strong>ctrl</a>
    </li>
    <li class="post-copyright-link">
    <strong>ÊñáÁ´†ÈìæÊé•:  </strong>
    <a href="/2022/11/22/learn-springcloud-ali/" target="_blank" title="Learn-SpringCloudAlibaba">http://example.com/2022/11/22/learn-springcloud-ali/</a>
    </li>
    <li class="post-copyright-license">
      <strong>ÁâàÊùÉÂ£∞Êòé:   </strong>
      Êú¨ÁΩëÁ´ôÊâÄÊúâÊñáÁ´†Èô§ÁâπÂà´Â£∞ÊòéÂ§ñ,ÂùáÈááÁî® <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
      ËÆ∏ÂèØÂçèËÆÆ„ÄÇËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§Ñ!
    </li>
  </ul>
<div>
      
    </article>
    <!-- ‰∏ä‰∏ÄÁØáÊñáÁ´†Âíå‰∏ã‰∏ÄÁØáÊñáÁ´† -->
    
      <!-- ÊñáÁ´†ËØ¶ÊÉÖÈ°µÁöÑ‰∏ä‰∏ÄÈ°µÂíå‰∏ã‰∏ÄÈ°µ -->
<div class="post-nav">



  
  <div class="post-nav-prev post-nav-item">
    <div class="post-nav-img" style="background-size: cover; 
      background-position: center center;">
      <img class="lazyload lazyload placeholder" src="/medias/1.jpg" class="lazyload placeholder" data-srcset="/medias/1.jpg" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="">
    </div>
    <a href="/2022/11/22/learn-springcloud/" class="post-nav-link">
      <div class="title">
        <i class="fas fa-angle-left"></i> ‰∏ä‰∏ÄÁØá:
        <div class="title-text">Learn-SpringCloud</div>
      </div>
      
      <!-- <div class="content">
        


SpingBoot Â§ç‰π†maven
‰∏ª pom.xml&lt;?xml version="1.0" encodin
      </div> -->
    </a>
  </div>



  
  <div class="post-nav-next post-nav-item">
    <div class="post-nav-img" style="background-size: cover; 
      background-position: center center;">
      <img class="lazyload lazyload placeholder" src="/medias/15.jpg" class="lazyload placeholder" data-srcset="/medias/15.jpg" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" src="" alt="">
    </div>
    <a href="/2022/11/22/spring-gui-hua/" class="post-nav-link">
      <div class="title">
        ‰∏ã‰∏ÄÁØá: <i class="fas fa-angle-right"></i>
        <div class="title-text">Spring Framework &amp; Spring Boot ËßÑÂàí</div>
      </div>
      <!-- <div class="content">
        Spring Framework 5.3.x
ÂÖàÊù•ÁúãÁúãSpring Framework 5.3.xÁöÑ‰∏Ä‰∫õËßÑÂàí„ÄÇ

‰∏çÁî®Áøª
      </div> -->
    </a>
  </div>

</div>

    
    

    <!-- ÊâìËµè -->
    
      <div id="appDonate" class="post-donate">
  <div id="donate_board" class="donate_bar center" ref="donate">
    <a id="btn_donate" class="btn_donate" href="javascript:;" title="ÊâìËµè" @click="showDialogDrawer()"></a>
  </div>
  <transition name="fade">
    <div 
      class="donate-box-mask"
      v-cloak 
      v-show="visible"
      @click="cancelDialogDrawer()"
    >
    </div>
  </transition>
  <transition name="bounce">
    <div class="donate-box" v-cloak v-show="visible">
      <div class="donate-box_close">
        <i class="fas fa-times" aria-hidden="true" @click="cancelDialogDrawer" pointer></i>
      </div>
      <div class="donate-box_title">
        <h4>
          ‰Ω†ÁöÑËµèËØÜÊòØÊàëÂâçËøõÁöÑÂä®Âäõ
        </h4>
      </div>
      <div class="donate-box_tab">
        <div class="Alipay" pointer :class="{'active': tabActive === 'Alipay'}" @click="changeTabActive('Alipay')">
          ÊîØ‰ªòÂÆù
        </div>
        <div class="WeChatpay" pointer :class="{'active': tabActive === 'WeChatpay'}" @click="changeTabActive('WeChatpay')">
          ÂæÆ‰ø°
        </div>
      </div>
      <div class="donate-box_img">
        <div class="AlipayImg" v-show="tabActive === 'Alipay'">
          <img src="/medias/zfb.jpg" class="lazyload placeholder" data-srcset="/medias/zfb.jpg" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="ÊîØ‰ªòÂÆùÊâìËµè" />
        </div> 
        <div class="WeChatpayImg" v-show="tabActive === 'WeChatpay'">
          <img src="/medias/wx.jpg" class="lazyload placeholder" data-srcset="/medias/wx.jpg" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="ÂæÆ‰ø°ÊâìËµè" />
        </div>
      </div>
    </div>
  </transition>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDonate',
    data: {
      visible: false,
      tabActive: 'Alipay',
      top: 0,
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      showDialogDrawer() {
        this.visible = true;
        // Èò≤Ê≠¢È°µÈù¢ÊªöÂä®ÔºåÂè™ËÉΩËÆ©ÂºπÊ°ÜÊªöÂä®
        // function getScroll() {
        //   return {
        //     left: window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0,
        //     top: window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0
        //   };
        // }
        this.top = $(document).scrollTop() // or getScroll().top
        // console.log('aa', $('.main-content'));
        body.style.cssText = 'overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
      changeTabActive(name) {
        this.tabActive = name;
      }
    },
    created() {}
  })
</script>
    

    <!-- ÂàÜ‰∫´ -->
    
      <!-- https://github.com/overtrue/share.js -->
<!-- ÊñáÁ´†ËØ¶ÊÉÖÈ°µÁöÑÂàÜ‰∫´ -->
<div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>ÂæÆ‰ø°Êâ´‰∏ÄÊâ´Âç≥ÂèØÂàÜ‰∫´ÔºÅ</p>"></div>

<script src="/js/shareJs/social-share.min.js"></script>
</script>

<style>
  .social-share {
    margin: 20px 0;
  }
</style>


    
    
    <!-- ËØÑËÆ∫ -->
    <!-- ËØÑËÆ∫ -->

  <div id="myComment">
    
      <div id="gitment-container"></div>

    
  </div>

<!-- comment script in themes\hexo-theme-bamboo\layout\_partial\scripts\index.ejs -->


  </div>

  <!-- ÁõÆÂΩï -->
  <!-- ÊñáÁ´†ËØ¶ÊÉÖÈ°µÂè≥‰æßÁõÆÂΩï -->

  <div class="toc-aside">
    <div class="toc-main">
      <div class="toc-aside-title">
        <i class="fas fa-list-ul" aria-hidden="true"></i><span>Êú¨ÊñáÁõÆÂΩï</span>
        
          <div class="toc-open-close">Êú¨ÊñáÁõÆÂΩï</div>
        
      </div>
      <div class="toc-content">
        <div class="toc"></div>
      </div>
    </div>
  </div>

  <!-- ÊâãÊú∫Á´ØÁõÆÂΩïÊåâÈíÆ -->
  <div id="toc-mobile-btn">
    <i class="fas fa-list-ul" aria-hidden="true"></i>
  </div>
  <!-- jsÂú®scriptsÁõÆÂΩï‰∏ãÁöÑÁöÑtoc.ejsÈáåÈù¢ -->
  

  <script>
    function openBtnClickFn () {
      let openOrCloseBtn = $('.toc-aside .toc-aside-title .toc-open-close');
      let open = eval('' || 'true');
      openOrCloseBtn.click(function() {
        if (open === true) {
          $(".toc-aside").css({'width': 0, 'padding': 0});
          $(".toc-content").css({'width': 0});
          $(".toc-aside-title span, .toc-aside-title i").css({'display': 'none'});
          $(".main-content").css({'width': '75%', 'margin': '10px auto'});
          open = false;
        } else {
          $(".toc-aside").css({'width': '350px', 'padding': '0 10px'});
          $(".toc-content").css({'width': '350px'});
          $(".toc-aside-title span, .toc-aside-title i").css({'display': 'inline-block'});
          $(".main-content").css({'width': '60%', 'margin-right': '10px', 'margin-left': 'calc(40% - 400px)'});
          open = true;
        }
      });
    };
    openBtnClickFn();
    document.addEventListener('pjax:complete', function () {
      openBtnClickFn();
    })
    
  </script>


  <!-- ÂõæÁâáÊîæÂ§ß Wrap images with fancybox support -->
  <script src="/js/wrapImage.js"></script>
</div>

<!-- ÊñáÁ´†ËØ¶ÊÉÖÈ°µËÉåÊôØÂõæ -->
<div id="appBgSwiper" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;"
	:style="{'background-color': bgColor ? bgColor : 'transparent'}">
	<transition-group tag="ul" :name="names">
		<li v-for='(image,index) in img' :key='index' v-show="index === mark" class="bg-swiper-box">
			<img :src="image" class="bg-swiper-img no-lazy">
		</li>
	</transition-group>
</div>
<script>
	var vm = new Vue({
		el: '#appBgSwiper',
		data: {
			names: '' || 'fade' || 'fade', // translate-fade fade
			mark: 0,
			img: [],
			bgColor: '',
			time: null
		},
		methods: {   //Ê∑ªÂä†ÊñπÊ≥ï
			change(i, m) {
				if (i > m) {
					// this.names = 'fade';
				} else if (i < m) {
					// this.names = 'fade';
				} else {
					return;
				}
				this.mark = i;
			},
			prev() {
				// this.names = 'fade';
				this.mark--;
				if (this.mark === -1) {
					this.mark = 3;
					return
				}
			},
			next() {
				// this.names = 'fade';
				this.mark++;
				if (this.mark === this.img.length) {
					this.mark = 0;
					return
				}
			},
			autoPlay() {
				// this.names = 'fade';
				this.mark++;
				if (this.mark === this.img.length) {
					this.mark = 0;
					return
				}
			},
			play() {
				let bgImgDelay = '' || '100000'
				let delay = parseInt(bgImgDelay) || 180000;
				this.time = setInterval(this.autoPlay, delay);
			},
			enter() {
				clearInterval(this.time);
			},
			leave() {
				this.play();
			}
		},
		created() {
			this.play()
		},
		beforeDestroy() {
			clearInterval(this.time);
		},
		mounted() {
			let prop = '' || '';
			let isImg = prop.includes('.bmp') || prop.includes('.jpg') || prop.includes('.png') || prop.includes('.tif') || prop.includes('.gif') || prop.includes('.pcx') || prop.includes('.tga') || prop.includes('.exif') || prop.includes('.fpx') || prop.includes('.psd') || prop.includes('.cdr') || prop.includes('.pcd') || prop.includes('.dxf') || prop.includes('.ufo') || prop.includes('.eps') || prop.includes('.ai') || prop.includes('.raw') || prop.includes('.WMF') || prop.includes('.webp') || prop.includes('.jpeg') || prop.includes('http://') || prop.includes('https://')
			if (isImg) {
				let img = prop.split(',');
				let configRoot = '/'
				let arrImg = [];
				img.forEach(el => {
					var Expression = /http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;
					var objExp = new RegExp(Expression);

					if (objExp.test(el)) {
						// http or https
						arrImg.push(el);
					} else {
						// Èùûhttp or httpsÂºÄÂ§¥
						// Êú¨Âú∞Êñá‰ª∂
						let firstStr = el.charAt(0);
						if (firstStr == '/') {
							el = el.substr(1); // Âà†Èô§Á¨¨‰∏Ä‰∏™Â≠óÁ¨¶ '/',Âõ†‰∏∫ configRootÊúÄÂêé‰∏Ä‰∏™Â≠óÁ¨¶‰∏∫ /
						}
						el = configRoot + el;
						arrImg.push(el);
					}
				})
				this.img = arrImg;
			} else {
				this.bgColor = prop;
			}
		}
	})
</script>

<style>
	.bg-swiper-box {
		position: absolute;
		display: block;
		width: 100%;
		height: 100%;
	}

	.bg-swiper-img {
		object-fit: cover;
		width: 100%;
		height: 100%;
	}
</style>




  <script>
  function loadMermaid() {
    if (document.getElementsByClassName('mermaid').length) {
      if (window.mermaidJsLoad) mermaid.init()
      else {
        loadScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
          window.mermaidJsLoad = true
          mermaid.initialize({
            theme: 'default',
          })
          if ('true') {
            mermaid.init();
          }
        })
      }
    }
  };
  document.addEventListener("DOMContentLoaded", function () {
    loadMermaid();
  })

  document.addEventListener('pjax:complete', function () {
    loadMermaid();
  })
  
</script>


      </main>
    </div>

    <!-- È°µËÑö -->
    
  
  <div class="footer bg-color">

	<div class="footer-main">
      
        
          <div class="link">
            
          </div>
        
      
        
          <div class="footer-copyright">
            <p>Copyright ¬© 2019 - 2022 <a target="_blank" rel="noopener" href="https://github.com/ctrl-github">ctrl-github</a> | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/yuang01/theme">Bamboo</a> </p>

          </div>
        
      
        
          
            <!-- ‰∏çËíúÂ≠êÁªüËÆ° -->
            <!-- ‰∏çËíúÂ≠êÁªüËÆ° -->
<span id="busuanzi_container_site_pv">
      <i class="fas fa-eye" aria-hidden="true"></i>Êú¨Á´ôÊÄªËÆøÈóÆÈáèÔºö<span id="busuanzi_value_site_pv"></span> Ê¨°
</span>
<span class="post-meta-divider">|</span>
<span id="busuanzi_container_site_uv" style='display:none'>
      <i class="fas fa-users" aria-hidden="true"></i>Êú¨Á´ôËÆøÂÆ¢Êï∞Ôºö<span id="busuanzi_value_site_uv"></span> ‰∫∫
</span>

          
        
      
        
          <div class="footer-custom">
            
          </div>
        
      
    </div>  <img src="http://www.beian.gov.cn/img/new/gongan.png" class="lazyload placeholder" data-srcset="http://www.beian.gov.cn/img/new/gongan.png" srcset="https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg" alt="ÊπòICPÂ§á2022006791Âè∑-1" width="42" height="42">Êπò ICP Â§á2022006791Âè∑-1 </img>
    
  </div>



    <!-- Ê∏≤ÊüìÊöóÈªëÊåâÈíÆ -->
    
      <div class="dark">
  <div class="dark-content">
    <i class="fas fa-moon" aria-hidden="true"></i>
    <!-- <span>ÂÖ≥ÁÅØ</span> -->
  </div>
  
</div>

<script>
  $(function() {
    let isDark = JSON.parse(localStorage.getItem('dark'))  || JSON.parse('false');
    if (isDark) {
      $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
          </div>
          `
        );
    }
    $('.dark').click(function() {
      if ($(document.body).is('.darkModel')) {
        $(document.body).removeClass('darkModel');
        localStorage.setItem('dark', false);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-moon" aria-hidden="true"></i>
          </div>
          `
        );
      } else {
        $(document.body).addClass('darkModel');
        localStorage.setItem('dark', true);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
          </div>
          `
        );
      }
    })
  })
</script>
    
    <!-- Ê∏≤ÊüìÂõûÂà∞È°∂ÈÉ®ÊåâÈíÆ -->
    
      <div class="goTop top-btn-color" pointer>
  <i class="fas fa-arrow-up" aria-hidden="true"></i>
</div>
<script src="/js/goTop.js"></script>

    
    <!-- Ê∏≤ÊüìÂ∑¶‰∏ãËßíÈü≥‰πêÊí≠ÊîæÂô® -->
    
      <link rel="stylesheet" href="/js/aplayer/APlayer@1.10.1.min.css">
<style>
.aplayer .aplayer-lrc p {
  
  font-size: 12px;
  font-weight: 700;
  line-height: 16px !important;
}

.aplayer .aplayer-lrc p.aplayer-lrc-current {
  
  font-size: 15px;
  color: #42b983;
}


.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
  left: -66px !important;
}

.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
  left: 0px !important;
}


</style>
<meting-js  
  class=""
  server="tencent"
  type="playlist"
  id="8062553743"
  fixed='true'
  autoplay='true'
  theme='#42b983'
  loop='all'
  order='random'
  preload='auto'
  volume='0.7'
  list-folded='true'
>
</meting-js>

<!-- <style>
  #aplayer {
    position: fixed;
    left: 0;
    bottom: 300px;
  }
</style> -->
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
    

    <!-- ÂõæÁâáÊîæÂ§ß -->
    
      <script src="/js/fancybox/jquery.fancybox.min.js"></script>
    

    <!-- ÁôæÂ∫¶Ëß£Êûê -->
    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- ËÉåÊôØÂΩ©Â∏¶ -->
    
      <script type="text/javascript" size="100" alpha='0.4' zIndex="-1" src="/js/ribbon.min.js"></script>
    

    <script src="/js/utils/index.js"></script>
    <script src="/js/app.js" data-pjax></script>
    
    <!-- ÊñáÁ´†ÁõÆÂΩïÊâÄÈúÄjs -->
<link href="/js/tocbot/tocbot.css" rel="stylesheet">
<script src="/js/tocbot/tocbot.min.js"></script>

<script>
  var headerEl = 'h1, h2, h3, h4, h5, h6',  //headers 
    content = '.post-detail',//ÊñáÁ´†ÂÆπÂô®
    idArr = {};  //Ê†áÈ¢òÊï∞ÁªÑ‰ª•Á°ÆÂÆöÊòØÂê¶Â¢ûÂä†Á¥¢Âºïid
  //add #id
  var option = {
    // Where to render the table of contents.
    tocSelector: '.toc',
    // Where to grab the headings to build the table of contents.
    contentSelector: content,
    // Which headings to grab inside of the contentSelector element.
    headingSelector: headerEl,
    scrollSmooth: true,
    scrollSmoothOffset: -80,
    headingsOffset: -($(window).height() * 0.4 - 45),
    positionFixedSelector: '.toc-main',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
    activeLinkClass: 'is-active-link',
    // onClick: function (e) {},
  }
  if ($('.toc').length > 0) {

    $(content).children(headerEl).each(function () {
      //ÂéªÈô§Á©∫Ê†º‰ª•ÂèäÂ§ö‰ΩôÊ†áÁÇπ
      var headerId = $(this).text().replace(/[\s|\~|`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\||\|\[|\]|\{|\}|\;|\:|\"|\'|\,|\<|\.|\>|\/|\?|\Ôºö|\Ôºå|\„ÄÇ]/g, '');

      headerId = headerId.toLowerCase();
      if (idArr[headerId]) {
        //idÂ∑≤ÁªèÂ≠òÂú®
        $(this).attr('id', headerId + '-' + idArr[headerId]);
        idArr[headerId]++;
      }
      else {
        //idÊú™Â≠òÂú®
        idArr[headerId] = 1;
        $(this).attr('id', headerId);
      }
    });

    document.addEventListener("DOMContentLoaded", function () {
      tocbot.init(option);
      mobileTocClick();
    });

  }

  window.tocScrollFn = function () {
    return bamboo.throttle(function () {
      findHeadPosition();
    }, 100)()
  }
  window.addEventListener('scroll', tocScrollFn);

  const findHeadPosition = function (top) {
    if ($('.toc-list').length <= 0) {
      return false;
    }
    setTimeout(() => {  // or DOMContentLoaded 
      autoScrollToc();
    }, 0);
  }

  const autoScrollToc = function () {
    const $activeItem = document.querySelector('.is-active-link');
    const $cardToc = document.querySelector('.toc-content');
    const activePosition = $activeItem.getBoundingClientRect().top
    const sidebarScrollTop = $cardToc.scrollTop
    if (activePosition > (document.documentElement.clientHeight - 100)) {
      $cardToc.scrollTop = sidebarScrollTop + 150
    }
    if (activePosition < 100) {
      $cardToc.scrollTop = sidebarScrollTop - 150
    }
  }

  document.addEventListener('pjax:send', function () {
    if ($('.toc').length) {
      tocbot.destroy();
    }
  });

  document.addEventListener('pjax:complete', function () {
    if ($('.toc').length) {
      tocbot.init(option);
      mobileTocClick();
    }
  });
  
  // ÊâãÊú∫Á´ØtocÊåâÈíÆÁÇπÂáªÂá∫Áé∞ÁõÆÂΩï
  const mobileTocClick = function () {
    const $cardTocLayout = document.getElementsByClassName('toc-aside')[0];
    const $cardToc = $cardTocLayout.getElementsByClassName('toc-content')[0];
    let right = '45px';
    if (window.innerWidth >= 551 && window.innerWidth <= 992) {
      right = '100px'
    }
    const mobileToc = {
      open: () => {
        $cardTocLayout.style.cssText = 'animation: toc-open .3s; opacity: 1; right: ' + right
      },

      close: () => {
        $cardTocLayout.style.animation = 'toc-close .2s'
        setTimeout(() => {
          $cardTocLayout.style.cssText = "opacity:''; animation: ''; right: ''"
        }, 100)
      }
    }
    document.getElementById('toc-mobile-btn').addEventListener('click', () => {
      if (window.getComputedStyle($cardTocLayout).getPropertyValue('opacity') === '0') mobileToc.open()
      else mobileToc.close()
    })

    $cardToc.addEventListener('click', (e) => {
      if (window.innerWidth < 992) { // Â∞è‰∫é992pxÁöÑÊó∂ÂÄô
        mobileToc.close()
      }
    })
  }
</script>

<style>
  .is-position-fixed {
    position: sticky !important;
    top: 74px;
  }

  .toc-main ul {
    counter-reset: show-list;
  }

  .toc-main ul li::before {
    content: counter(item)".";
    display: block;
    position: absolute;
    left: 12px;
    top: 0;
  }
</style> 

<!-- Ê∏≤ÊüìissuesÊ†áÁ≠æÈáåÁöÑÂÜÖÂÆπ -->
<script>
  function loadIssuesJS() {
    if ($(".post-detail").find(".issues-api").length == 0) {
      return;
    } 
    loadScript('/js/issues/index.js');
  };
  $(function () {
    loadIssuesJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof IssuesAPI == "undefined") {
      loadIssuesJS();
    }
  })
</script>

<!-- ËæìÂÖ•Ê°ÜÊâìÂ≠óÁâπÊïà -->
<!-- ËæìÂÖ•Ê°ÜÊâìÂ≠óÁâπÊïà -->

  <script src="/js/activate-power-mode.js"></script>
  <script>
    POWERMODE.colorful = true;  // ÊâìÂºÄÈöèÊú∫È¢úËâ≤ÁâπÊïà
    POWERMODE.shake = false;    // ÂÖ≥Èó≠ËæìÂÖ•Ê°ÜÊäñÂä®
    document.body.addEventListener('input', POWERMODE);//ÁõëÂê¨ÊâìÂ≠ó‰∫ã‰ª∂
  </script>


<!-- markdown‰ª£Á†Å‰∏ÄÈîÆÂ§çÂà∂ÂäüËÉΩ -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.css">
  <script src="https://cdn.jsdelivr.net/npm/v-plugs-ayu/lib/ayu.umd.min.js"></script>
  <script src="/js/clipboard/clipboard.min.js"></script>
  <div id="appCopy">
  </div>
  <script data-pjax>
    var vm = new Vue({
      el: '#appCopy',
      data: {
      },
      computed: {
      },
      mounted() {
        const that = this;
        var copy = 'Â§çÂà∂';
        /* code */
        var initCopyCode = function () {
          var copyHtml = '';
          copyHtml += '<button class="btn-copy" data-clipboard-snippet="" style="position:absolute;top:0;right:0;z-index:1;">';
          copyHtml += '<i class="fas fa-copy"></i><span>' + copy + '</span>';
          copyHtml += '</button>';
          $(".post-detail pre").not('.gutter pre').wrap("<div class='codeBox' style='position:relative;width:100%;'></div>")
          $(".post-detail pre").not('.gutter pre').before(copyHtml);
          new ClipboardJS('.btn-copy', {
            target: function (trigger) {
              return trigger.nextElementSibling;
            }
          });
        }
        initCopyCode();
        $('.btn-copy').unbind('click').bind('click', function () {
          doSomething();
        })
        $(document).unbind('keypress').bind('keypress', function (e) {
          if (e.ctrlKey && e.keyCode == 67) {
            doSomething();
          }
        })

        function doSomething() {
          that.$notify({
            title: "ÊàêÂäü",
            content: "‰ª£Á†ÅÂ∑≤Â§çÂà∂ÔºåËØ∑ÈÅµÂÆàÁõ∏ÂÖ≥ÊéàÊùÉÂçèËÆÆ„ÄÇ",
            type: 'success'
          })
        }
      },
      methods: {
      },
      created() { }
    })
  </script>
  

<!-- ÂõæÁâáÊáíÂä†ËΩΩ -->
<script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script>


<!-- Âç°ÁâáÊªöÂä®Âä®Áîª -->
   

<!-- ËØÑËÆ∫ÊâÄÈúÄjs -->

  
    <script type="text/javascript">
  var utteranceCommon = {};

  function check_utterance() {
    let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');
    if (isDark) {
      utteranceCommon.Theme = 'github-dark';
    } else {
      utteranceCommon.Theme = 'github-light';
    }

    return document.getElementById("gitment-container");
  }
  comment_el = '#gitment-container';
  load_utterance = function () {
    if ($(comment_el).length) {
      // ÂåøÂêçÂáΩÊï∞ÔºåÈò≤Ê≠¢Ê±°ÊüìÂÖ®Â±ÄÂèòÈáè
      const HEAD = check_utterance();

      var utterances = document.createElement('script');
      utterances.type = 'text/javascript';
      utterances.async = true;
      utterances.setAttribute('issue-term', 'pathname')
      utterances.setAttribute('theme', utteranceCommon.Theme)
      utterances.setAttribute('repo', '')
      utterances.crossorigin = 'anonymous';
      utterances.src = 'https://utteranc.es/client.js';
      // content ÊòØË¶ÅÊèíÂÖ•ËØÑËÆ∫ÁöÑÂú∞Êñπ
      document.getElementById('gitment-container').appendChild(utterances);

    }
  }

  function dark_utterance() {
    const HEAD = check_utterance();
    if (!HEAD) return;
    const message = {
      type: 'set-theme',
      theme: utteranceCommon.Theme
    };
    const utteranceIframe = document.querySelector('iframe');
    utteranceIframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }

  $(document).ready(load_utterance);
  document.addEventListener('pjax:complete', function () {
    load_utterance();
  });

  $('.dark').click(function () {
    setTimeout(() => {
      dark_utterance();
    });
  })

</script>

<style>
  .utterances {
    max-width: inherit !important;
  }
</style>
  


<!-- Èº†Ê†áÁÇπÂáªÁâπÊïà -->
<!-- Áà±ÂøÉÁÇπÂáª -->

  
    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 999; pointer-events: none;" ></canvas>
    <script src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
    <script src="/js/cursor/explosion.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" data-pjax></script>


    <!-- pjax -->
    

<!-- pjax -->


  <script src="/js/pjax@0.2.8/index.js"></script>
  
    <!-- Ê†∑Âºè‰Ωç‰∫éÔºösource/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <div class="loading-circle"><div id="loader-circle"></div></div>
    <script>
      window.ShowLoading = function() {
        $(".loading-circle").css("display", "block");
      };
      window.HideLoading = function() {
        $(".loading-circle").css("display", "none");
      }
    </script>
  
	<script>
    document.addEventListener('pjax:complete', function () {
      window.HideLoading();
    })
    document.addEventListener('pjax:send', function () {
      window.ShowLoading();
    })
    document.addEventListener('pjax:error', function () {
      window.HideLoading();
    })
	</script>
</div>

  

  <script>
    var pjax = new Pjax({
      elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([no-pjax])',   // Êã¶Êà™Ê≠£Â∏∏Â∏¶ÈìæÊé•ÁöÑ a Ê†áÁ≠æ
      selectors: ["#pjax-container","title"],                                   // Ê†πÊçÆÂÆûÈôÖÈúÄË¶ÅÁ°ÆËÆ§ÈáçËΩΩÂå∫Âüü
      cacheBust: false,   // url Âú∞ÂùÄËøΩÂä†Êó∂Èó¥Êà≥ÔºåÁî®‰ª•ÈÅøÂÖçÊµèËßàÂô®ÁºìÂ≠ò
      timeout: 5000
    });

    document.addEventListener('pjax:send', function (e) {

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');

    })
    
    document.addEventListener('pjax:complete', function () {
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
    });

    document.addEventListener('pjax:error', function (e) {
      window.location.href = e.triggerElement.href;
    })
    
    // Âà∑Êñ∞‰∏ç‰ªéÈ°∂ÈÉ®ÂºÄÂßã
    document.addEventListener("DOMContentLoaded", function () {
      history.scrollRestoration = 'auto';
    })
  </script>



  </body>
</html>